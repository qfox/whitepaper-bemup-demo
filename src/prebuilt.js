(function(global){"use strict";if(!global.console){global.console={}}var con=global.console;var prop,method;var dummy=function(){};var properties=["memory"];var methods=("assert,clear,count,debug,dir,dirxml,error,exception,group,"+"groupCollapsed,groupEnd,info,log,markTimeline,profile,profiles,profileEnd,"+"show,table,time,timeEnd,timeline,timelineEnd,timeStamp,trace,warn").split(",");while(prop=properties.pop())if(!con[prop])con[prop]={};while(method=methods.pop())if(typeof con[method]!=="function")con[method]=dummy})(typeof window==="undefined"?this:window);(function($){var hasIntrospection=function(){return"_"}.toString().indexOf("_")>-1,emptyBase=function(){},objCreate=Object.create||function(ptp){var Inheritance=function(){};Inheritance.prototype=ptp;return new Inheritance},objKeys=Object.keys,extend=$.extend,isArray=Array.isArray,isFunction=$.isFunction,needCheckProps=true,testPropObj={toString:""};for(var i in testPropObj){testPropObj.hasOwnProperty(i)&&(needCheckProps=false)}var specProps=needCheckProps?["toString","valueOf"]:null;function getPropList(obj){var res=objKeys(obj);if(needCheckProps){var specProp,i=0;while(specProp=specProps[i++]){obj.hasOwnProperty(specProp)&&res.push(specProp)}}return res}function override(base,res,add){var addList=getPropList(add),j=0,len=addList.length,name,prop;while(j<len){if((name=addList[j++])==="__self"){continue}prop=add[name];if(isFunction(prop)&&(!hasIntrospection||prop.toString().indexOf(".__base")>-1)){res[name]=function(name,prop){var result=function(){var baseSaved=this.__base;this.__base=result.__base;var res=prop.apply(this,arguments);this.__base=baseSaved;return res};result.__base=base[name]||(name==="__constructor"?res.__self.__parent:$.noop);return result}(name,prop)}else{res[name]=prop}}}function applyMixins(mixins,res){var i=1,mixin;while(mixin=mixins[i++]){if(res){isFunction(mixin)?$.inheritSelf(res,mixin.prototype,mixin):$.inheritSelf(res,mixin)}else{res=isFunction(mixin)?$.inherit(mixins[0],mixin.prototype,mixin):$.inherit(mixins[0],mixin)}}return res||mixins[0]}$.inherit=function(){var args=arguments,withMixins=isArray(args[0]),hasBase=withMixins||isFunction(args[0]),base=hasBase?withMixins?applyMixins(args[0]):args[0]:emptyBase,props=args[hasBase?1:0]||{},staticProps=args[hasBase?2:1],res=props.__constructor||hasBase&&base.prototype.__constructor?function(){return this.__constructor.apply(this,arguments)}:hasBase?function(){return base.apply(this,arguments)}:function(){};if(!hasBase){res.prototype=props;res.prototype.__self=res.prototype.constructor=res;return extend(res,staticProps)}extend(res,base);res.__parent=base;var basePtp=base.prototype,resPtp=res.prototype=objCreate(basePtp);resPtp.__self=resPtp.constructor=res;props&&override(basePtp,resPtp,props);staticProps&&override(base,res,staticProps);return res};$.inheritSelf=function(){var args=arguments,withMixins=isArray(args[0]),base=withMixins?applyMixins(args[0],args[0][0]):args[0],props=args[1],staticProps=args[2],basePtp=base.prototype;props&&override(basePtp,basePtp,props);staticProps&&override(base,base,staticProps);return base};$.inherit.self=$.inheritSelf})(jQuery);(function($){var counter=0,expando="__"+Number(new Date),get=function(){return"uniq"+ ++counter};$.identify=function(obj,onlyGet){if(!obj){return get()}var key="uniqueID"in obj?"uniqueID":expando;return onlyGet||key in obj?obj[key]:obj[key]=get()}})(jQuery);(function($){var storageExpando="__"+Number(new Date)+"storage",getFnId=function(fn,ctx){return $.identify(fn)+(ctx?$.identify(ctx):"")},Observable={buildEventName:function(e){return e},on:function(e,data,fn,ctx,_special){if(typeof e=="string"){if($.isFunction(data)){ctx=fn;fn=data;data=undefined}var id=getFnId(fn,ctx),storage=this[storageExpando]||(this[storageExpando]={}),eList=e.split(" "),i=0,eStorage;while(e=eList[i++]){e=this.buildEventName(e);eStorage=storage[e]||(storage[e]={ids:{},list:{}});if(!(id in eStorage.ids)){var list=eStorage.list,item={fn:fn,data:data,ctx:ctx,special:_special};if(list.last){list.last.next=item;item.prev=list.last}else{list.first=item}eStorage.ids[id]=list.last=item}}}else{var self=this;$.each(e,function(e,fn){self.on(e,fn,data,_special)})}return this},onFirst:function(e,data,fn,ctx){return this.on(e,data,fn,ctx,{one:true})},un:function(e,fn,ctx){if(typeof e=="string"||typeof e=="undefined"){var storage=this[storageExpando];if(storage){if(e){var eList=e.split(" "),i=0,eStorage;while(e=eList[i++]){e=this.buildEventName(e);if(eStorage=storage[e]){if(fn){var id=getFnId(fn,ctx),ids=eStorage.ids;if(id in ids){var list=eStorage.list,item=ids[id],prev=item.prev,next=item.next;if(prev){prev.next=next}else if(item===list.first){list.first=next}if(next){next.prev=prev}else if(item===list.last){list.last=prev}delete ids[id]}}else{delete this[storageExpando][e]}}}}else{delete this[storageExpando]}}}else{var self=this;ctx=fn;$.each(e,function(e,fn){self.un(e,fn,ctx)})}return this},trigger:function(e,data){var storage=this[storageExpando],isString=typeof e==="string",rawType=isString?e:e.type,eventName=this.buildEventName(rawType);if(!isString){e.type=eventName;e.target||(e.target=this)}if(storage&&(storage=storage[eventName])){var item=storage.list.first,ret;if(item&&isString){e=$.Event(eventName);e.target=this}while(item){e.data=item.data;ret=item.fn.call(item.ctx||this,e,data);if(typeof ret!=="undefined"){e.result=ret;if(ret===false){e.preventDefault();e.stopPropagation()}}item.special&&item.special.one&&this.un(rawType,item.fn,item.ctx);item=item.next}}return this}};$.observable=$.inherit(Observable,Observable)})(jQuery);(function($){var win=$(window),currentDoubleHeight=getHeight(),currentDoubleWidth=getWidth();($.event.special.resize||($.event.special.resize={})).preDispatch=function(e){var newDoubleHeight=getHeight(),newDoubleWidth=getWidth();if(currentDoubleWidth===newDoubleWidth&&currentDoubleHeight===newDoubleHeight){return false}currentDoubleHeight=newDoubleHeight;currentDoubleWidth=newDoubleWidth};function getHeight(){return window.innerHeight|0+win.outerHeight()}function getWidth(){return window.innerWidth|0+win.outerWidth()}})(jQuery);jQuery.cookie=function(name,value,options){if(typeof value!="undefined"){options=options||{};if(value===null){value="";options.expires=-1}var expires="";if(options.expires&&(typeof options.expires=="number"||options.expires.toUTCString)){var date;if(typeof options.expires=="number"){date=new Date;date.setTime(date.getTime()+options.expires*24*60*60*1e3)}else{date=options.expires}expires="; expires="+date.toUTCString()}var path=options.path?"; path="+options.path:"",domain=options.domain?"; domain="+options.domain:"",secure=options.secure?"; secure":"";document.cookie=[name,"=",encodeURIComponent(value),expires,path,domain,secure].join("")}else{var cookieValue=null;if(document.cookie&&document.cookie!=""){var cookies=document.cookie.split(";");for(var i=0;i<cookies.length;i++){var cookie=jQuery.trim(cookies[i]);if(cookie.substring(0,name.length+1)==name+"="){cookieValue=decodeURIComponent(cookie.substring(name.length+1));break}}}return cookieValue}};(function($){var map={"%D0":"%D0%A0","%C0":"%D0%90","%C1":"%D0%91","%C2":"%D0%92","%C3":"%D0%93","%C4":"%D0%94","%C5":"%D0%95","%A8":"%D0%81","%C6":"%D0%96","%C7":"%D0%97","%C8":"%D0%98","%C9":"%D0%99","%CA":"%D0%9A","%CB":"%D0%9B","%CC":"%D0%9C","%CD":"%D0%9D","%CE":"%D0%9E","%CF":"%D0%9F","%D1":"%D0%A1","%D2":"%D0%A2","%D3":"%D0%A3","%D4":"%D0%A4","%D5":"%D0%A5","%D6":"%D0%A6","%D7":"%D0%A7","%D8":"%D0%A8","%D9":"%D0%A9","%DA":"%D0%AA","%DB":"%D0%AB","%DC":"%D0%AC","%DD":"%D0%AD","%DE":"%D0%AE","%DF":"%D0%AF","%E0":"%D0%B0","%E1":"%D0%B1","%E2":"%D0%B2","%E3":"%D0%B3","%E4":"%D0%B4","%E5":"%D0%B5","%B8":"%D1%91","%E6":"%D0%B6","%E7":"%D0%B7","%E8":"%D0%B8","%E9":"%D0%B9","%EA":"%D0%BA","%EB":"%D0%BB","%EC":"%D0%BC","%ED":"%D0%BD","%EE":"%D0%BE","%EF":"%D0%BF","%F0":"%D1%80","%F1":"%D1%81","%F2":"%D1%82","%F3":"%D1%83","%F4":"%D1%84","%F5":"%D1%85","%F6":"%D1%86","%F7":"%D1%87","%F8":"%D1%88","%F9":"%D1%89","%FA":"%D1%8A","%FB":"%D1%8B","%FC":"%D1%8C","%FD":"%D1%8D","%FE":"%D1%8E","%FF":"%D1%8F"};function convert(str){return str.replace(/%.{2}/g,function($0){return map[$0]||$0})}function decode(func,str){var decoded="";try{decoded=func(str)}catch(e){try{decoded=func(convert(str))}catch(err){decoded=str}}return decoded}$.extend({decodeURI:function(str){return decode(decodeURI,str)},decodeURIComponent:function(str){return decode(decodeURIComponent,str)}})})(jQuery);(function(win,doc,$){var CLONE_DICT={bubbles:false,cancelable:false,view:null,detail:null,screenX:0,screenY:0,clientX:0,clientY:0,ctrlKey:false,altKey:false,shiftKey:false,metaKey:false,button:0,relatedTarget:null,buttons:0,pointerId:0,width:0,height:0,pressure:0,tiltX:0,tiltY:0,pointerType:"",hwTimestamp:0,isPrimary:false,target:null,currentTarget:null,which:0,pageX:0,pageY:0,timeStamp:0},CLONE_PROPS=Object.keys(CLONE_DICT),CLONE_DEFAULTS=CLONE_PROPS.map(function(prop){return CLONE_DICT[prop]}),CLONE_PROPS_LENGTH=CLONE_PROPS.length,HAS_BUTTONS=false,WHICH_TO_BUTTONS=[0,1,4,2];try{HAS_BUTTONS=new MouseEvent("test",{buttons:1}).buttons===1}catch(e){}function getPointerProps(event,props){var copy={},orig=event.originalEvent||{};props||(props={});for(var i=0,prop;i<CLONE_PROPS_LENGTH;i++){prop=CLONE_PROPS[i];copy[prop]=props[prop]||event[prop]||orig[prop]||CLONE_DEFAULTS[i]}copy.x=copy.clientX;copy.y=copy.clientY;copy.pressure=copy.pressure||(copy.buttons?.5:0);if(!copy.buttons&&!HAS_BUTTONS){copy.buttons=WHICH_TO_BUTTONS[copy.which]||0}copy.originalEvent=event.originalEvent||null;if(props.preventDefault){copy.preventDefault=function(){props.preventDefault();event.preventDefault()}}else{copy.preventDefault=function(){event.preventDefault()};copy._preventScroll=function(){}}return copy}function getPointerEvent(type,props){var event=$.Event(type),propsPreventDefault=props.preventDefault,eventPreventDefault=event.preventDefault.bind(event);jQuery.extend(event,props);event.preventDefault=function(){propsPreventDefault();eventPreventDefault()};return event}var USE_NATIVE_MAP=win.Map&&win.Map.prototype.forEach,pointermap=USE_NATIVE_MAP?new win.Map:{array:[],size:0,set:function(k,v){if(v===undefined){return this["delete"](k)}if(!this.has(k)){this.size++}this.array[k]=v},has:function(k){return this.array[k]!==undefined},delete:function(k){if(this.has(k)){delete this.array[k];this.size--}},get:function(k){return this.array[k]},clear:function(){this.array.length=0;this.size=0},forEach:function(callback,thisArg){return this.array.forEach(function(v,k){callback.call(thisArg,v,k,this)},this)}},dispatcher={eventMap:{},captureInfo:{},eventSourceList:[],registerSource:function(name,source){var types=source.events;if(types){types.forEach(function(type){if(source[type]){this.eventMap[type]=source[type].bind(source)}},this);this.eventSourceList.push(source)}},register:function(target){var l=this.eventSourceList.length;for(var i=0,es;i<l&&(es=this.eventSourceList[i]);i++){es.register.call(es,target)}},unregister:function(target){var l=this.eventSourceList.length;for(var i=0,es;i<l&&(es=this.eventSourceList[i]);i++){es.unregister.call(es,target)}},contains:function(container,contained){if(!container.contains){return false}return container.contains(contained)},getCommonAncestor:function(target,relatedTarget){while(target&&target!==doc.documentElement){if(target.contains&&target.contains(relatedTarget)){return target}target=target.parentNode}return null},down:function(props){props.bubbles=true;this.fireEvent("pointerdown",props)},move:function(props){props.bubbles=true;this.fireEvent("pointermove",props)},up:function(props){props.bubbles=true;this.fireEvent("pointerup",props)},enter:function(props){var stack=[],target=props.target,commonAncestor=this.getCommonAncestor(target,props.relatedTarget);props.bubbles=false;while(target&&target!==commonAncestor){stack.push(target);target=target.parentNode}while(stack.length){props.target=stack.pop();this.fireEvent("pointerenter",props)}},leave:function(props){var stack=[],target=props.target,commonAncestor=this.getCommonAncestor(target,props.relatedTarget);props.bubbles=false;while(target&&target!==commonAncestor){stack.push(target);target=target.parentNode}while(stack.length){props.target=stack.shift();this.fireEvent("pointerleave",props)}},over:function(props){props.bubbles=true;this.fireEvent("pointerover",props)},out:function(props){props.bubbles=true;this.fireEvent("pointerout",props)},cancel:function(props){props.bubbles=true;this.fireEvent("pointercancel",props)},leaveOut:function(props){this.out(props);if(!this.contains(props.target,props.relatedTarget)){this.leave(props)}},enterOver:function(props){this.over(props);if(!this.contains(props.target,props.relatedTarget)){this.enter(props)}},listen:function(target,types){types.forEach(function(type){this.addEvent(target,type)},this)},unlisten:function(target,types){types.forEach(function(type){this.removeEvent(target,type)},this)},addEvent:function(target,type){$(target).on(type,this.boundHandler)},removeEvent:function(target,type){$(target).off(type,this.boundHandler)},eventHandler:function(jEvent){var cb=this.eventMap[jEvent.type];cb&&cb(jEvent,jEvent.originalEvent)},makeEvent:function(type,props){if(this.captureInfo[props.pointerId]){props.relatedTarget=null}var event=getPointerEvent(type,props);event._target=event._target||props.target;return event},fireEvent:function(type,props){var event=this.makeEvent(type,props);return this.dispatchEvent(event)},getTarget:function(event){return this.captureInfo[event.pointerId]||event._target},setCapture:function(pointerId,target){if(this.captureInfo[pointerId]){this.releaseCapture(pointerId)}this.captureInfo[pointerId]=target;this.implicitRelease=this.releaseCapture.bind(this,pointerId);$(doc).on("pointerup pointercancel",this.implicitRelease);this.asyncDispatchEvent($.Event("gotpointercapture",{bubbles:true,cancelable:false,pointerId:pointerId,_target:target}))},releaseCapture:function(pointerId){var target=this.captureInfo[pointerId];if(target){this.captureInfo[pointerId]=undefined;$(doc).off("pointerup pointercancel",this.implicitRelease);this.asyncDispatchEvent($.Event("lostpointercapture",{bubbles:true,cancelable:false,pointerId:pointerId,_target:target}))}},dispatchEvent:function(event){var target=this.getTarget(event);if(target){return $.event.trigger(event,null,target,!event.bubbles)}},asyncDispatchEvent:function(event){(win.requestAnimationFrame||setTimeout)(this.dispatchEvent.bind(this,event))}};dispatcher.boundHandler=dispatcher.eventHandler.bind(dispatcher);var mouseEvents={POINTER_ID:1,POINTER_TYPE:"mouse",DEDUP_DIST:25,events:["mousedown","mousemove","mouseup","mouseover","mouseout"],register:function(target){dispatcher.listen(target,this.events)},unregister:function(target){dispatcher.unlisten(target,this.events)},lastTouches:[],isEventSimulatedFromTouch:function(event){var lts=this.lastTouches,x=event.clientX,y=event.clientY;for(var i=0,l=lts.length,t;i<l&&(t=lts[i]);i++){var dx=Math.abs(x-t.x),dy=Math.abs(y-t.y);if(dx<=this.DEDUP_DIST&&dy<=this.DEDUP_DIST){return true}}},prepareEvent:function(event){return getPointerProps(event,{pointerId:this.POINTER_ID,isPrimary:true,pointerType:this.POINTER_TYPE})},mousedown:function(event){if(!this.isEventSimulatedFromTouch(event)){if(pointermap.has(this.POINTER_ID)){this.cancel(event)}pointermap.set(this.POINTER_ID,event);dispatcher.down(this.prepareEvent(event))}},mousemove:function(event){if(!this.isEventSimulatedFromTouch(event)){dispatcher.move(this.prepareEvent(event))}},mouseup:function(event){if(!this.isEventSimulatedFromTouch(event)){var p=pointermap.get(this.POINTER_ID);if(p&&p.button===event.button){dispatcher.up(this.prepareEvent(event));this.cleanupMouse()}}},mouseover:function(event){if(!this.isEventSimulatedFromTouch(event)){dispatcher.enterOver(this.prepareEvent(event))}},mouseout:function(event){if(!this.isEventSimulatedFromTouch(event)){dispatcher.leaveOut(this.prepareEvent(event))}},cancel:function(event){dispatcher.cancel(this.prepareEvent(event));this.cleanupMouse()},cleanupMouse:function(){pointermap["delete"](this.POINTER_ID)}},touchEvents={POINTER_TYPE:"touch",DEDUP_TIMEOUT:2500,CLICK_COUNT_TIMEOUT:200,events:["touchstart","touchmove","touchend","touchcancel"],register:function(target){dispatcher.listen(target,this.events)},unregister:function(target){dispatcher.unlisten(target,this.events)},firstTouch:null,isPrimaryTouch:function(touch){return this.firstTouch===touch.identifier},setPrimaryTouch:function(touch){if(pointermap.size===0||pointermap.size===1&&pointermap.has(1)){this.firstTouch=touch.identifier;this.firstTouchTarget=touch.target;this.scrolling=false;this.firstXY={X:touch.clientX,Y:touch.clientY};this.cancelResetClickCount()}},removePrimaryPointer:function(props){if(props.isPrimary){this.firstTouch=null;this.firstTouchTarget=null;this.firstXY=null;this.shouldScrollCache=undefined;this.resetClickCount()}},clickCount:0,resetId:null,resetClickCount:function(){var fn=function(){this.clickCount=0;this.resetId=null}.bind(this);this.resetId=setTimeout(fn,this.CLICK_COUNT_TIMEOUT)},cancelResetClickCount:function(){this.resetId&&clearTimeout(this.resetId)},typeToButtons:function(type){return type==="touchstart"||type==="touchmove"?1:0},findTarget:function(touch){return doc.elementFromPoint(touch.clientX,touch.clientY)},touchToPointer:function(touch){var self=this,event=this.currentTouchEvent,id=touch.identifier+2;return getPointerProps(event,$.extend({},touch,{pointerId:id,target:dispatcher.captureInfo[id]||this.findTarget(touch),bubbles:true,cancelable:true,detail:this.clickCount,button:0,buttons:this.typeToButtons(event.type),width:touch.webkitRadiusX||touch.radiusX||0,height:touch.webkitRadiusY||touch.radiusY||0,pressure:touch.webkitForce||touch.force||.5,isPrimary:this.isPrimaryTouch(touch),pointerType:this.POINTER_TYPE,preventDefault:function(){self.scrolling=false;self.shouldScrollCache=false;self.firstXY=null}}))},processTouches:function(event,cb){var tl=event.originalEvent.changedTouches;this.currentTouchEvent=event;for(var i=0,t;i<tl.length;i++){t=tl[i];cb.call(this,this.touchToPointer(t))}},scrollTypes:{EMITTER:"none",XSCROLLER:"pan-x",YSCROLLER:"pan-y",SCROLLER:/^(?:pan-x pan-y)|(?:pan-y pan-x)|auto$/},touchActionToScrollType:function(touchAction){var st=this.scrollTypes,ret;if(touchAction===st.EMITTER){ret="none"}else if(touchAction===st.XSCROLLER){ret="X"}else if(touchAction===st.YSCROLLER){ret="Y"}else if(st.SCROLLER.exec(touchAction)){ret="XY"}return ret},shouldScroll:function(event){if(this.shouldScrollCache!==undefined){return this.shouldScrollCache}if(!this.firstXY){return true}var touchActionAttr,ret,touchActionPolicyElement=this.firstTouchTarget;do{if(!touchActionPolicyElement){break}touchActionAttr=touchActionPolicyElement.getAttribute("touch-action");if(touchActionAttr!==null){break}touchActionPolicyElement=touchActionPolicyElement.parentNode}while(touchActionPolicyElement!==document);var scrollAxis=this.touchActionToScrollType(touchActionAttr);if(scrollAxis==="none"){ret=false}else if(scrollAxis==="XY"||scrollAxis===undefined){ret=true}else{var t=event.originalEvent.changedTouches[0],axis=scrollAxis,oppositeAxis=scrollAxis==="Y"?"X":"Y",deltaOnAxis=Math.abs(t["client"+axis]-this.firstXY[axis]),deltaOnOppositeAxis=Math.abs(t["client"+oppositeAxis]-this.firstXY[oppositeAxis]);ret=deltaOnAxis>=deltaOnOppositeAxis}this.shouldScrollCache=ret;this.firstXY=null;this.firstTouchTarget=null;return this.shouldScrollCache},findTouch:function(inTL,inId){for(var i=0,l=inTL.length,t;i<l&&(t=inTL[i]);i++){if(t.identifier===inId){return true}}},vacuumTouches:function(event){var touches=event.originalEvent.touches;if(pointermap.size>=touches.length){var d=[];pointermap.forEach(function(value,key){if(key!==1&&!this.findTouch(touches,key-2)){var p=value.out;d.push(p)}},this);d.forEach(this.cancelOut,this)}},touchstart:function(event){var touch=event.originalEvent.changedTouches[0];this.vacuumTouches(event);this.setPrimaryTouch(touch);this.dedupSynthMouse(touch);if(!this.scrolling){this.clickCount++;this.processTouches(event,this.overDown)}},overDown:function(props){pointermap.set(props.pointerId,{target:props.target,out:props,outTarget:props.target});dispatcher.over(props);dispatcher.enter(props);dispatcher.down(props)},touchmove:function(event){if(!this.scrolling){if(this.shouldScroll(event)){this.scrolling=true;this.touchcancel(event)}else{event.preventDefault();this.processTouches(event,this.moveOverOut)}}},moveOverOut:function(props){var pointer=pointermap.get(props.pointerId);if(!pointer){return}var outEvent=pointer.out,outTarget=pointer.outTarget;dispatcher.move(props);if(outEvent&&outTarget!==props.target){outEvent.relatedTarget=props.target;props.relatedTarget=outTarget;outEvent.target=outTarget;if(props.target){dispatcher.leaveOut(outEvent);dispatcher.enterOver(props)}else{props.target=outTarget;props.relatedTarget=null;this.cancelOut(props)}}pointer.out=props;pointer.outTarget=props.target},touchend:function(event){this.dedupSynthMouse(event.originalEvent.changedTouches[0]);this.processTouches(event,this.upOut)},upOut:function(props){if(!this.scrolling){dispatcher.up(props);dispatcher.out(props);dispatcher.leave(props)}this.cleanUpPointer(props)},touchcancel:function(event){this.processTouches(event,this.cancelOut)},cancelOut:function(props){dispatcher.cancel(props);dispatcher.out(props);dispatcher.leave(props);this.cleanUpPointer(props)},cleanUpPointer:function(props){pointermap["delete"](props.pointerId);this.removePrimaryPointer(props)},dedupSynthMouse:function(touch){var lts=mouseEvents.lastTouches;if(this.isPrimaryTouch(touch)){var lt={x:touch.clientX,y:touch.clientY};lts.push(lt);var fn=function(lts,lt){var i=lts.indexOf(lt);if(i>-1){lts.splice(i,1)}}.bind(null,lts,lt);setTimeout(fn,this.DEDUP_TIMEOUT)}}},msEvents={POINTER_TYPES:["","unavailable","touch","pen","mouse"],HAS_BITMAP_TYPE:win.MSPointerEvent&&typeof win.MSPointerEvent.MSPOINTER_TYPE_MOUSE==="number",events:["MSPointerDown","MSPointerMove","MSPointerUp","MSPointerOut","MSPointerOver","MSPointerCancel","MSGotPointerCapture","MSLostPointerCapture"],register:function(target){dispatcher.listen(target,this.events)},unregister:function(target){dispatcher.unlisten(target,this.events)},prepareEvent:function(event){var props=getPointerProps(event);if(this.HAS_BITMAP_TYPE){props.pointerType=this.POINTER_TYPES[props.pointerType]}return props},cleanup:function(id){pointermap["delete"](id)},MSPointerDown:function(event){pointermap.set(event.originalEvent.pointerId,event);dispatcher.down(this.prepareEvent(event))},MSPointerMove:function(event){dispatcher.move(this.prepareEvent(event))},MSPointerUp:function(event){dispatcher.up(this.prepareEvent(event));this.cleanup(event.originalEvent.pointerId)},MSPointerOut:function(event){dispatcher.leaveOut(this.prepareEvent(event))},MSPointerOver:function(event){dispatcher.enterOver(this.prepareEvent(event))},MSPointerCancel:function(event){dispatcher.cancel(this.prepareEvent(event));this.cleanup(event.originalEvent.pointerId)},MSGotPointerCapture:function(event){dispatcher.fireEvent("gotpointercapture",this.prepareEvent(event))},MSLostPointerCapture:function(event){dispatcher.fireEvent("lostpointercapture",this.prepareEvent(event))}},setPointerCapture,releasePointerCapture,assertDown=function(pointerId){if(!pointermap.has(pointerId)){throw new Error("InvalidPointerId")}};if(win.Element&&Element.prototype.setPointerCapture){setPointerCapture=function(elem,pointerId){elem.setPointerCapture(pointerId)};releasePointerCapture=function(elem,pointerId){elem.releasePointerCapture(pointerId)}}else if(win.navigator.msPointerEnabled){setPointerCapture=function(elem,pointerId){assertDown(pointerId);elem.msSetPointerCapture(pointerId)};releasePointerCapture=function(elem,pointerId){assertDown(pointerId);elem.msReleasePointerCapture(pointerId)}}else{setPointerCapture=function(elem,pointerId){assertDown(pointerId);dispatcher.setCapture(pointerId,elem)};releasePointerCapture=function(elem,pointerId){assertDown(pointerId);dispatcher.releaseCapture(pointerId,elem)}}$.fn.extend({setPointerCapture:function(pointerId){setPointerCapture(this[0],pointerId)},releasePointerCapture:function(pointerId){releasePointerCapture(this[0],pointerId)}});if(win._pointerPolyfillInited){console.error("pointerevents: pointerevents уже инициализирован.");return}win._pointerPolyfillInited=true;if(!win.PointerEvent){delete $.event.special.pointerenter;delete $.event.special.pointerleave;if(win.navigator.msPointerEnabled){dispatcher.registerSource("ms",msEvents)}else{dispatcher.registerSource("mouse",mouseEvents);if(win.ontouchstart!==undefined){dispatcher.registerSource("touch",touchEvents)}}dispatcher.register(document)}else{["move","down","up","over","out","enter","leave","cancel"].forEach(function(name){var fixHooks=jQuery.event.fixHooks,eventName="pointer"+name;fixHooks[eventName]||(fixHooks[eventName]={});fixHooks[eventName].props=CLONE_PROPS.concat(fixHooks[eventName].props||[])})}})(window,document,jQuery);(function($){if($.event.special.pointerpress){console.error("pointerevents__press: Событие pointerpress уже установлено.");return}$.each({pointerpress:"pointerdown",pointerrelease:"pointerup pointercancel"},function(alias,type){function handler(e){var type=e.type,result;if(e.pointerType!=="mouse"||e.which===1){e.type=alias;result=$.event.dispatch.apply(this,arguments);e.type=type}return result}$.event.special[alias]={setup:function(){$(this).on(type,handler)},teardown:function(){$(this).off(type,handler)}}})})(jQuery);$.extend({util:{}});(function(win,$){if($.event.special.pointerclick){console.error("pointerevents__click: Событие pointerclick уже установлено.");return}var TOUCH_ABLE=win.ontouchstart!==undefined||navigator.msMaxTouchPoints>0,TOUCH_ACTION_SUPPORT="touchAction"in document.documentElement.style,CLICK_DIST=10,DEDUP_DIST=25,DEDUP_TIME=900,PRESS_TIME=250,lastPointerups=[],lastCompatEvents=[],timeoutId=null,dEvent=null,hasTouchAction=!TOUCH_ACTION_SUPPORT?function(){return false}:function(target){function checkChain(elem){if(!elem||elem===document.documentElement){return false}return getComputedStyle(elem)["touch-action"]==="manipulation"||checkChain(elem.parentElement)}return checkChain(target)},handlers;if(!TOUCH_ABLE){handlers={click:function(e){return dispatch.apply(this,arguments)}}}else{handlers={click:function(e){var sourcePoint=Object(e.originalEvent)._sourcePoint;if(!sourcePoint){return dispatch.apply(this,arguments)}if(sourcePoint.isDefaultPrevented()){e.preventDefault()}},"pointerdown pointermove pointerleave pointercancel pointerup":function(e){var t=e.type;if(e.pointerType==="mouse"){return}if((t==="pointerdown"||t==="pointerup")&&hasTouchAction(e.target)){return}if(t==="pointerdown"){dEvent=e}else if(t==="pointermove"&&dEvent&&(dEvent.target!==e.target||isOutOfClickDist(dEvent,e))){dEvent=null}else if(t==="pointerleave"||t==="pointercancel"){dEvent=null}else if(t==="pointerup"){dedupEvent(e);if(!dEvent){return}if(e.timeStamp-dEvent.timeStamp>PRESS_TIME){dEvent=null}else{timeoutId||(timeoutId=setTimeout(function(){timeoutId=dEvent=null}));return dispatch.apply(this,arguments)}}}};["mousedown","click"].forEach(function(type){win.addEventListener(type,function(e){processCompatEvent(e);if(isMishit(e)){e.preventDefault();e.stopPropagation()}},true)})}function dedupEvent(e){if(!e.isPrimary){return}lastPointerups.push(e);setTimeout(Array.prototype.shift.bind(lastPointerups),DEDUP_TIME)}function isOutOfClickDist(e1,e2){return Math.abs(e1.clientX-e2.clientX)>CLICK_DIST||Math.abs(e1.clientY-e2.clientY)>CLICK_DIST}function processCompatEvent(e){var x=e.clientX,y=e.clientY,compatFlagName="_compat"+e.type;if(e._sourcePoint){return}for(var i=0;i<lastPointerups.length;i++){var p=lastPointerups[i],isSameTarget=p.target===e.target;if(p[compatFlagName]){continue}if(!isSameTarget&&(Math.abs(x-p.clientX)>DEDUP_DIST||Math.abs(y-p.clientY)>DEDUP_DIST)){continue}if(!isSameTarget&&document.elementFromPoint(p.clientX,p.clientY)===p.target){continue}e._sourcePoint=p;p[compatFlagName]=e;break}lastCompatEvents.push(e);setTimeout(Array.prototype.shift.bind(lastCompatEvents),DEDUP_TIME)}function getSourcePoint(e){for(var i=0;i<lastCompatEvents.length;i++){if(lastCompatEvents[i]===e){return lastCompatEvents[i]._sourcePoint}}}function isMishit(e){var sourcePoint=getSourcePoint(e);return Boolean(sourcePoint)&&sourcePoint.target!==e.target}function dispatch(e){var origType=e.type,result;if(!e.button){e.type="pointerclick";result=$.event.dispatch.apply(this,arguments);e.type=origType}return result}$.event.special.pointerclick={setup:function(){$(this).on(handlers)},teardown:function(){$(this).off(handlers)}}})(window,jQuery);(function($){$.dom={getActiveElement:function(){return $(document.activeElement)}};$.fn.isFocused=function(){return this.is($.dom.getActiveElement())}})(jQuery);$.extend({debounce:function(fn,timeout,invokeAsap,ctx){var timer,debounce=function(){var args=arguments;ctx=ctx||this;invokeAsap&&!timer&&fn.apply(ctx,args);clearTimeout(timer);timer=setTimeout(function(){invokeAsap||fn.apply(ctx,args);timer=null},timeout)};if(arguments.length===3&&typeof invokeAsap!=="boolean"){ctx=invokeAsap;invokeAsap=false}debounce.stop=function(){clearTimeout(timer);timer=null};return debounce},throttle:function(fn,timeout,ctx){var timer,args,needInvoke,throttle=function(){args=arguments;needInvoke=true;ctx=ctx||this;timer||function(){if(needInvoke){fn.apply(ctx,args);needInvoke=false;timer=setTimeout(arguments.callee,timeout)}else{timer=null}}()};throttle.stop=function(){clearTimeout(timer);timer=null};return throttle}});(function(){var $win=$(window),$doc=$(document.documentElement),timeoutId=0,isPointer=false;function setIsPointerOnTabFocus(){if(!$doc.hasClass("pointerfocus")){return}isPointer=true;setTimeout(function(){isPointer=false})}if(document.documentMode<=11){$doc.on("focusin",function(e){var o=e.originalEvent;if(o&&!o.fromElement&&!o.relatedTarget){setIsPointerOnTabFocus()}})}else{$win.on("blur",function(){$win.one("focus",setIsPointerOnTabFocus)})}$doc.addClass("utilityfocus").on({focusin:function(){$doc.toggleClass("pointerfocus",isPointer).toggleClass("utilityfocus",!isPointer)},keydown:function(){clearTimeout(timeoutId);isPointer=false},"pointerdown pointerup click":function(e){isPointer=true;clearTimeout(timeoutId);timeoutId=setTimeout(function(){isPointer=false},600)}})})();(function($,undefined){var afterCurrentEventFns=[],inherit=$.inherit,isFunction=$.isFunction,hasOwn=Function.prototype.call.bind(Object.prototype.hasOwnProperty),blocks={},MOD_DELIM="_",ELEM_DELIM="__",channels={};function buildModFnName(elemName,modName,modVal){return(elemName?"__elem_"+elemName:"")+"__mod"+(modName?"_"+modName:"")+(modVal?"_"+modVal:"")}function modFnsToProps(modFns,props,elemName){if(isFunction(modFns)){props[buildModFnName(elemName,"*","*")]=modFns;return}var modName,modVal,modFn;for(modName in modFns){if(!hasOwn(modFns,modName)){continue}modFn=modFns[modName];if(isFunction(modFn)){props[buildModFnName(elemName,modName,"*")]=modFn;continue}for(modVal in modFn){if(!hasOwn(modFn,modVal)){continue}props[buildModFnName(elemName,modName,modVal)]=modFn[modVal]}}}function buildCheckMod(modName,modVal){return modVal?Array.isArray(modVal)?function(block){var i=0,len=modVal.length;while(i<len){if(block.hasMod(modName,modVal[i++])){return true}}return false}:function(block){return block.hasMod(modName,modVal)}:function(block){return block.hasMod(modName)}}function convertModHandlersToMethods(props){function isValidSetMod(val){return isFunction(val)||typeof val==="object"&&Object.keys(val).every(function(k){return isValidSetMod(val[k])})}console.assert(!props.onSetMod||isValidSetMod(props.onSetMod),"i-bem: Поле onSetMod должно быть объектом с обработчиками событий или функцией-обработчиком.");console.assert(!props.onElemSetMod||isValidSetMod(props.onElemSetMod),"i-bem: Поле onElemSetMod должно быть объектом с обработчиками событий или функцией-обработчиком.");if(props.onSetMod){modFnsToProps(props.onSetMod,props);delete props.onSetMod}var elemName,modFns;if(props.onElemSetMod){for(elemName in props.onElemSetMod){if(hasOwn(props.onElemSetMod,elemName)){modFns=props.onElemSetMod[elemName];modFnsToProps(modFns,props,elemName)}}delete props.onElemSetMod}}console.log(typeof window.BEM);window.BEM=inherit($.observable,{__constructor:function(mods,params,initImmediately){var _this=this;_this._modCache=mods||{};_this._processingMods={};_this._params=params;_this.params=null;initImmediately!==false?_this._init():_this.afterCurrentEvent(function(){_this._init()})},_init:function(){if(!this._initing&&!this.hasMod("js","inited")){this._initing=true;if(!this.params){this.params=$.extend(this.getDefaultParams(),this._params);delete this._params}this.setMod("js","inited");delete this._initing;this.hasMod("js","inited")&&this.trigger("init")}return this},changeThis:function(fn,ctx){return fn.bind(ctx||this)},afterCurrentEvent:function(fn,ctx){this.__self.afterCurrentEvent(fn.bind(ctx||this))},on:function(e,data,fn,ctx){if(typeof e==="object"&&($.isFunction(data)||$.isFunction(fn))){e=this.__self._buildModEventName(e)}return this.__base.apply(this,arguments)},un:function(e,fn,ctx){if(typeof e==="object"&&$.isFunction(fn)){e=this.__self._buildModEventName(e)}return this.__base.apply(this,arguments)},trigger:function(e,data){var needToEmit=true;if(typeof e==="object"&&!(e instanceof $.Event)){needToEmit=e.modName==="js"||this.hasMod("js");e=this.__self._buildModEventName(e)}if(needToEmit){this.__base(e=this.buildEvent(e),data);this._trigger(e,data)}return this},_trigger:function(e,data){this.__self.trigger(e,data)},buildEvent:function(e){typeof e=="string"&&(e=$.Event(e));e.block=this;return e},hasMod:function(elem,modName,modVal){var len=arguments.length,invert=false;if(len==1){modVal="";modName=elem;elem=undefined;invert=true}else if(len==2){if(typeof elem=="string"){modVal=modName;modName=elem;elem=undefined}else{modVal="";invert=true}}var res=this.getMod(elem,modName)===modVal;return invert?!res:res},getMod:function(elem,modName){var type=typeof elem;if(type==="string"||type==="undefined"){modName=elem||modName;var modCache=this._modCache;var res=modName in modCache?modCache[modName]:modCache[modName]=this._extractModVal(modName);return res}return this._getElemMod(modName,elem)},_getElemMod:function(modName,elem,elemName){return this._extractModVal(modName,elem,elemName)},getMods:function(elem){var hasElem=elem&&typeof elem!="string",modCache=this._modCache,modNames=[].slice.call(arguments,hasElem?1:0);return!modNames.length?modCache:modNames.reduce(function(res,mod){if(mod in modCache){res[mod]=modCache[mod]}return res},{})},setMod:function(elem,modName,modVal){if(typeof modVal=="undefined"){if(typeof elem==="string"){modVal=typeof modName==="undefined"?true:modName;modName=elem;elem=undefined}else{modVal=true}}var _this=this;if(!elem||elem[0]){if(modVal===false||modVal===null){modVal=""}else if(modVal!==true){modVal=modVal.toString()}var modId=(elem&&elem[0]?$.identify(elem[0]):"")+"_"+modName;if(this._processingMods[modId]){return _this}var elemName,curModVal=elem?_this._getElemMod(modName,elem,elemName=_this.__self._extractElemNameFrom(elem)):_this.getMod(modName);if(curModVal===modVal){return _this}this._processingMods[modId]=true;var needSetMod=true,modFnParams=[modName,modVal,curModVal];elem&&modFnParams.unshift(elem);[["*","*"],[modName,"*"],[modName,modVal]].forEach(function(mod){needSetMod=_this._callModFn(elemName,mod[0],mod[1],modFnParams)!==false&&needSetMod});!elem&&needSetMod&&(_this._modCache[modName]=modVal);needSetMod&&_this._afterSetMod(modName,modVal,curModVal,elem,elemName);delete this._processingMods[modId]}return _this},_afterSetMod:function(modName,modVal,oldModVal,elem,elemName){var eventData={modName:modName,modVal:modVal,oldModVal:oldModVal};elem&&(eventData.elem=elem);this.trigger({modName:modName,modVal:"*",elem:elemName},eventData).trigger({modName:modName,modVal:modVal,elem:elemName},eventData)},toggleMod:function(elem,modName,modVal1,modVal2,condition){if(typeof elem=="string"){condition=modVal2;modVal2=modVal1;modVal1=modName;modName=elem;elem=undefined}if(typeof modVal2=="undefined"){modVal2=""}else if(typeof modVal2=="boolean"){condition=modVal2;modVal2=""}var modVal=this.getMod(elem,modName);(modVal==modVal1||modVal==modVal2)&&this.setMod(elem,modName,typeof condition==="boolean"?condition?modVal1:modVal2:this.hasMod(elem,modName,modVal1)?modVal2:modVal1);return this},delMod:function(elem,modName){if(!modName){modName=elem;elem=undefined}return this.setMod(elem,modName,"")},_callModFn:function(elemName,modName,modVal,modFnParams){var modFnName=buildModFnName(elemName,modName,modVal);return this[modFnName]?this[modFnName].apply(this,modFnParams):undefined},_extractModVal:function(modName,elem){return""},channel:function(id,drop){return this.__self.channel(id,drop)},getDefaultParams:function(){return{}},del:function(obj){var args=[].slice.call(arguments);typeof obj=="string"&&args.unshift(this);this.__self.del.apply(this.__self,args);return this},destruct:function(){var data={modName:"js",modVal:"",oldModVal:"inited"};this.trigger({modName:data.modName,modVal:data.modVal},data)}},$.extend(window.BEM,{_name:"i-bem",blocks:blocks,decl:function(decl,props,staticProps){if(typeof decl=="string"){decl={block:decl}}else if(decl.name){decl.block=decl.name}console.assert(!decl.baseBlock||blocks[decl.baseBlock],'i-bem: baseBlock "'+decl.baseBlock+'" for "'+decl.block+'" is undefined');convertModHandlersToMethods(props||(props={}));var baseBlock=blocks[decl.baseBlock||decl.block]||this;if(decl.modName){var checkMod=buildCheckMod(decl.modName,decl.modVal);$.each(props,function(name,prop){isFunction(prop)&&(props[name]=function(){var method;if(checkMod(this)){method=prop}else{var baseMethod=baseBlock.prototype[name];baseMethod&&baseMethod!==props[name]&&(method=this.__base)}return method?method.apply(this,arguments):undefined})})}if(staticProps&&typeof staticProps.live==="boolean"){var live=staticProps.live;staticProps.live=function(){return live}}var block,baseBlocks=baseBlock;if(decl.baseMix){console.assert(Array.isArray(decl.baseMix),"i-bem: baseMix should be an array.");baseBlocks=[baseBlocks];decl.baseMix.forEach(function(mixedBlock){console.assert(blocks[mixedBlock],'i-bem: mix block "'+mixedBlock+'" for "'+decl.block+'" is undefined');baseBlocks.push(blocks[mixedBlock])})}if(decl.block==baseBlock._name){(block=inherit.self(baseBlocks,props,staticProps))._processLive(true)}else{(block=blocks[decl.block]=inherit(baseBlocks,props,staticProps))._name=decl.block;delete block._liveInitable}return block},declMix:function(block,props,staticProps){console.assert(typeof block==="string","i-bem: declMix expects string as a mix-block name.");convertModHandlersToMethods(props||(props={}));block=blocks[block]=inherit(props,staticProps);return block},_processLive:function(heedLive){return false},create:function(block,params){typeof block=="string"&&(block={block:block});console.assert(typeof block.block==="string","i-bem: Block name should be a string.");console.assert(blocks[block.block],"i-bem: Block "+block.block+" was not declared.");console.assert(!blocks[block.block]||blocks[block.block].prototype instanceof BEM,"i-bem: Beware of using mixin "+block.block+" for creating instances.");return new blocks[block.block](block.mods,params)},getName:function(){return this._name},on:function(e,data,fn,ctx){if(typeof e==="object"&&($.isFunction(data)||$.isFunction(fn))){e=this._buildModEventName(e)}return this.__base.apply(this,arguments)},un:function(e,fn,ctx){if(typeof e==="object"&&$.isFunction(fn)){e=this._buildModEventName(e)}return this.__base.apply(this,arguments)},_buildModEventName:function(modEvent){var res=MOD_DELIM+modEvent.modName+MOD_DELIM+(modEvent.modVal===false?"":modEvent.modVal);modEvent.elem&&(res=ELEM_DELIM+modEvent.elem+res);return res},_extractElemNameFrom:function(elem){},afterCurrentEvent:function(fn,ctx){afterCurrentEventFns.push({fn:fn,ctx:ctx})==1&&setTimeout(this._runAfterCurrentEventFns,0)},_runAfterCurrentEventFns:function(){var fnsLen=afterCurrentEventFns.length;fnsLen&&afterCurrentEventFns.splice(0,fnsLen).forEach(function(fnObj){fnObj.fn.call(fnObj.ctx||this)},this)},changeThis:function(fn,ctx){return fn.bind(ctx||this)},del:function(obj){var delInThis=typeof obj=="string",i=delInThis?0:1,len=arguments.length;delInThis&&(obj=this);while(i<len){delete obj[arguments[i++]]}return this},channel:function(id,drop){if(typeof id=="boolean"){drop=id;id=undefined}id||(id="default");if(drop){if(channels[id]){channels[id].un();delete channels[id]}return}return channels[id]||(channels[id]=new $.observable)}}))})(jQuery);(function(BEM,$,undefined){var undef,MOD_DELIM="_",ELEM_DELIM="__",NAME_PATTERN="[a-zA-Z0-9-]+";function isSimple(obj){var typeOf=typeof obj;return typeOf==="string"||typeOf==="number"||typeOf==="boolean"}function buildModPostfix(modName,modVal,buffer){if(modVal!=null&&modVal!==false){buffer.push(MOD_DELIM,modName);modVal!==true&&buffer.push(MOD_DELIM,modVal)}}function buildBlockClass(name,modName,modVal,buffer){buffer.push(name);buildModPostfix(modName,modVal,buffer)}function buildElemClass(block,name,modName,modVal,buffer){buildBlockClass(block,undef,undef,buffer);buffer.push(ELEM_DELIM,name);buildModPostfix(modName,modVal,buffer)}window.BEM.INTERNAL={NAME_PATTERN:NAME_PATTERN,MOD_DELIM:MOD_DELIM,ELEM_DELIM:ELEM_DELIM,buildModPostfix:function(modName,modVal,buffer){var res=buffer||[];buildModPostfix(modName,modVal,res);return buffer?res:res.join("")},buildClass:function(block,elem,modName,modVal,buffer){if(isSimple(modName)){if(!isSimple(modVal)){buffer=modVal;modVal=modName;modName=elem;elem=undef}}else if(typeof modName!=="undefined"){buffer=modName;modName=undef}else if(elem&&typeof elem!=="string"){buffer=elem;elem=undef}if(!(elem||typeof modName!=="undefined"||buffer)){return block}var res=buffer||[];elem?buildElemClass(block,elem,modName,modVal,res):buildBlockClass(block,modName,modVal,res);return buffer?res:res.join("")},buildClasses:function(block,elem,mods,buffer){if(elem&&typeof elem!=="string"){buffer=mods;mods=elem;elem=undefined}var res=buffer||[];elem?buildElemClass(block,elem,undefined,undefined,res):buildBlockClass(block,undefined,undefined,res);mods&&$.each(mods,function(modName,modVal){if(modVal){res.push(" ");elem?buildElemClass(block,elem,modName,modVal,res):buildBlockClass(block,modName,modVal,res)}});return buffer?res:res.join("")}}})(BEM,jQuery);(function(){var toString=Object.prototype.toString;function isObject(something){return toString.call(something)==="[object Object]"}function merge(object,source,customizer){var key,customized;object=Object(object);source=Object(source);for(key in source){customized=customizer&&customizer(object[key],source[key],key);if(customized!==undefined){object[key]=customized}else if(isObject(object[key])&&isObject(source[key])){object[key]=merge(object[key],source[key],customizer)}else{object[key]=source[key]}}return object}function mergeBemjson(object,source){return merge(object,source,function(left,right,key){if(key==="mix"){return[].concat(left,right)}})}$.extend($.util,{merge:merge,mergeBemjson:mergeBemjson})})();window.BEM.decl("keycodes",{},{BACKSPACE:8,TAB:9,ENTER:13,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DELETE:46,is:function(code,name){return(Array.isArray(name)?name:Array.prototype.slice.call(arguments,1)).some(function(name){return this[name]===code},this)}});(function(BEM,$,undefined){var win=$(window),doc=$(document),uniqIdToDomElems={},uniqIdToBlock={},domElemToParams={},liveEventCtxStorage={},liveClassEventStorage={},blocks=window.BEM.blocks,INTERNAL=window.BEM.INTERNAL,NAME_PATTERN=INTERNAL.NAME_PATTERN,MOD_DELIM=INTERNAL.MOD_DELIM,ELEM_DELIM=INTERNAL.ELEM_DELIM,EXTRACT_MODS_RE=RegExp("[^"+MOD_DELIM+"]"+MOD_DELIM+"("+NAME_PATTERN+")"+"(?:"+MOD_DELIM+"("+NAME_PATTERN+"))?$"),buildModPostfix=INTERNAL.buildModPostfix,buildClass=INTERNAL.buildClass,slice=Array.prototype.slice,reverse=Array.prototype.reverse;function init(domElem,uniqInitId){var domNode=domElem[0];$.each(getParams(domNode),function(blockName,params){processParams(params,domNode,blockName,uniqInitId);var block=uniqIdToBlock[params.uniqId];if(block){if(block.domElem.index(domNode)<0){block.domElem=block.domElem.add(domElem);$.extend(block._params,params)}}else{initBlock(blockName,domElem,params)}})}function initBlock(blockName,domElem,params,forceLive,callback){if(typeof params==="boolean"){callback=forceLive;forceLive=params;params=undefined}var domNode=domElem[0];if(domNode&&domNode.dataset!==undefined){if(domNode.dataset.lego==="react"){return}}params=processParams(params||getParams(domNode)[blockName],domNode,blockName);var uniqId=params.uniqId;if(uniqIdToBlock[uniqId]){return uniqIdToBlock[uniqId]._init()}uniqIdToDomElems[uniqId]=uniqIdToDomElems[uniqId]?uniqIdToDomElems[uniqId].add(domElem):domElem;var parentDomNode=domNode.parentNode;if(!parentDomNode||parentDomNode.nodeType===11){$.unique(uniqIdToDomElems[uniqId])}var BlockClass=blocks[blockName]||DOM.decl(blockName,{},{live:true});if(!(BlockClass._liveInitable=Boolean(BlockClass._processLive()))||forceLive||params.live===false){forceLive&&domElem.addClass("i-bem");var block=new BlockClass(uniqIdToDomElems[uniqId],params,Boolean(forceLive));delete uniqIdToDomElems[uniqId];callback&&callback.apply(block,slice.call(arguments,4));return block}}function processParams(params,domNode,blockName,uniqInitId){(params||(params={})).uniqId||(params.uniqId=(params.id?blockName+"-id-"+params.id:$.identify())+(uniqInitId||$.identify()));var domUniqId=$.identify(domNode),domParams=domElemToParams[domUniqId]||(domElemToParams[domUniqId]={});domParams[blockName]||(domParams[blockName]=params);return params}function findDomElem(ctx,selector,excludeSelf){var res=ctx.find(selector);return excludeSelf?res:res.add(ctx.filter(selector))}function getParams(domNode){var uniqId=$.identify(domNode);return domElemToParams[uniqId]||(domElemToParams[uniqId]=extractParams(domNode))}function extractParams(domNode){var fn,elem,attr=domNode.getAttribute("data-bem");if(attr){return JSON.parse(attr)}if(+0){fn=domNode.onclick||domNode.ondblclick;if(!fn&&domNode.tagName.toLowerCase()=="body"){elem=$(domNode);attr=elem.attr("onclick")||elem.attr("ondblclick");attr&&(fn=new Function(attr))}}return fn?fn():{}}function cleanupDomNode(domNode){delete domElemToParams[$.identify(domNode)]}function removeDomNodeFromBlock(block,domNode){block.domElem.length===1?block.destruct(true):block.domElem=block.domElem.not(domNode)}$.fn.bem=function(blockName,params){return initBlock(blockName,this,params,true)};var DOM=window.BEM.DOM=window.BEM.decl("i-bem__dom",{__constructor:function(domElem,params,initImmediately){var _this=this;_this.domElem=domElem;_this._eventNameCache={};_this._elemCache={};_this._blockInsideCache={};uniqIdToBlock[_this._uniqId=params.uniqId||$.identify(_this)]=_this;_this._needSpecialUnbind=false;_this.__base(null,params,initImmediately)},findBlocksInside:function(elem,block){return this._findBlocks("find",elem,block)},findBlockInside:function(elem,block){var cacheKey=this._buildBlockCacheKey(elem,block),bemBlock=this._findBlocks("find",elem,block,true);this._blockInsideCache[cacheKey]=bemBlock;return bemBlock},blockInside:function(elem,block){var cacheKey=this._buildBlockCacheKey(elem,block),bemBlock=this._blockInsideCache[cacheKey];if(!bemBlock){bemBlock=this.findBlockInside(elem,block)}return bemBlock},dropBlockInsideCache:function(elem,block){if(elem||block){this._blockInsideCache[this._buildBlockCacheKey(elem,block)]=null}else{this._blockInsideCache={}}},_buildBlockCacheKey:function(elem,block){if(!block){block=elem;elem=""}var blockClass=typeof block==="string"?block:buildClass(block.block,block.modName,block.modVal),elemName=typeof elem==="string"?elem:elem.__bemElemName;return elemName+":"+blockClass},findBlocksOutside:function(elem,block){return this._findBlocks("parents",elem,block)},findBlockOutside:function(elem,block){return this._findBlocks("closest",elem,block)[0]||null},findBlocksOn:function(elem,block){return this._findBlocks("",elem,block)},findBlockOn:function(elem,block){return this._findBlocks("",elem,block,true)},_findBlocks:function(select,elem,block,onlyFirst){if(!this.domElem){return onlyFirst?null:[]}if(!block){block=elem;elem=undefined}var ctxElem=elem?typeof elem==="string"?this.findElem(elem):elem:this.domElem,isSimpleBlock=typeof block==="string",blockName=isSimpleBlock?block:block.block||block.blockName,selector="."+(isSimpleBlock?blockName:buildClass(blockName,block.modName,block.modVal))+(onlyFirst?":first":""),domElems=ctxElem.filter(selector);select&&(domElems=domElems.add(ctxElem[select](selector)));if(onlyFirst){return domElems[0]?initBlock(blockName,domElems.eq(0),true):null}var res=[],uniqIds={};$.each(domElems,function(i,domElem){var block=initBlock(blockName,$(domElem),true);if(!uniqIds[block._uniqId]){uniqIds[block._uniqId]=true;res.push(block)}});return res},bindToDomElem:function(domElem,event,data,fn){if($.isFunction(data)){fn=data;data=undefined}var _this=this,_fn=function(e){(e.data||(e.data={})).domElem=$(this);return fn.apply(_this,arguments)};fn?domElem.bind(_this._buildEventName(event),data,(_fn.guid=fn.guid=fn.guid||$.guid++,_fn)):$.each(event,function(event,fn){_this.bindToDomElem(domElem,event,data,fn)});return _this},bindToDoc:function(event,data,fn){this._needSpecialUnbind=true;return this.bindToDomElem(doc,event,data,fn)},bindToWin:function(event,data,fn){if($.isFunction(data)){fn=data;data=undefined}this._needSpecialUnbind=true;return this.bindToDomElem(win,event,data,fn)},bindTo:function(elem,event,data,fn){var argumentsLength=arguments.length;switch(argumentsLength){case 3:if($.isFunction(data)){fn=data;if(typeof event==="object"){data=event;event=elem;elem=this.domElem}}break;case 2:if($.isFunction(event)){fn=event;event=elem;elem=this.domElem}else if(!(typeof elem==="string"||elem instanceof $)){data=event;event=elem;elem=this.domElem}break;case 1:event=elem;elem=this.domElem;break}typeof elem==="string"&&(elem=this.elem(elem));return this.bindToDomElem(elem,event,data,fn)},unbindFromDomElem:function(domElem,event,fn){domElem.unbind(this._buildEventName(event),fn);return this},unbindFromDoc:function(event,fn){return this.unbindFromDomElem(doc,event,fn)},unbindFromWin:function(event,fn){return this.unbindFromDomElem(win,event,fn)},unbindFrom:function(elem,event,fn){var argLen=arguments.length;if(argLen===1){event=elem;elem=this.domElem}else if(argLen===2&&$.isFunction(event)){fn=event;event=elem;elem=this.domElem}else if(typeof elem==="string"){elem=this.elem(elem)}return this.unbindFromDomElem(elem,event,fn)},_buildEventName:function(event){var _this=this;return event.indexOf(" ")>1?event.split(" ").map(function(e){return _this._buildOneEventName(e)}).join(" "):_this._buildOneEventName(event)},_buildOneEventName:function(event){var eventNameCache=this._eventNameCache;if(event in eventNameCache){return eventNameCache[event]}var uniq="."+this._uniqId;if(event.indexOf(".")===-1){eventNameCache[event]=event+uniq;return eventNameCache[event]}var lego=".bem_"+this.__self._name;eventNameCache[event]=event.split(".").map(function(e,i){return i===0?e+lego:lego+"_"+e}).join("")+uniq;return eventNameCache[event]},_trigger:function(e,data){this.__base.apply(this,arguments);this._ctxTrigger(e,data)},_ctxTrigger:function(e,data){var _this=this,storage=liveEventCtxStorage[_this.__self._buildCtxEventName(e.type)],ctxIds={};storage&&_this.domElem.each(function(){var ctx=this,counter=storage.counter;while(ctx&&counter){var ctxId=$.identify(ctx,true);if(ctxId){if(ctxIds[ctxId]){break}var storageCtx=storage.ctxs[ctxId];if(storageCtx){$.each(storageCtx,function(uniqId,handler){handler.fn.call(handler.ctx||_this,e,data)});counter--}ctxIds[ctxId]=true}ctx=ctx.parentNode}})},getMods:function(elem){var hasElem=elem&&typeof elem!=="string",modCache=this._modCache,modNames=[].slice.call(arguments,hasElem?1:0),res=this._extractMods(modNames,hasElem?elem:undefined);if(!hasElem){modNames.length?modNames.forEach(function(name){modCache[name]=res[name]}):modCache=res}return res},setMod:function(elem,modName,modVal){if(elem&&typeof modVal!=="undefined"&&elem.length>1){var _this=this;elem.each(function(){var item=$(this);item.__bemElemName=elem.__bemElemName;_this.setMod(item,modName,modVal)});return _this}return this.__base(elem,modName,modVal)},_extractModVal:function(modName,elem,elemName){var domElem=(elem||this.domElem)[0],matches;domElem&&(matches=domElem.getAttribute("class").match(this.__self._buildModValRE(modName,elemName||elem)));return matches?matches[2]||true:""},_extractMods:function(modNames,elem){var res={},extractAll=!modNames.length,countMatched=0;((elem||this.domElem).eq(0).attr("class").match(this.__self._buildModValRE("("+(extractAll?NAME_PATTERN:modNames.join("|"))+")",elem,"g"))||[]).forEach(function(className){var matches=className.match(EXTRACT_MODS_RE);res[matches[1]]=matches[2]||true;++countMatched});countMatched<modNames.length&&modNames.forEach(function(modName){modName in res||(res[modName]="")});return res},_afterSetMod:function(modName,modVal,oldModVal,elem,elemName){if(this._isDestructing){return this.__base.apply(this,arguments)}var _self=this.__self,classPrefix=_self._buildModClassPrefix(modName,elemName),classRE=_self._buildModValRE(modName,elemName,"g"),needDel=modVal===""||modVal===false;(elem||this.domElem).each(function(){var $this=$(this),className=$this.attr("class"),modClassName=classPrefix;modVal!==true&&(modClassName+=MOD_DELIM+modVal);(oldModVal===true?classRE.test(className):(" "+className).indexOf(" "+classPrefix+MOD_DELIM)>-1)?$this.attr("class",className.replace(classRE,needDel?"":"$1"+modClassName)):needDel||$this.addClass(modClassName)});elemName&&this.dropElemCache(elemName,modName,oldModVal).dropElemCache(elemName,modName,modVal);this.__base.apply(this,arguments)},findElem:function(ctx,names,modName,modVal){if(arguments.length%2){modVal=modName;modName=names;names=ctx;ctx=this.domElem}else if(typeof ctx==="string"){ctx=this.findElem(ctx)}names=names.split(" ");var blockName=this.__self.getName(),modPostfix=buildModPostfix(modName,modVal),selectors=[],keys=names.map(function(name){selectors.push("."+buildClass(blockName,name,modName,modVal));return name+modPostfix}),isSingleName=keys.length===1,res=findDomElem(ctx,selectors.join(","));ctx===this.domElem&&selectors.forEach(function(selector,i){(this._elemCache[keys[i]]=isSingleName?res:res.filter(selector)).__bemElemName=names[i]},this);return res},_elem:function(name,modName,modVal){return this._elemCache[name+buildModPostfix(modName,modVal)]||this.findElem(name,modName,modVal)},elem:function(names,modName,modVal){if(arguments.length===2){modVal=true}if(modName&&typeof modName!=="string"){modName.__bemElemName=names;return modName}if(names.indexOf(" ")<0){return this._elem(names,modName,modVal)}var res=$([]);names.split(" ").forEach(function(name){res=res.add(this._elem(name,modName,modVal))},this);return res},dropElemCache:function(names,modName,modVal){if(names){var modPostfix=buildModPostfix(modName,modVal);names.indexOf(" ")<0?delete this._elemCache[names+modPostfix]:names.split(" ").forEach(function(name){delete this._elemCache[name+modPostfix]},this)}else{this._elemCache={}}return this},elemParams:function(elem){var elemName;if(typeof elem==="string"){elemName=elem;elem=this.elem(elem)}else{elemName=this.__self._extractElemNameFrom(elem)}return extractParams(elem[0])[buildClass(this.__self.getName(),elemName)]||{}},elemify:function(elem,elemName){(elem=$(elem)).__bemElemName=elemName;return elem},containsDomElem:function(domElem){var res=false;this.domElem.each(function(){return!(res=domElem.parents().andSelf().index(this)>-1)});return res},buildSelector:function(elem,modName,modVal){return this.__self.buildSelector(elem,modName,modVal)},destruct:function(keepDOM){var _this=this,_self=_this.__self;if(_this._isDestructing){return}_this._isDestructing=true;_this._needSpecialUnbind&&_self.doc.add(_self.win).unbind("."+_this._uniqId);_this.dropElemCache().domElem.each(function(i,domNode){var params=getParams(domNode);$.each(params,function(blockName,blockParams){var block=uniqIdToBlock[blockParams.uniqId];block?block._isDestructing||removeDomNodeFromBlock(block,domNode):delete uniqIdToDomElems[blockParams.uniqId]});cleanupDomNode(domNode)});keepDOM||_this.domElem.remove();_this.__base();delete uniqIdToBlock[_this.un()._uniqId];delete _this.domElem;delete _this._elemCache}},{scope:null,doc:doc,win:win,html:$(document.documentElement),_processLive:function(heedLive){var res=this._liveInitable;if("live"in this){var noLive=typeof res==="undefined";if(noLive^heedLive){res=this.live()!==false;var blockName=this.getName(),origLive=this.live;this.live=function(){return this.getName()===blockName?res:origLive.apply(this,arguments)}}}return res},init:function(ctx,callback,callbackCtx){if(!ctx||$.isFunction(ctx)){callbackCtx=callback;callback=ctx;ctx=doc}else if(typeof ctx==="string"){ctx=$(ctx)}var uniqInitId=$.identify();findDomElem(ctx,".i-bem").each(function(){init($(this),uniqInitId)});callback&&this.afterCurrentEvent(function(){callback.call(callbackCtx||this,ctx)});this._runAfterCurrentEventFns();return ctx},destruct:function(keepDOM,ctx,excludeSelf){if(typeof keepDOM!="boolean"){excludeSelf=ctx;ctx=keepDOM;keepDOM=undefined}if(!ctx){return}reverse.call(findDomElem(ctx,".i-bem",excludeSelf)).each(function(i,domNode){var params=getParams(this);$.each(params,function(blockName,blockParams){if(blockParams.uniqId){var block=uniqIdToBlock[blockParams.uniqId];block?removeDomNodeFromBlock(block,domNode):delete uniqIdToDomElems[blockParams.uniqId]}});cleanupDomNode(this)});keepDOM||(excludeSelf?ctx.empty():ctx.remove())},update:function(ctx,content,callback,callbackCtx){this.destruct(ctx,true);return this.init(ctx.html(content),callback,callbackCtx)},replace:function(ctx,content){this.destruct(true,ctx);return this.init($(content).replaceAll(ctx))},append:function(ctx,content){return this.init($(content).appendTo(ctx))},prepend:function(ctx,content){return this.init($(content).prependTo(ctx))},before:function(ctx,content){return this.init($(content).insertBefore(ctx))},after:function(ctx,content){return this.init($(content).insertAfter(ctx))},_buildCtxEventName:function(e){return this._name+":"+e},_liveClassBind:function(className,e,callback,invokeOnInit){var _this=this;if(e.indexOf(" ")>-1){e.split(" ").forEach(function(e){_this._liveClassBind(className,e,callback,invokeOnInit)})}else{var storage=liveClassEventStorage[e],uniqId=$.identify(callback);if(!storage){storage=liveClassEventStorage[e]={};doc.bind(e,_this._liveClassTrigger.bind(_this))}storage=storage[className]||(storage[className]={uniqIds:{},fns:[]});if(!(uniqId in storage.uniqIds)){storage.fns.push({uniqId:uniqId,fn:_this._buildLiveEventFn(callback,invokeOnInit)});storage.uniqIds[uniqId]=storage.fns.length-1}}return this},_liveClassUnbind:function(className,e,callback){var storage=liveClassEventStorage[e];if(storage){if(callback){if(storage=storage[className]){var uniqId=$.identify(callback);if(uniqId in storage.uniqIds){var i=storage.uniqIds[uniqId],len=storage.fns.length-1;storage.fns.splice(i,1);while(i<len){storage.uniqIds[storage.fns[i++].uniqId]=i-1}delete storage.uniqIds[uniqId]}}}else{delete storage[className]}}return this},_liveClassTrigger:function(e){var storage=liveClassEventStorage[e.type];if(!storage){return}var node=e.target,classNames=Object.keys(storage);do{var nodeClassName=" "+node.className+" ",className,i=0;while(className=classNames[i++]){if(nodeClassName.indexOf(" "+className+" ")===-1){continue}var stopPropagationAndPreventDefault=false,fns=storage[className].fns;for(var j=0;j<fns.length;j++){if(fns[j].fn.apply($(node),arguments)===false){stopPropagationAndPreventDefault=true}}stopPropagationAndPreventDefault&&e.preventDefault();if(stopPropagationAndPreventDefault||e.isPropagationStopped()){return}classNames.splice(--i,1)}}while(classNames.length&&(node=node.parentNode))},_buildLiveEventFn:function(callback,invokeOnInit){var _this=this;return function(e){var args=[_this._name,((e.data||(e.data={})).domElem=$(this)).closest(_this.buildSelector()),true],block=initBlock.apply(null,invokeOnInit?args.concat([callback,e]):args);if(block&&!invokeOnInit&&callback){return callback.apply(block,arguments)}}},liveInitOnEvent:function(elemName,event,callback){return this.liveBindTo(elemName,event,callback,true)},liveBindTo:function(to,event,callback,invokeOnInit){if(!event||$.isFunction(event)){callback=event;event=to;to=undefined}if(!to||typeof to==="string"){to={elem:to}}to.elemName&&(to.elem=to.elemName);var _this=this;if(to.elem&&to.elem.indexOf(" ")>0){to.elem.split(" ").forEach(function(elem){_this._liveClassBind(buildClass(_this._name,elem,to.modName,to.modVal),event,callback,invokeOnInit)});return _this}return _this._liveClassBind(buildClass(_this._name,to.elem,to.modName,to.modVal),event,callback,invokeOnInit)},liveUnbindFrom:function(elem,event,callback){if(!event||$.isFunction(event)){callback=event;event=elem;elem=undefined}var _this=this;if(elem&&elem.indexOf(" ")>1){elem.split(" ").forEach(function(elem){_this._liveClassUnbind(buildClass(_this._name,elem),event,callback)});return _this}return _this._liveClassUnbind(buildClass(_this._name,elem),event,callback)},_liveInitOnBlockEvent:function(event,blockName,callback,findFnName){var name=this._name;blocks[blockName].on(event,function(e){if(!e.block.domElem){return}var args=arguments,blocks=e.block[findFnName](name);callback&&blocks.forEach(function(block){callback.apply(block,args)})});return this},liveInitOnBlockEvent:function(event,blockName,callback){return this._liveInitOnBlockEvent(event,blockName,callback,"findBlocksOn")},liveInitOnBlockInsideEvent:function(event,blockName,callback){return this._liveInitOnBlockEvent(event,blockName,callback,"findBlocksOutside")},on:function(ctx,e,data,fn,fnCtx){return ctx.jquery?this._liveCtxBind(ctx,e,data,fn,fnCtx):this.__base(ctx,e,data,fn,fnCtx)},un:function(ctx,e,fn,fnCtx){return ctx.jquery?this._liveCtxUnbind(ctx,e,fn,fnCtx):this.__base(ctx,e,fn)},liveCtxBind:function(ctx,e,data,fn,fnCtx){return this._liveCtxBind(ctx,e,data,fn,fnCtx)},_liveCtxBind:function(ctx,e,data,fn,fnCtx){var _this=this;if(typeof e==="object"){if($.isFunction(data)||$.isFunction(fn)){e=this._buildModEventName(e)}}if(typeof e==="string"){if($.isFunction(data)){fnCtx=fn;fn=data;data=undefined}if(e.indexOf(" ")>-1){e.split(" ").forEach(function(e){_this._liveCtxBind(ctx,e,data,fn,fnCtx)})}else{var ctxE=_this._buildCtxEventName(e),storage=liveEventCtxStorage[ctxE]||(liveEventCtxStorage[ctxE]={counter:0,ctxs:{}});ctx.each(function(){var ctxId=$.identify(this),ctxStorage=storage.ctxs[ctxId];if(!ctxStorage){ctxStorage=storage.ctxs[ctxId]={};++storage.counter}ctxStorage[$.identify(fn)+(fnCtx?$.identify(fnCtx):"")]={fn:fn,data:data,ctx:fnCtx}})}}else{$.each(e,function(e,fn){_this._liveCtxBind(ctx,e,fn,data)})}return _this},liveCtxUnbind:function(ctx,e,fn,fnCtx){return this._liveCtxUnbind(ctx,e,fn,fnCtx)},_liveCtxUnbind:function(ctx,e,fn,fnCtx){if(typeof e==="object"&&$.isFunction(fn)){e=this._buildModEventName(e)}var _this=this,storage=liveEventCtxStorage[e=_this._buildCtxEventName(e)];if(storage){ctx.each(function(){var ctxId=$.identify(this,true),ctxStorage;if(ctxId&&(ctxStorage=storage.ctxs[ctxId])){fn&&delete ctxStorage[$.identify(fn)+(fnCtx?$.identify(fnCtx):"")];if(!fn||$.isEmptyObject(ctxStorage)){storage.counter--;delete storage.ctxs[ctxId]}}});storage.counter||delete liveEventCtxStorage[e]}return _this},_extractElemNameFrom:function(elem){if(elem.__bemElemName){return elem.__bemElemName}var matches=elem.eq(0).attr("class").match(this._buildElemNameRE());return matches?matches[1]:undefined},extractParams:extractParams,_buildModClassPrefix:function(modName,elem){return this._name+(elem?ELEM_DELIM+(typeof elem==="string"?elem:this._extractElemNameFrom(elem)):"")+MOD_DELIM+modName},_buildModValRE:function(modName,elem,quantifiers){return new RegExp("(\\s|^)"+this._buildModClassPrefix(modName,elem)+"(?:"+MOD_DELIM+"("+NAME_PATTERN+"))?(?=\\s|$)",quantifiers)},_buildElemNameRE:function(){return new RegExp(this._name+ELEM_DELIM+"("+NAME_PATTERN+")(?:\\s|$)")},buildSelector:function(elem,modName,modVal){return"."+buildClass(this._name,elem,modName,modVal)},getBlockByUniqId:function(uniqId){return uniqIdToBlock[uniqId]},getWindowSize:function(){return{width:win.width(),height:win.height()}}});$(function(){window.BEM.DOM.scope=$("body")})})(BEM,jQuery);window.BEM.DOM.decl({block:"example",modName:"tooltip"},{onSetMod:{js:{inited:function(){var button=this.findBlockInside("button2"),tooltip=this.findBlockInside("tooltip");tooltip.setOwner(button).setMod("shown","yes");button.on("click",function(){tooltip.toggleMod("shown","yes","")})}}}});window.BEM.DOM.decl("progress",{onSetMod:{js:{inited:function(){this.update(this.params.value,this.params.timing)}}},update:function(value,timing){this.setMod("timing",timing||"").domElem.css({width:value<=0?"0":value>=1?"100%":(value*100).toPrecision(2)+"%"}).css("width");return this}});window.BEM.DOM.decl("select2",{onSetMod:{js:{inited:function(){this.button=this.findBlockOn("button","button2");this.initSelect()}},disabled:{"*":function(modName,modVal){this.button.setMod(modName,modVal)}}},initSelect:$.noop,getVal:$.noop,setPrevVal:$.noop,getPrevVal:$.noop,getClearVal:$.noop,setVal:$.noop,_onControlChange:$.noop,_onButtonKeypress:$.noop,_onButtonKeydown:$.noop,_changeIcon:$.noop,_buildLeftIcon:$.noop,_setMinWidth:$.noop},{live:function(){this.liveInitOnBlockInsideEvent("init","button2");this.liveBindTo("control","pointerdown").liveBindTo("pointerdown",function(){});this.liveBindTo("button","keydown",function(e){this._onButtonKeydown(e)}).liveBindTo("button","keypress",function(e){this._onButtonKeypress(e)})}});window.BEM.DOM.decl("select2",{onSetMod:{disabled:{"*":function(modName,modVal){this.__base.apply(this,arguments);this.control.prop("disabled",Boolean(modVal))}}},initSelect:function(){this.control=this.elem("control");var currentVal=this.getVal();this.initialVal=this.button.getText();this.setPrevVal(currentVal);window.BEM.afterCurrentEvent(function(){if(!this.control||!this.control.length||!this.domElem){return}var controlVal=this.getVal();if(controlVal&&controlVal.length!==0&&controlVal!==currentVal){this.setVal(controlVal)}},this);this.bindTo("control","change",function(e){this._onControlChange(e)})},getVal:function(){var val=this.control.val();if(!val){var options=this.getOptions();if(options.length){return options[0].value}return[]}return val},setVal:function(val){if(this.getVal()===val){return}var options=this.getOptions();for(var i=0;i<options.length;i++){var option=options[i];if(option.value===val){this.control[0].value=val;this.button.setText(option.text);this.triggerChange();break}}},setPrevVal:function(val){this.prevVal=val},getPrevVal:function(){return this.prevVal},getClearVal:function(val){if(val&&val.length===1){return val[0]}return val},triggerChange:function(){this.trigger("change",{prevVal:this.getClearVal(this.getPrevVal()),currVal:this.getClearVal(this.getVal())})},controlChange:function(val){var options=this.getOptions();for(var i=0;i<options.length;i++){var option=options[i];if(option.value===val){this.button.setText(option.text);break}}},_onControlChange:function(e,data){var val=this.getVal();this.controlChange(val);this.triggerChange();this.setPrevVal(val)},getOptions:function(){return Array.prototype.slice.call(this.control[0].options)},getName:function(){return this.control.attr("name")},setName:function(name){this.control.attr("name",name);this.trigger("setName")},reset:function(){this.setVal(this.initialVal);this.button.setText(this.initialVal);this.trigger("reset")}});window.BEM.DOM.decl("popup2",{onSetMod:{js:{inited:function(){this._parentPopup=undefined;this._zIndex=null;this._zIndexGroupLevel=null;this._scope=BEM.DOM.scope;this._isAttachedToScope=false}},visible:{yes:function(){this.trigger("beforeOpen");this._makeEventOnAnimationEnd("Open");if(!this._isAttachedToScope){this._scope.append(this.domElem);this._isAttachedToScope=true}this._captureZIndex()._bindToParentPopup().bindTo("pointerdown pointerclick",this._setPreventHideByClick)},"":function(){this.trigger("beforeClose")._releaseZIndex()._unbindFromParentPopup().unbindFrom("pointerdown pointerclick");this._makeEventOnAnimationEnd("Close")}}},destruct:function(){this.delMod("visible");this.__base.apply(this,arguments)},setScope:function(elem){this._scope=elem;this._isAttachedToScope=false;return this},setContent:function(content){BEM.DOM.update(this.domElem,content);return this},_calcZIndexGroupLevel:function(){var res=this.params.zIndexGroupLevel,parentPopup=this._getParentPopup();if(parentPopup){res+=parentPopup._zIndexGroupLevel}return res},_setPreventHideByClick:function(){var curPopup=this;do{curPopup._preventHideByClick=true;curPopup=curPopup._getParentPopup()}while(curPopup)},_bindToParentPopup:function(){var parentPopup=this._getParentPopup();parentPopup&&parentPopup.on("beforeClose",this._onParentPopupClose,this);return this},_unbindFromParentPopup:function(){this._parentPopup&&this._parentPopup.un("beforeClose",this._onParentPopupClose,this);this._parentPopup=undefined;return this},_onParentPopupClose:function(){this.delMod("visible")},_getParentPopup:function(){return this._parentPopup},_captureZIndex:function(){if(this._zIndexGroupLevel===null){this._zIndexGroupLevel=this._calcZIndexGroupLevel()}var visiblePopupsZIndexes=this.__self._visiblePopupsZIndexes,level=this._zIndexGroupLevel,zIndexes=visiblePopupsZIndexes[level],prevZIndex=this._zIndex;if(!zIndexes){zIndexes=visiblePopupsZIndexes[level]=[(level+1)*this.__self.ZINDEX_FACTOR]}this._zIndex=zIndexes[zIndexes.length-1]+1;zIndexes.push(this._zIndex);if(this._zIndex!==prevZIndex){this.domElem.css("z-index",this._zIndex)}return this},_releaseZIndex:function(){var zIndexes=this.__self._visiblePopupsZIndexes[this._zIndexGroupLevel];if(zIndexes){zIndexes.splice(zIndexes.indexOf(this._zIndex),1)}return this},_recaptureZIndex:function(){this._releaseZIndex();this._zIndexGroupLevel=null;return this._captureZIndex()},getDefaultParams:function(){return{zIndexGroupLevel:0}},_makeEventOnAnimationEnd:function(eventName){var elem=this.domElem;var style=window.getComputedStyle?window.getComputedStyle(elem[0]):elem[0].currentStyle;var animationEndEvent=parseFloat(style.animationDuration)>0?"animationend":parseFloat(style.webkitAnimationDuration)>0?"webkitAnimationEnd":"";var onAnimationEnd=function(){this.trigger("after"+eventName)};if(animationEndEvent){elem.one(animationEndEvent,onAnimationEnd.bind(this))}else{this.afterCurrentEvent(onAnimationEnd)}}},{live:true,_visiblePopupsZIndexes:{},ZINDEX_FACTOR:1e3});window.BEM.DOM.decl("popup2",{attachToScope:function(scope){if(scope){this._scope=scope}this._scope.append(this.domElem);this._isAttachedToScope=true;return this}});window.BEM.DOM.decl({block:"popup2",modName:"target"},{onSetMod:{js:{inited:function(){var AVAILABLE_DIRECTIONS,invalidDirections;console.assert(!(AVAILABLE_DIRECTIONS=this.__self.AVAILABLE_DIRECTIONS,invalidDirections=this.params.directions.filter(function(d){return AVAILABLE_DIRECTIONS.indexOf(d)===-1})).length,'popup2: Неверные направления раскрытия: "'+invalidDirections.join('", "')+'" directions.'+" Available directions: "+AVAILABLE_DIRECTIONS.join(", "));this.__base.apply(this,arguments);this._lastPopupDrawingCss={left:undefined,top:undefined,zIndex:undefined,display:undefined};this._lastTailDrawingCss={left:undefined,top:undefined};this._initialVisible=this.hasMod("visible")}},visible:{yes:function(){this.__base.apply(this,arguments);this.bindToWin("scroll resize",this._onWinScrollAndResize).redraw(true)},"":function(){this.__base.apply(this,arguments);this.unbindFromWin("scroll resize")}}},setContent:function(){return this.__base.apply(this,arguments).redraw()},_draw:function(){var bestDrawingParams=this._calcBestDrawingParams();this.setMod("direction",bestDrawingParams.direction);if(updateObjectWithParams(this._lastPopupDrawingCss,this._calcDrawingCss(bestDrawingParams))){this.domElem.css(this._lastPopupDrawingCss)}if(updateObjectWithParams(this._lastTailDrawingCss,this._calcTailDrawingCss(bestDrawingParams))){this.elem("tail").css(this._lastTailDrawingCss)}return this;function updateObjectWithParams(obj,params){var updated=false;Object.keys(params).forEach(function(key){var val=params[key];if(obj[key]!==val){obj[key]=val;updated=true}});return updated}},redraw:function(becomesVisible){if(!this.hasMod("visible","yes")&&!becomesVisible){return this}this.setMod("outside","yes")._draw().delMod("outside");return this},_calcDrawingCss:function(drawingParams){var scope=this._scope,offset;if(!scope.is(BEM.DOM.scope)){offset=scope.offset();drawingParams.top-=offset.top;drawingParams.left-=offset.left}return{left:drawingParams.left,top:drawingParams.top}},_calcTailDrawingCss:function(drawingParams){return drawingParams.tail},calcPossibleDrawingParams:function(){var target=this._calcTargetDimensions(),viewport=this._calcViewportDimensions(),offsets=this._calcOffsets();return this.params.directions.map(function(direction){var res={direction:direction,width:0,height:0,left:0,top:0};if(this._checkMainDirection(direction,"bottom")){res.top=target.top+target.height+offsets.main;res.height=viewport.bottom-res.top-offsets.viewport}else if(this._checkMainDirection(direction,"top")){res.height=target.top-viewport.top-offsets.main-offsets.viewport;res.top=target.top-res.height-offsets.main}else{if(this._checkSecondaryDirection(direction,"center")){res.height=viewport.bottom-viewport.top-2*offsets.viewport;res.top=target.top+(target.height-res.height)/2}else if(this._checkSecondaryDirection(direction,"bottom")){res.height=target.top+target.height-viewport.top-offsets.secondary-offsets.viewport;res.top=target.top+target.height-res.height-offsets.secondary}else if(this._checkSecondaryDirection(direction,"top")){res.top=target.top+offsets.secondary;res.height=viewport.bottom-res.top-offsets.viewport}if(this._checkMainDirection(direction,"left")){res.width=target.left-viewport.left-offsets.main-offsets.viewport;res.left=target.left-res.width-offsets.main}else{res.left=target.left+target.width+offsets.main;res.width=viewport.right-res.left-offsets.viewport}}if(this._checkSecondaryDirection(direction,"right")){res.width=target.left+target.width-viewport.left-offsets.secondary-offsets.viewport;res.left=target.left+target.width-res.width-offsets.secondary}else if(this._checkSecondaryDirection(direction,"left")){res.left=target.left+offsets.secondary;res.width=viewport.right-res.left-offsets.viewport}else if(this._checkSecondaryDirection(direction,"center")){if(this._checkMainDirection(direction,"top","bottom")){res.width=viewport.right-viewport.left-2*offsets.viewport;res.left=target.left+target.width/2-res.width/2}}return res},this)},_calcBestDrawingParams:function(){var popup=this._calcPopupDimensions(),target=this._calcTargetDimensions(),viewport=this._calcViewportDimensions(),directions=this.params.directions,directionsLength=directions.length,direction,pos,viewportFactor,bestDirection,bestPos,bestViewportFactor;for(var i=0;i<directionsLength;i++){direction=directions[i];pos=this._calcPos(direction,target,popup);viewportFactor=this._calcViewportFactor(pos,viewport,popup);if(i===0||viewportFactor>bestViewportFactor||!bestViewportFactor&&this.hasMod("direction",direction)){bestDirection=direction;bestViewportFactor=viewportFactor;bestPos=pos}if(bestViewportFactor>this.__self.VIEWPORT_ACCURACY_FACTOR){break}}return{direction:bestDirection,left:bestPos.left,top:bestPos.top,tail:this._calcTailPos(bestDirection,target,popup,bestPos)}},_calcPopupDimensions:function(){var popupWidth=this.domElem.outerWidth(),popupHeight=this.domElem.outerHeight();return{width:popupWidth,height:popupHeight,innerWidth:this.domElem.innerWidth(),innerHeight:this.domElem.innerHeight(),area:popupWidth*popupHeight}},_calcTailDimension:function(){var tail=this.elem("tail");var tailSize=this.params.tailSize||tail.outerWidth();return tail.length>0?tailSize:0},_calcTargetDimensions:function(){},_calcViewportDimensions:function(){var win=BEM.DOM.win,winTop=win.scrollTop(),winLeft=win.scrollLeft(),winWidth=win.width(),winHeight=win.height();return{top:winTop,left:winLeft,bottom:winTop+winHeight,right:winLeft+winWidth}},_calcPos:function(direction,target,popup){var res={},offsets=this._calcOffsets();if(this._checkMainDirection(direction,"bottom")){res.top=target.top+target.height+offsets.main}else if(this._checkMainDirection(direction,"top")){res.top=target.top-popup.height-offsets.main}else if(this._checkMainDirection(direction,"left")){res.left=target.left-popup.width-offsets.main}else if(this._checkMainDirection(direction,"right")){res.left=target.left+target.width+offsets.main}if(this._checkSecondaryDirection(direction,"right")){res.left=target.left+target.width-popup.width-offsets.secondary}else if(this._checkSecondaryDirection(direction,"left")){res.left=target.left+offsets.secondary}else if(this._checkSecondaryDirection(direction,"bottom")){res.top=target.top+target.height-popup.height-offsets.secondary}else if(this._checkSecondaryDirection(direction,"top")){res.top=target.top+offsets.secondary}else if(this._checkSecondaryDirection(direction,"center")){if(this._checkMainDirection(direction,"top","bottom")){res.left=target.left+target.width/2-popup.width/2}else if(this._checkMainDirection(direction,"left","right")){res.top=target.top+target.height/2-popup.height/2}}return res},_calcTailPos:function(direction,target,popup,pos){var res={},halfOfTail=this._calcTailDimension()/2,tailOffset=this.params.tailOffset,tailSize=this.params.tailSize;if(this._checkMainDirection(direction,"bottom")){res.top=-halfOfTail}else if(this._checkMainDirection(direction,"top")){res.top=Math.floor(popup.innerHeight-halfOfTail)}else if(this._checkMainDirection(direction,"left")){res.left=Math.floor(popup.innerWidth-halfOfTail)}else if(this._checkMainDirection(direction,"right")){res.left=-halfOfTail}if(this._checkSecondaryDirection(direction,"right")){res.left=popup.innerWidth-Math.ceil(Math.min(popup.innerWidth,target.width)/2)-halfOfTail-tailOffset}else if(this._checkSecondaryDirection(direction,"left")){res.left=Math.ceil(Math.min(popup.innerWidth,target.width)/2)-halfOfTail+tailOffset}else if(this._checkSecondaryDirection(direction,"bottom")){res.top=popup.innerHeight-Math.ceil(Math.min(popup.innerHeight,target.height)/2)-halfOfTail-tailOffset}else if(this._checkSecondaryDirection(direction,"top")){res.top=Math.ceil(Math.min(popup.innerHeight,target.height)/2)-halfOfTail+tailOffset}else if(this._checkSecondaryDirection(direction,"center")){if(this._checkMainDirection(direction,"top","bottom")){res.left=Math.ceil(popup.innerWidth/2)-halfOfTail+tailOffset}else{res.top=Math.ceil(popup.innerHeight/2)-halfOfTail+tailOffset}}return{top:res.top,left:res.left,width:tailSize,height:tailSize}},_calcViewportFactor:function(pos,viewport,popup){var viewportOffset=this.params.viewportOffset,intersectionLeft=Math.max(pos.left,viewport.left+viewportOffset),intersectionRight=Math.min(pos.left+popup.width,viewport.right-viewportOffset),intersectionTop=Math.max(pos.top,viewport.top+viewportOffset),intersectionBottom=Math.min(pos.top+popup.height,viewport.bottom-viewportOffset);if(!(intersectionLeft<intersectionRight&&intersectionTop<intersectionBottom)){return 0}return(intersectionRight-intersectionLeft)*(intersectionBottom-intersectionTop)/popup.area},_calcOffsets:function(){var params=this.params,tailDimension=this._calcTailDimension();return{main:params.mainOffset>=0&&tailDimension>0?Math.max(params.mainOffset,Math.round(tailDimension*Math.SQRT1_2)):params.mainOffset,secondary:params.secondaryOffset,viewport:params.viewportOffset}},_checkMainDirection:function(direction,mainDirection1,mainDirection2){return direction.indexOf(mainDirection1)===0||mainDirection2&&direction.indexOf(mainDirection2)===0},_checkSecondaryDirection:function(direction,secondaryDirection){return direction.indexOf("-"+secondaryDirection)>0},_checkDirection:function(direction,directionPart){return direction.indexOf(directionPart)>=0},_onWinScollAndResize:function(e){console.error("popup2: _onWinScollAndResize объявлена deprecated - используйте _onWinScrollAndResize");this._onWinScrollAndResize(e)},_onWinScrollAndResize:function(e){this.hasMod("visible","yes")&&this._draw()},getDefaultParams:function(){return $.extend(this.__base.apply(this,arguments),{mainOffset:0,secondaryOffset:0,viewportOffset:0,tailOffset:0,directions:this.__self.AVAILABLE_DIRECTIONS})},_setVisible:function(){if(this._initialVisible){this._initialVisible=false;this.delMod("visible").setMod("visible","yes")}}},{VIEWPORT_ACCURACY_FACTOR:.99,AVAILABLE_DIRECTIONS:["bottom-left","bottom-center","bottom-right","top-left","top-center","top-right","right-top","right-center","right-bottom","left-top","left-center","left-bottom"]});window.BEM.DOM.decl("tabs-panes",{onElemSetMod:{pane:{active:{yes:function(elem,modName,modVal){var prev=this.findPane("active","yes");prev.attr("aria-expanded",false);elem.attr("aria-expanded",true);this.delMod(prev,"active")}}}},_onControlChange:function(e,data){if(data.currentIndex===-1){this.delMod(this.findPane().eq(data.prevIndex),"active");return}this.setMod(this.findPane().eq(data.currentIndex),"active","yes")},findPane:function(modName,modVal){return this.domElem.children(this.buildSelector("pane",modName,modVal))}},{getSupportedControls:function(){return["tabs"]},live:function(){this.getSupportedControls().forEach(function(block){BEM.blocks[block]&&this.liveInitOnBlockEvent("change",block,function(e,data){this._onControlChange(e,data)})},this)}});window.BEM.DOM.decl("tabs-menu",{onSetMod:{js:{inited:function(){this._linksCache=[];this._isSwitching=false}}},onElemSetMod:{tab:{active:{yes:function(elem){if(this.hasMod(elem,"outer")){return false}var prev=this.getActive();this._isSwitching=true;this.delMod(prev,"active");this._isSwitching=false;this.trigger("change",{current:elem,prev:prev,currentIndex:this.indexOfTab(elem),prevIndex:this.indexOfTab(prev)})},"":function(elem){if(this._isSwitching){return}this.trigger("change",{current:$(),prev:elem,currentIndex:-1,prevIndex:this.indexOfTab(elem)})}},disabled:function(elem,modName,disabled){var link=this._getLink(elem).setMod("disabled",disabled);if(this.hasMod(elem,"interactive","yes")){link.domElem.removeAttr("tabindex");if(disabled){elem.attr("aria-disabled",true)}else{elem.removeAttr("aria-disabled")}}}}},getActive:function(){return this.findElem("tab","active","yes")},getTab:function(index){return this.elem("tab","interactive","yes").eq(index)},indexOfTab:function(elem){return $.inArray(elem.get(0),this.elem("tab","interactive","yes"))},_getTabByElem:function(elem){return elem.closest(this.buildSelector("tab"))},_getLink:function(tab){var index=$.inArray(tab.get(0),this.elem("tab"));return this._linksCache[index]||(this._linksCache[index]=this.findBlockInside(tab,"link"))},_activateRelative:function(delta){var tabs=this.elem("tab","interactive","yes").not(this.findElem("tab","disabled","yes")),newIndex=$.inArray(this.getActive().get(0),tabs)+delta;if(newIndex<0||newIndex>tabs.length){return}this.setMod(tabs.eq(newIndex),"active","yes")},_onTabClick:function(e){this.setMod(this._getTabByElem($(e.target)),"active","yes")},_onTabKeyDown:function(e){if(e.shiftKey||e.ctrlKey||e.altKey||e.metaKey){return}var keyCodes=BEM.blocks.keycodes;if(keyCodes.is(e.keyCode,"RIGHT","DOWN")){e.preventDefault();this._activateRelative(1)}else if(keyCodes.is(e.keyCode,"LEFT","UP")){e.preventDefault();this._activateRelative(-1)}}},{live:function(){this.liveBindTo("tab","pointerclick",function(e){this.hasMod($(e.data.domElem),"disabled")||this._onTabClick(e)}).liveBindTo("tab","keydown",function(e){this._onTabKeyDown(e)})}});window.BEM.DOM.decl("tabs-menu",{onElemSetMod:{tab:{active:{yes:function(elem){var prev=this.getActive();if(this.__base.apply(this,arguments)===false){return false}elem.attr("tabindex",0);elem.focus();prev.removeAttr("tabindex")}},disabled:function(elem,modName,disabled){this.__base.apply(this,arguments);if(disabled&&this.hasMod(elem,"active")){elem.attr("tabindex",0)}else{elem.removeAttr("tabindex")}}}},_onTabEnter:function(item,e){this.setMod(item,"hovered","yes")},_onTabLeave:function(item,e){this.delMod(item,"hovered")}},{live:function(){this.liveBindTo("tab","pointerover pointerout",function(e){var item=e.data.domElem;if(this.hasMod(item,"disabled")||item[0].contains(e.relatedTarget)){return}e.type==="pointerover"?this._onTabEnter(item,e):this._onTabLeave(item,e)});return this.__base()}});window.BEM.DOM.decl("tooltip",{onSetMod:{js:{inited:function(){this._popup=null;this._owner=null}},shown:{yes:function(){console.assert(this._owner,"tooltip: Пожалуйста, установите owner перед отображением.");this._getPopup().setMod("visible","yes").unbindFromDoc("keydown")},"":function(){this._getPopup().delMod("visible")}}},getOwner:function(){return this._owner},setOwner:function(owner){this._owner=owner;this._getPopup().setAnchor(owner);return this},setContent:function(content){BEM.DOM.update(this.elem("content"),content);return this.redraw()},redraw:function(){if(this.hasMod("shown","yes")){this._getPopup().redraw()}return this},destruct:function(){this.delMod("shown");this.__base.apply(this,arguments)},_getPopup:function(){if(!this._popup){this._popup=this.findBlockOn("popup2").on("beforeOpen",this._onPopupShow,this).on("beforeClose",this._onPopupHide,this)}return this._popup},_onPopupShow:function(){this.trigger("show")},_onPopupHide:function(){this.delMod("shown").trigger("hide")},_onClick:function(){this.trigger("click").delMod("shown")}},{live:function(){this.liveBindTo("click",function(){this._onClick()})}});window.BEM.DOM.decl("tooltip",{_onEnter:function(){this.setMod("hovered","yes")},_onLeave:function(){this.delMod("hovered")}},{live:function(){this.liveBindTo("pointerover pointerout",function(e){if(this.domElem[0].contains(e.relatedTarget)){return}e.type==="pointerover"?this._onEnter(e):this._onLeave(e)});return this.__base()}});window.BEM.DOM.decl({block:"tumbler"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments);this._inputValues=this.elemParams(this.elem("input"))._values;this._labelsLength=this.elem("label").length;this._buttonWidth=this.elem("button").width();this._maxLeft=this.elem("box").width()-this._buttonWidth}},checked:function(mod,checked){var value=this._inputValues[checked?1:0],id=this._labelsLength===2?this.elem("text","side",checked?"right":"left")[0].id:this.elem("text").length?this.elem("text")[0].id:"";this.elem("input").attr("aria-labelledby",id).val(value).prop("checked",checked);this.elem("button").attr("aria-pressed",Boolean(checked));this.trigger("change",{checked:Boolean(checked),value:this.val()})},disabled:function(mod,disabled){this.__base.apply(this,arguments);this.findBlockOn("button","button2").setMod("disabled",disabled);this.elem("input").prop("disabled",Boolean(disabled))}},val:function(val){if(typeof val==="undefined"){return this.elem("input").val()}if(this._inputValues.indexOf(val)===-1||this.val()===val){return this}return this._toggle()},_toggle:function(){this.toggleMod("checked","yes",!this.elem("input").prop("checked"));return this},_onPointerpress:function(e){this.setMod("pressed","yes").bindToDoc("pointerrelease",this._onPointerrelease)},_onPointerrelease:function(e){this.delMod("pressed").unbindFromDoc("pointerrelease")},_onStickerClick:function(){this._toggle();this.findBlockOn(this.elem("button"),"button2").setMod("focused","yes")},_onLabelClick:function(e){if(this._shouldChange(e)){this._toggle();this.findBlockOn(this.elem("button"),"button2").setMod("focused","yes")}},_onButtonClick:function(){this._toggle()},_onButtonFocus:function(){this.setMod(this.elem("button"),"focused","yes");this.setMod("focused","yes")},_onButtonBlur:function(){this.delMod(this.elem("button"),"focused");this.delMod("focused")},_shouldChange:function(label){var isLeftLabel=this.getMod(label.data.domElem,"side")==="left";if(this._labelsLength===2){var isOnRight=!isLeftLabel&&this.elem("input").prop("checked"),isOnLeft=isLeftLabel&&!this.elem("input").prop("checked");if(isOnLeft||isOnRight){return false}}return true}},{live:function(){this.liveInitOnBlockInsideEvent("focus","button2",function(){this.hasMod("disabled")||this._onButtonFocus()}).liveInitOnBlockInsideEvent("blur","button2",function(){this.hasMod("disabled")||this._onButtonBlur()}).liveInitOnBlockInsideEvent("click","button2",function(e){this.hasMod("disabled")||this._onButtonClick()}).liveBindTo("pointerpress",function(e){this.hasMod("disabled")||this._onPointerpress(e)}).liveBindTo("sticker","pointerclick",function(e){this.hasMod("disabled")||this._onStickerClick()}).liveBindTo("label","pointerclick",function(e){this.hasMod("disabled")||this._onLabelClick(e)}).liveBindTo("button","keydown",function(e){if(e.shiftKey||e.ctrlKey||e.altKey||e.metaKey){return}if(BEM.blocks.keycodes.is(e.keyCode,"SPACE","LEFT","UP","RIGHT","DOWN")){e.preventDefault()}}).liveBindTo("button","keyup",function(e){var keyCodes=BEM.blocks.keycodes,keycode=e.keyCode;if(e.shiftKey||e.ctrlKey||e.altKey||e.metaKey){return}if(keyCodes.is(keycode,"LEFT","UP")){this.delMod("checked")}else if(keyCodes.is(keycode,"RIGHT","DOWN")){this.setMod("checked","yes")}});return this.__base()}});window.BEM.DOM.decl("tumbler",{_onPointerenter:function(e){this.hasMod(this.elem("button"),"hovered")||this.setMod("hovered","yes")},_onPointerleave:function(e){this.delMod("hovered")},_onButtonPointerenter:function(e){this.hasMod("view","classic")&&this.delMod("hovered").setMod(this.elem("button"),"hovered","yes")},_onButtonPointerleave:function(e){this.hasMod("view","classic")&&this.delMod(this.elem("button"),"hovered").setMod("hovered","yes")}},{live:function(){this.liveBindTo("box","pointerover pointerout",function(e){if(this.hasMod("disabled")||this.elem("box")[0].contains(e.relatedTarget)){return}e.type==="pointerover"?this._onPointerenter(e):this._onPointerleave(e)}).liveBindTo("button","pointerover pointerout",function(e){if(this.hasMod("disabled")||this.elem("button")[0].contains(e.relatedTarget)){return}e.type==="pointerover"?this._onButtonPointerenter(e):this._onButtonPointerleave(e)});return this.__base()}});window.BEM.DOM.decl("i-global",{onSetMod:{js:{inited:function(){this.del(this.__self._params=$.extend({},this.params),"uniqId","name");var params=this.__self._params;params["passport-msg"]||(params["passport-msg"]=params.id);if(params["show-counters"]===undefined){params["show-counters"]=Math.round(Math.random()*100)<=params["show-counters-percent"]}params.locale=params.lang;window.BEMHTML&&BEMHTML.apply({block:"i-global",params:params})}}},getDefaultParams:function(){return{id:"",login:this.__self.getCookie("yandex_login")?$.cookie("yandex_login")||"":"",yandexuid:$.cookie("yandexuid"),lang:"ru",tld:"ru",retpath:encodeURI($.decodeURI(location.href)),"passport-host":"https://passport.yandex.ru","pass-host":"https://pass.yandex.ru","social-host":"https://social.yandex.ru","lego-path":"/lego","show-counters-percent":100}}},{param:function(name,value){if(typeof value!=="undefined"){this._params&&(this._params[name]=value)}else{return(this._params||{})[name]}},getCookie:function(n){var c=document.cookie;if(c.length<1){return false}var b=c.indexOf(n+"=");if(b===-1){return false}b+=n.length+1;var e=c.indexOf(";",b);return decodeURIComponent(e===-1?c.substring(b):c.substring(b,e))}});$(function(){setTimeout(function(){window.BEM.afterCurrentEvent(function(){window.BEM.DOM.init()})},500)});(function(win,ua){var browser={};if(/msie|trident/i.test(ua)){browser.ie=parseInt(ua.split(/msie|rv:/i)[1],10)}else if(ua.indexOf("Opera")!==-1){browser.opera=parseInt(ua.split(/Version\//i)[1],10)}else if(typeof InstallTrigger!=="undefined"&&ua.indexOf("Firefox")!==-1){browser.firefox=parseInt(ua.split(/Firefox\//)[1],10)}var platform={},device={},match;if(match=ua.match(/Windows\sPhone[^\d]*\s([\d.]+)/)){platform.wp=match[1]}else if(match=ua.match(/Android\s+([\d.]+)/)){platform.android=match[1]}else if(ua.match(/\sHTC[\s_].*AppleWebKit/)){platform.android="2.3"}else if(match=ua.match(/iPhone\sOS\s([\d_]+)/)){platform.ios=match[1].replace(/_/g,".");device.iphone=true}else if(match=ua.match(/iPad.*OS\s([\d_]+)/)){platform.ios=match[1].replace(/_/g,".");device.ipad=true}else if(match=ua.match(/Bada\/([\d.]+)/)){platform.bada=match[1]}else if(match=ua.match(/MSIE\s9/)){platform.wp="7.5"}else{platform.other=true}BEM.DOM.decl("i-ua",{onSetMod:{js:{inited:function(){var self=this.__self,platformName="other";["ios","android","bada","wp","opera"].some(function(pl){return self[pl]&&(platformName=pl)});this.setMod("platform",platformName)}}},setVersion:function(){var version=this.parseVersion();if(version){this.setMod(version.platform,version.major);this.setMod(version.platform+"-subversion",version.subversion)}},parseVersion:function(){if(!(this.__self.ios||this.__self.android)){return}var version=this.__self.ios||this.__self.android,splittedVersion=version.split("."),major=splittedVersion.shift(),subversion=splittedVersion.join("-"),platform=this.getMod("platform");return{platform:platform,major:major,subversion:subversion}}},{ios:platform.ios,iphone:device.iphone,ipad:device.ipad,android:platform.android,bada:platform.bada,wp:platform.wp,other:platform.other,ua:ua,ie:browser.ie,opera:browser.opera,firefox:browser.firefox})})(window,navigator.userAgent);window.BEM.DOM.decl("control",{onSetMod:{focused:{yes:function(){if(this.hasMod("disabled")){return false}if(!this._focused){this._focus();this.trigger("focus")}},"":function(){if(this._focused){this._blur();this.trigger("blur")}}},disabled:{"*":function(modName,disabled){var control=this._getControl();control.prop("disabled",Boolean(disabled)).attr("aria-disabled",Boolean(disabled));control.attr("tabindex",disabled?null:this.params._tabindex)},yes:function(){this.delMod("focused")}}},_focus:function(){this._getControl().focus()},_blur:function(){this._getControl().blur()},_getControl:function(){var control=this.elem("control");return control.length>0?control:this.domElem},_onFocusin:function(){this._focused=true;this.trigger("focus").setMod("focused","yes").bindTo("focusout",this._onFocusout)},_onFocusout:function(){this._focused=false;this.trigger("blur").delMod("focused").unbindFrom("focusout")},getDefaultParams:function(){return{_tabindex:this._getControl().attr("tabindex")}}},{live:function(){this.liveBindTo("focusin",function(e){this._onFocusin(e)});parseInt(BEM.blocks["i-ua"].ios,10)>=8&&this.liveBindTo("control","focusin",function(e){e.preventDefault()})}});window.BEM.DOM.decl({block:"button2",baseBlock:"control"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments)}},pressed:{yes:function(){if(this.hasMod("disabled")){return false}this.trigger("press")},"":function(){this.trigger("release")}},checked:{yes:function(){this.trigger("check").domElem.attr("aria-pressed","true")},"":function(){this.trigger("uncheck").domElem.attr("aria-pressed","false")}},disabled:{yes:function(){this.__base.apply(this,arguments);this.delMod("pressed")}},focused:{"":function(){this.__base.apply(this,arguments);this.delMod("pressed")}},progress:{yes:function(){this.setMod("disabled","yes")},"":function(){this.delMod("disabled")}}},getText:function(){return this.elem("text").text()},setText:function(text){this.elem("text").text(text);return this},_onClick:function(e){if(!this._preventClick||e.detail>0){this.trigger("click",this._buildClickEventData(e))}this._preventClick=false},_processClick:function(e){this.trigger("click",this._buildClickEventData(e))},_onPointerpress:function(e){this.setMod("pressed","yes").bindToDoc("pointerrelease",this._onPointerrelease)},_onPointerrelease:function(){this.delMod("pressed").unbindFromDoc("pointerrelease")},_onKeydown:function(e){var keycode=e.keyCode,keycodes=BEM.blocks.keycodes;if(keycodes.is(keycode,this.params.pressKeys)){this.setMod("pressed","yes");if(keycodes.is(keycode,this.params.prvntKeys)){e.preventDefault()}}},_onKeyup:function(e){var keycode=e.keyCode,keycodes=BEM.blocks.keycodes;if(keycodes.is(keycode,this.params.prvntKeys)){e.preventDefault()}if(keycodes.is(keycode,this.params.pressKeys)){this.delMod("pressed");if(keycodes.is(keycode,this.params.clickKeys)){this._preventClick=true;this._processClick(e)}}},_buildClickEventData:function(e){return{domEvent:e,isModKey:e.ctrlKey||e.altKey||e.metaKey||e.shiftKey}},getDefaultParams:function(){return $.extend(this.__base(),{pressKeys:["SPACE","ENTER"],prvntKeys:[],clickKeys:[]})}},{live:function(){this.liveBindTo("pointerpress",function(e){this.hasMod("disabled")||this._onPointerpress(e)}).liveBindTo("pointerclick",function(e){this.hasMod("disabled")||this._onClick(e)}).liveBindTo("keydown",function(e){this._onKeydown(e)}).liveBindTo("keyup",function(e){this._onKeyup(e)});return this.__base()}});window.BEM.DOM.decl("button2",{onSetMod:{hovered:{yes:function(){return!this.hasMod("disabled")}},disabled:{yes:function(){this.__base.apply(this,arguments);this.delMod("hovered")}}},_onPointerenter:function(){this.setMod("hovered","yes")},_onPointerleave:function(){this.delMod("hovered")},_onClick:function(){this.__base.apply(this,arguments);if(!this._isDestructing){this.setMod("focused","yes")}}},{live:function(){this.liveBindTo("pointerover pointerout",function(e){if(this.hasMod("disabled")||this.domElem[0].contains(e.relatedTarget)){return}e.type==="pointerover"?this._onPointerenter(e):this._onPointerleave(e)}).liveBindTo("mousedown",function(e){e.preventDefault()});return this.__base()}});window.BEM.DOM.decl({block:"checkbox",baseBlock:"control"},{onSetMod:{js:{inited:function(){var control=this.elem("control");this.toggleMod("checked","yes",control.prop("checked"));this.toggleMod("focused","yes",control.isFocused())}},hovered:{yes:function(){return!this.hasMod("disabled")}},pressed:{yes:function(){return!this.hasMod("disabled")}},checked:function(modName,checked){this.elem("control").prop("checked",checked);this.trigger("change",{checked:Boolean(checked)})},disabled:{yes:function(){this.__base.apply(this,arguments);this.delMod("hovered").delMod("pressed")}}},isDisabled:function(){return this.hasMod("disabled")},isChecked:function(){return Boolean(this.elem("control").prop("checked"))},toggle:function(){this.toggleMod("checked","yes")},val:function(val){var checkbox=this.elem("control");if(typeof val==="undefined"){return checkbox.val()}checkbox.val(val);return this},name:function(val){var control=this.elem("control");if(!arguments.length){return control.attr("name")}control.attr("name",val);return this},_onChange:function(e){this.toggleMod("checked","yes",e.target.checked)},_onPointerenter:function(e){this.setMod("hovered","yes")},_onPointerleave:function(e){this.delMod("hovered")},_onPointerpress:function(e){this.setMod("pressed","yes").bindToDoc("pointerrelease",this._onPointerrelease)},_onPointerrelease:function(e){this.delMod("pressed").unbindFromDoc("pointerrelease")},_onClick:function(e){var label=this.elem("label");var target=e.target;if(this.domElem[0]===target){this._onChange(e)}target!==label[0]&&this.trigger("click",{domEvent:e});this.setMod("focused","yes")},_onKeydown:function(e){if(e.keyCode===BEM.blocks.keycodes.SPACE){this.setMod("pressed","yes")}},_onKeyup:function(e){if(e.keyCode===BEM.blocks.keycodes.SPACE){this.delMod("pressed")}}},{live:function(){this.liveBindTo("pointerover pointerout",function(e){if(this.isDisabled()||this.domElem[0].contains(e.relatedTarget)){return}e.type==="pointerover"?this._onPointerenter(e):this._onPointerleave(e)}).liveBindTo("pointerpress",function(e){this.hasMod("disabled")||this._onPointerpress(e)}).liveBindTo("pointerclick",function(e){this.hasMod("disabled")||this._onClick(e)}).liveBindTo("control","keydown",function(e){this.hasMod("disabled")||this._onKeydown(e)}).liveBindTo("control","keyup",function(e){this.hasMod("disabled")||this._onKeyup(e)}).liveBindTo("control","change",function(e){this._onChange(e)});return this.__base()}});window.BEM.DOM.decl({block:"menu",baseBlock:"control"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments);this.elem("item").attr("id",function(i,id){return id||$.identify()});this._val=this.getVal()}},disabled:function(name,val){this.__base.apply(this,arguments);this.setMod(this.elem("item"),name,val)}},onElemSetMod:{item:{hovered:{yes:function(item){if(this.hasMod(item,"disabled")){return false}this.delMod(this.elem("item","hovered","yes"),"hovered");this.domElem.attr("aria-activedescendant",item.attr("id"));this.trigger("item-hover",{item:item})},"":function(){this.domElem.removeAttr("aria-activedescendant");this.trigger("item-hover",{})}},checked:function(item,name,val){this.domElem.attr("aria-selected",Boolean(val))},disabled:{yes:function(){this.delMod("hovered");this.domElem.attr("aria-disabled",true)},"":function(){this.domElem.attr("aria-disabled",false)}}}},_onChange:function(){var prevVal=this._val,currVal=this.getVal();if(prevVal!==currVal){this._val=currVal;this.trigger("change",{prevVal:prevVal,currVal:currVal})}return this},getItems:function(modName,modVal){return this.elem("item",modName,modVal).get().map(function(item){return $(item)})},setContent:function(content){BEM.DOM.update(this.domElem,content);this.reset();return this},getVal:function(){},reset:function(){this.dropElemCache()},_onItemEnter:function(item,e){this.setMod(item,"hovered","yes")},_onItemLeave:function(item,e){this.delMod(item,"hovered")},_onItemFocusin:function(item,e){this.setMod(item,"hovered","yes")},_onFocusout:function(e){this.__base.apply(this,arguments);this.delMod(this.elem("item","hovered","yes"),"hovered")},_onItemClick:function(item,e,data){this.trigger("click",{item:item,source:data.source})}},{live:function(){this.liveBindTo("item","pointerover pointerout",function(e){var item=e.data.domElem;if(item[0].contains(e.relatedTarget)){return}e.type==="pointerover"?this._onItemEnter(item,e):this._onItemLeave(item,e)}).liveBindTo("item","pointerclick",function(e){var item=e.data.domElem;this._onItemClick(item,e,{source:"pointer"})}).liveBindTo("item","focusin",function(e){var item=e.data.domElem;this._onItemFocusin(item,e)}).liveBindTo("focusout",function(e){this._onFocusout(e)});return this.__base()}});window.BEM.DOM.decl("menu",{onSetMod:{focused:{yes:function(){this.__base.apply(this,arguments);if(this.hasMod("type","navigation")){return false}if(!this.elem("item","hovered","yes").length){this.setMod(this.elem("item").eq(0),"hovered","yes");this._scrollToItem(this.elem("item").eq(0))}this.bindToDoc("keydown",this._onKeydown).bindToDoc("keyup",this._onKeyup).bindToDoc("keypress",this._onKeypress)},"":function(){this.__base.apply(this,arguments);this.unbindFromDoc("keydown keyup keypress").delMod(this.elem("item","hovered","yes"),"hovered")}}},hoverNext:function(reverse){var items=reverse?this.getItems().reverse():this.getItems(),nextItem;for(var i=0,takeNext=false,item;item=items[i];i++){if(this.hasMod(item,"disabled")){continue}if(this.hasMod(item,"hovered")){takeNext=true;continue}if(takeNext){nextItem=item;break}if(!nextItem){nextItem=item}}if(nextItem){this.setMod(nextItem,"hovered","yes");this._scrollToItem(nextItem)}},hoverText:function(str,pos){var items=this.getItems(),len=items.length,term=this._normalizeText(str),i=pos||0,item;while(i<len){item=items[i];if(!this.hasMod(item,"disabled")&&this._normalizeText(item.text()).indexOf(term)===0){this.setMod(item,"hovered","yes");this._scrollToItem(item);return}i++;if(i===items.length){i=0;len=pos}}},_normalizeText:function(str){return str.toLowerCase().replace(/ё/,"е")},reset:function(){this.__base.apply(this,arguments);this._dropSearchCache()},_dropSearchCache:function(){this._lastTime=this._lastChar=this._searchTerm=undefined},_scrollToItem:function(item){var domElemOffsetTop=this.domElem.offset().top,itemOffsetTop=item.offset().top,relativeScroll=0;if(itemOffsetTop<domElemOffsetTop){relativeScroll=itemOffsetTop-domElemOffsetTop}else{relativeScroll=itemOffsetTop+item.outerHeight()-domElemOffsetTop-this.domElem.outerHeight();if(relativeScroll<0){relativeScroll=0}}this.domElem.scrollTop(this.domElem.scrollTop()+relativeScroll)},_onKeydown:function(e,skipPreventSpace){var keyCodes=BEM.blocks.keycodes,keycode=e.keyCode;if(e.shiftKey||e.ctrlKey||e.altKey||e.metaKey){return}if(keyCodes.is(keycode,"UP","DOWN")||!skipPreventSpace&&keycode===keyCodes.SPACE){e.preventDefault()}if(keyCodes.is(keycode,"UP","DOWN")){this.hoverNext(keyCodes.is(keycode,"UP"));this._dropSearchCache()}},_onKeyup:function(e){var keyCodes=BEM.blocks.keycodes,keycode=e.keyCode;if(e.shiftKey||e.ctrlKey||e.altKey||e.metaKey){return}if(keyCodes.is(keycode,"ENTER","SPACE")){this._onItemClick(this.elem("item","hovered","yes"),e,{source:"keyboard"})}},_onKeypress:function(e){var currTime=Number(new Date),charCode=e.charCode,chr=String.fromCharCode(charCode).toLowerCase(),isSameChar=chr===this._lastChar&&this._searchTerm.length===1,items=this.getItems(),hoveredItem,index;if(charCode<=BEM.blocks.keycodes.SPACE||e.ctrlKey||e.altKey||e.metaKey){this._lastTime=currTime;return}if(currTime-this._lastTime>this.SEARCH_TIMEOUT||isSameChar){this._searchTerm=chr}else{this._searchTerm=(this._searchTerm||"")+chr}this._lastChar=chr;this._lastTime=currTime;hoveredItem=this.elem("item","hovered","yes");index=$($.map(items,function(item){return item.get()})).index(hoveredItem);index=index>=0?index:0;if(isSameChar&&this._normalizeText(hoveredItem.text()).indexOf(this._searchTerm)===0){index=index>=items.length-1?0:index+1}this.hoverText(this._searchTerm,index)},SEARCH_TIMEOUT:1500});window.BEM.DOM.decl({block:"menu",modName:"type",modVal:"radio"},{getVal:function(){var item=this.getItems("checked","yes")[0];return item&&this.elemParams(item).val},setVal:function(val){this.getItems().forEach(function(item){if(this.elemParams(item).val===val){this.setMod(item,"checked","yes")}else{this.delMod(item,"checked")}},this);this._onChange();return this},_onItemClick:function(item,e,data){this.__base.apply(this,arguments);if(this.hasMod(item,"checked","yes")){return}this.delMod(this.elem("item","checked","yes"),"checked");this.setMod(item,"checked","yes");this._onChange()}});window.BEM.DOM.decl("radiobox",{onSetMod:{js:{inited:function(){this._val=this.findElem(this.elem("radio","checked","yes"),"control").val();this.elem("control").each(function(i,elem){var control=$(elem),radio=this.__self._getRadioByElem(control);if(control.isFocused()){this.setMod(radio,"focused","yes")}if(control.prop("checked")){this.setMod(radio,"checked","yes")}}.bind(this))}},disabled:{yes:function(){this.setMod(this.elem("radio"),"disabled","yes")},"":function(){this.delMod(this.elem("radio"),"disabled")}}},onElemSetMod:{radio:{focused:{yes:function(elem){this.delMod(this.elem("radio","focused","yes"),"focused");var control=this.findElem(elem,"control");control.isFocused()||control.focus();this.afterCurrentEvent(function(){this.domElem&&this.trigger("focus",{current:elem})})},"":function(elem){this.afterCurrentEvent(function(){this.domElem&&this.trigger("blur",{prev:elem})})}},checked:{yes:function(elem){var prev=this.elem("radio","checked","yes"),control=this.findElem(elem,"control"),prevVal=this._val;this._willSwitch=true;this.delMod(prev,"checked");this._willSwitch=false;control.prop("checked",true);this._val=control.val();this.trigger("change",{current:elem,currentVal:this._val,prev:prev,prevVal:prevVal})},"":function(elem){var control=this.findElem(elem,"control"),prevVal=this._val;control.prop("checked",false);this._val=undefined;if(!this._willSwitch){this.trigger("change",{current:$(),currentVal:undefined,prev:elem,prevVal:prevVal})}}},hovered:function(elem){return!this.isDisabled(elem)},pressed:function(elem){return!this.isDisabled(elem)},disabled:function(elem,modName,disabled){elem.find(this.buildSelector("control")).prop("disabled",disabled);if(disabled){this.delMod(elem,"hovered").delMod(elem,"pressed")}}}},isDisabled:function(radio){return this.hasMod(radio,"disabled","yes")},val:function(val){if(typeof val==="undefined"){return this._val}var self=this;this.elem("control").each(function(i,control){if(control.value===val){self.setMod(self.__self._getRadioByElem($(control)),"checked","yes");return false}});return self},name:function(val){var control=this.elem("control");if(!arguments.length){return control.attr("name")}control.attr("name",val);return this},getCurrent:function(){return this.findElem("radio","checked","yes")},uncheckAll:function(){this.delMod(this.elem("radio","checked","yes"),"checked");return this},_onRadioEnter:function(e){this.setMod(e.data.domElem,"hovered","yes")},_onRadioLeave:function(e){this.delMod(e.data.domElem,"hovered")},_onRadioClick:function(elem,e){this.isDisabled(elem)||this.setMod(elem,"focused","yes")},_onChange:function(e){this.setMod(this.__self._getRadioByElem(e.data.domElem),"checked","yes")},_onPointerpress:function(e){var elem=e.data.domElem;this.setMod(elem,"pressed","yes").bindToDoc("pointerrelease",function(){this.delMod(elem,"pressed").unbindFromDoc("pointerrelease")})}},{live:function(){this.liveBindTo("radio","pointerclick",function(e){this._onRadioClick(e.data.domElem,e)}).liveBindTo("control","change",function(e){this._onChange(e)}).liveBindTo("radio","pointerover pointerout",function(e){if(e.data.domElem[0].contains(e.relatedTarget)){return}if(e.type==="pointerover"){this._onRadioEnter(e)}else{this._onRadioLeave(e)}}).liveBindTo("control","focusin focusout",function(e){var radio=this.__self._getRadioByElem(e.data.domElem);this.setMod(radio,"focused",e.type==="focusin"?"yes":"");parseInt(BEM.blocks["i-ua"].ios,10)>=8&&e.preventDefault()}).liveBindTo("radio","pointerpress",function(e){if(!this.hasMod(e.data.domElem,"disabled")){this._onPointerpress(e)}})},_getRadioByElem:function(elem){return elem.closest(this.buildSelector("radio"))}});window.BEM.DOM.decl({block:"select2",modName:"popup",modVal:"yes"},{onSetMod:{focused:{yes:function(){this.button.setMod("focused","yes")},"":function(){this.delMod("opened");this.button.delMod("focused")}},opened:{"*":function(modName,modVal){if(this.hasMod("disabled")){return false}var inOpening=Boolean(modVal);this.button.domElem.attr("aria-expanded",inOpening);this.arrow.toggleMod("direction","top","bottom",inOpening);this.popup.toggleMod("visible","yes",inOpening);if(inOpening){this.popup.redraw()}},yes:function(){this._setMinWidth();this._setMaxHeight()}},disabled:{yes:function(){this.popup.delMod("visible")}}},getDefaultParams:function(){return{optionsMaxHeight:Number.POSITIVE_INFINITY}},initSelect:function(){this.menu=this.findBlockOn("menu","menu");this.__base.apply(this,arguments);this.popup=this.findBlockOn("popup","popup2");this.arrow=this.findBlockOn("arrow","icon");this.initialVal=this.getVal();this.popup.setAnchor(this.button);this.popup.on("beforeClose",this._onPopupHide,this);this.button.on({click:this._onButtonClick,focus:this._onButtonFocus},this);this.bindTo("button","blur",this._onButtonBlur);this.menu.on({change:this._onMenuChange,click:this._onMenuItemClick,"item-hover":this._onMenuItemHover},this);this._preventBlur=null;this.bindTo("menu","pointerdown",this._onMenuPointerdown);document.documentMode&&this.bindTo("menu","focusin focusout",this._preventItemFocus);this._setMaxHeight()},getVal:function(){return this.menu.getVal()},setVal:function(val){this.menu.setVal(val);return this},reset:function(){this.menu.setVal(this.initialVal)},setContent:function(content){this.menu.setContent(content);this._setMinWidth();this._setMaxHeight();this.popup.redraw();return this},destruct:function(){document.documentMode&&this.unbindFrom("menu","focusin focusout",this._preventItemFocus);this.unbindFrom("menu","pointerup",this._preventButtonBlur);this.unbindFrom("menu","pointerdown",this._onMenuPointerdown);this.unbindFrom("button","blur",this._onButtonBlur);return this.__base.apply(this,arguments)},_setMinWidth:function(){this.popup.domElem.css("min-width",this.button.domElem.outerWidth())},_setMaxHeight:function(){var drawingParams=this.popup.calcPossibleDrawingParams(),menuDomElem=this.menu.domElem,menuWidth=menuDomElem.outerWidth(),bestHeight=0;drawingParams.forEach(function(params){params.width>=menuWidth&&params.height>bestHeight&&(bestHeight=params.height)});if(bestHeight>0){menuDomElem.css("max-height",Math.min(this.params.optionsMaxHeight,bestHeight))}},_onMenuChange:function(e,data){this._changeIcon(e,data);if(this.control){this.control.val(data.currVal)}this.trigger("change",data)},_changeIcon:function(e,data){var menu=this.menu,button=this.button,item=menu.getItems("checked","yes").filter(function(item){return menu.elemParams(item).val===data.currVal}).shift(),icon=item&&menu.findBlockInside(item,"icon"),iconLeft=button.findElem("icon","side","left"),mods,buttonIcon;if(icon){if(!iconLeft.length){button.domElem.prepend(this._buildLeftIcon());iconLeft=button.findElem("icon","side","left")}buttonIcon=button.findBlockInside(iconLeft,"icon");mods=icon.getMods();delete mods.js;Object.keys(mods).forEach(function(modName){buttonIcon.setMod(modName,mods[modName])})}else if(iconLeft.length){iconLeft.remove()}},_buildLeftIcon:function(){return'<i class="icon button2__icon button2__icon_side_left" aria-hidden="true"/>'},_onMenuItemClick:function(e,data){this.delMod("opened")},_onMenuItemHover:function(e,data){var domElem=this.button.domElem,item=data.item;if(item){domElem.attr("aria-activedescendant",item.attr("id"))}else{domElem.removeAttr("aria-activedescendant")}},_onMenuPointerdown:function(e){this._preventBlur=true},_onButtonClick:function(){this.toggleMod("opened","yes")},_onButtonKeydown:function(e){var keycodes=BEM.blocks.keycodes;if(!this.hasMod("opened")&&keycodes.is(e.keyCode,"UP","DOWN")){e.preventDefault();this.setMod("opened","yes")}},_onButtonFocus:function(){this.setMod("focused","yes")},_onButtonBlur:function(){if(this._preventBlur){this._preventBlur=null;this.bindTo("menu","pointerup",this._preventButtonBlur)}else{this.delMod("focused")}},_onPopupHide:function(){this.delMod("opened")},_preventButtonBlur:function(e){this.unbindFrom("menu","pointerup",this._preventButtonBlur);this.button.domElem.focus()},_preventItemFocus:function(e){e.preventDefault();e.stopPropagation()},_onControlChange:function(e){var val=this.control.val(),vals=[].concat(val),menu=this.menu,prevVal=this.getVal();menu.getItems().filter(function(item){menu.delMod(item,"checked");return vals.indexOf(menu.elemParams(item).val)>=0}).forEach(function(item){menu.setMod(item,"checked","yes")});this._onMenuChange(e,{prevVal:prevVal,currVal:val})}});window.BEM.DOM.decl({block:"select2",modName:"popup",modVal:"yes"},{onSetMod:{opened:{yes:function(modName,modVal){var ret=this.__base.apply(this,arguments);if(ret===false){return ret}var hovered=this.menu.getItems("hovered","yes"),checked;if(!hovered.length){checked=this.menu.getItems("checked","yes");if(checked.length){this.menu.hoverText(checked[0].text())}else{this.menu.hoverNext()}}return ret},"":function(){this._preventToToggleOpened=false;return this.__base.apply(this,arguments)}}},_onButtonKeydown:function(e){if(this.hasMod("opened","yes")){this.menu._onKeydown(e,true);this._keysToMenu=true;this._preventToToggleOpened=true}else{this._keysToMenu=false;this._preventToToggleOpened=false;this.__base.apply(this,arguments)}},_onButtonKeyup:function(e){if(this._keysToMenu){this.menu._onKeyup(e);this._keysToMenu=false;this._preventToToggleOpened=true}},_onButtonClick:function(){if(this._preventToToggleOpened){this._preventToToggleOpened=false}else{this.__base.apply(this,arguments)}},_onButtonKeypress:function(e){var keyCodes=BEM.blocks.keycodes;if(!keyCodes.is(e.keyCode,"UP","DOWN","ENTER","SPACE")&&!(e.keyCode===0&&e.charCode===keyCodes["SPACE"])){var hovered=this.menu.getItems("hovered","yes");hovered.forEach(function(item){this.menu.delMod(item,"hovered")},this);this.menu._onKeypress(e);if(this.hasMod("opened")){return}hovered=this.menu.getItems("hovered","yes");if(hovered.length){this.setVal(this.menu.elemParams(hovered[0]).val)}}else{this.menu._onKeypress(e)}}},{live:function(){this.liveBindTo("button","keyup",function(e){this._onButtonKeyup(e)});return this.__base()}});(function($){window.BEM.DOM.decl({block:"popup2",modName:"target",modVal:"anchor"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments);this._anchor=null;this._destructor=null;this._fixedAnchor=undefined}},visible:{yes:function(){console.assert(this._anchor,"popup2: Нужно установить anchor перед отображением попапа.");this.bindToDoc("documentchange",this._onWinScrollAndResize);this.__base.apply(this,arguments)},"":function(){this.__base.apply(this,arguments);this.unbindFromDoc("documentchange")}}},destruct:function(){this._unbindFromDestructor();this.__base.apply(this,arguments)},setAnchor:function(anchor){this._unbindFromDestructor()._unbindFromParentPopup();this._anchor=anchor instanceof BEM.DOM?anchor.domElem:anchor;this._destructor=beminize(this._anchor,"_"+this.__self.getName()+"-destructor");this._fixedAnchor=undefined;this._bindToDestructor();this._setVisible();if(this.hasMod("visible")){this._recaptureZIndex()._bindToParentPopup().redraw()}else{this._zIndexGroupLevel=null}return this},_calcTargetDimensions:function(){var anchor=this._anchor,anchorPos=this._getOffsetOf(anchor);return{left:anchorPos.left,top:anchorPos.top,width:anchor.outerWidth(),height:anchor.outerHeight()}},_getOffsetOf:function(elem){var offset=elem.offset();if("pageYOffset"in window){offset.top-=window.pageYOffset-(document.documentElement.scrollTop||document.body.scrollTop);offset.left-=window.pageXOffset-(document.documentElement.scrollLeft||document.body.scrollLeft)}return offset},_calcDrawingCss:function(drawingParams){var base=this.__base.apply(this,arguments);if(typeof this._fixedAnchor==="undefined"){this._fixedAnchor=this._getFirstFixedParent(this._anchor)}if(this._fixedAnchor){var fixedLeftOffset=0;var fixedTopOffset=0;var fixedScope=this._getFirstFixedParent(this._scope);if(fixedScope){var offset=fixedScope.offset();fixedLeftOffset=offset.left;fixedTopOffset=offset.top}base.left-=$(window).scrollLeft()-fixedLeftOffset;base.top-=$(window).scrollTop()-fixedTopOffset}return $.extend(base,{position:this._fixedAnchor?"fixed":""})},_getFirstFixedParent:function(elem){elem=elem[0];while(elem){if(elem.nodeType===1&&$(elem).css("position")==="fixed"){return $(elem)}elem=elem.parentNode}return null},_calcZIndexGroupLevel:function(){var res=this.__base.apply(this,arguments);return this._destructor.findBlocksOutside("z-index-group").reduce(function(res,zIndexGroup){return res+Number(zIndexGroup.getMod("level"))},res)},_bindToDestructor:function(){this._destructor.on("destruct",this._onPopupAnchorDestruct,this);return this},_unbindFromDestructor:function(){this._destructor&&this._destructor.un("destruct",this._onPopupAnchorDestruct,this);return this},_onPopupAnchorDestruct:function(){this.domElem&&BEM.DOM.destruct(this.domElem)},_getParentPopup:function(){if(this._parentPopup===undefined){var popup=this._anchor.closest(".popup2");this._parentPopup=this.findBlockOn(popup,this.__self.getName())}return this._parentPopup}});var BEMDOM=window.BEM.DOM;BEMDOM.decl("_popup2-destructor",{destruct:function(){this.trigger("destruct");this.__base.apply(this,arguments)}});function beminize(elem,block){return elem.addClass("i-bem "+block).bem(block)}})(jQuery);window.BEM.DOM.decl({block:"popup2",modName:"autoclosable",modVal:"yes"},{onSetMod:{visible:{yes:function(){this.__self._visiblePopupsStack.unshift(this);this.afterCurrentEvent(function(){this.domElem&&this.hasMod("visible")&&this.bindToDoc("pointerclick",this._onDocClick)});this.__base.apply(this,arguments)},"":function(){var visiblePopupsStack=this.__self._visiblePopupsStack;visiblePopupsStack.splice(visiblePopupsStack.indexOf(this),1);this.unbindFromDoc("pointerclick").__base.apply(this,arguments)}}},_onDocClick:function(e){if(this.hasMod("target","anchor")&&(this._anchor[0]===e.target||this._anchor.find(e.target).length>0)){return}if(this._preventHideByClick){this._preventHideByClick=null}else{this.delMod("visible")}}},{live:function(){BEM.DOM.doc.on("keydown",this._onDocKeyPress.bind(this));return this.__base()},_visiblePopupsStack:[],_onDocKeyPress:function(e){if(BEM.blocks.keycodes.is(e.keyCode,"ESC")&&this._visiblePopupsStack.length){this._visiblePopupsStack[0].delMod("visible")}}});window.BEM.DOM.decl({block:"select2",modName:"view",modVal:"default"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments);this.popup&&this.popup.setAnchor(this.domElem);this.popup&&this.popup.setScope(this.findBlockOutside("theme").domElem.eq(0))}}},_changeIcon:function(e,data){if(!this.menu){this.__base.apply(this,arguments);return}var menu=this.menu,button=this.button,item=menu.getItems("checked","yes").filter(function(item){return menu.elemParams(item).val===data.currVal}).shift(),icon=item&&menu.findElem(item,"icon"),iconLeft=button.findElem("icon","side","left");iconLeft.length&&iconLeft.remove();icon&&button.domElem.prepend(this._buildLeftIcon(icon))},_buildLeftIcon:function(icon){if(!icon){return this.__base.apply(this,arguments)}return icon.clone().addClass("button2__icon_side_left button2__icon")}});window.BEM.DOM.decl({block:"select2",modName:"text",modVal:"vary"},{_onMenuChange:function(e,data){this.__base.apply(this,arguments);this.button.setText(this.getText());this._setMinWidth()},_onControlChange:function(){this.__base.apply(this,arguments);this.button.setText(this.getText())},getText:function(){var checkedTexts=this.params.checkedTexts;if(this.menu){return this.getTextFromMenu(checkedTexts)}if(this.control){var selected=this.getOptions().filter(function(option){return option.selected});return selected.map(function(option){var text=option.text,val=option.value;return checkedTexts[val]||text}).join(", ")||this.params.text}},getTextFromMenu:function(checkedTexts){var menu=this.menu;var result=menu.getItems("checked","yes").map(function(item){var elemParams=menu.elemParams(item),text=elemParams.text||item.text(),val=elemParams.val||item.val();return checkedTexts[val]||text}).join(", ")||this.params.text;return result}});window.BEM.DOM.decl({block:"textinput",baseBlock:"control"},{onSetMod:{js:{inited:function(){this._control=this.elem("control");this._text=this._control.val()}}},val:function(text){var isVal=typeof text!=="undefined",control=this._control;if(isVal){text=text===null?"":text.toString()}else{text=control.val()}if(text!==this._text){control.val(text);this._textChange()}return isVal?this:text},getText:function(){console.error("Методы setText и getText блока textinput объявлены deprecated."+" Рекомендуется использовать метод val(value?: string)");return this._control.val()},setText:function(text){console.error("Методы setText и getText блока textinput объявлены deprecated."+" Рекомендуется использовать метод val(value?: string)");if(text===this.getText()){return this}this._control.val(text);this._textChange();return this},_textChange:function(byCode){var text=this._control.val(),oldText=this._text,wasChanged=Boolean(text!==oldText);if(!wasChanged){return false}this._text=text;var eventData={text:text,oldText:oldText,byCode:byCode};this.trigger("change",eventData)}},{live:function(){this.liveBindTo("control","input",function(){this._textChange()});return this.__base()}});window.BEM.DOM.decl({block:"textinput"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments);if(this.params.autofocus){this.setMod("focused","yes");this._getControl().focus()}}}},_onPointerenter:function(){this.setMod("hovered","yes")},_onPointerleave:function(){this.delMod("hovered")}},{live:function(){this.liveBindTo("pointerover pointerout",function(e){if(this.hasMod("disabled")||this.domElem[0].contains(e.relatedTarget)){return}e.type==="pointerover"?this._onPointerenter(e):this._onPointerleave(e)});return this.__base()}});window.BEM.DOM.decl("tabs",{getCount:function(){return this.elem("tab").length},activate:function(index){return this},deactivate:function(){return this},getActive:function(){return-1},disable:function(index){return this},enable:function(index){return this},isDisabled:function(index){},_onControlChange:function(e,data){}},{getSupportedControls:function(){return["tabs-menu","radio-button"]},live:function(){this.getSupportedControls().forEach(function(block){BEM.blocks[block]&&this.liveInitOnBlockInsideEvent("change",block,function(e,data){this._onControlChange(e,data)})},this)}});window.BEM.DOM.decl({block:"tabs",modName:"control",modVal:"menu"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments);this._tabsMenu=this.findBlockOn("control","tabs-menu")}}},activate:function(index){this._tabsMenu.setMod(this._tabsMenu.getTab(index),"active","yes");return this},deactivate:function(){this._tabsMenu.delMod(this._tabsMenu.getActive(),"active","yes");return this},disable:function(index){this._tabsMenu.setMod(this._tabsMenu.getTab(index),"disabled","yes");return this},enable:function(index){this._tabsMenu.delMod(this._tabsMenu.getTab(index),"disabled");return this},getActive:function(){return this._tabsMenu.indexOfTab(this._tabsMenu.getActive())},isDisabled:function(index){return this._tabsMenu.hasMod(this._tabsMenu.getTab(index),"disabled","yes")},_onControlChange:function(e,data){data.current.attr("aria-selected",true);data.prev.attr("aria-selected",false);this.trigger("change",{currentIndex:data.currentIndex,prevIndex:data.prevIndex})}});window.BEM.DOM.decl({block:"tabs",modName:"control",modVal:"buttons"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments);this._radioButton=this.findBlockOn("control","radio-button")}}},activate:function(index){this._radioButton.setMod(this._getRadio(index),"checked","yes");return this},deactivate:function(){this._radioButton.uncheckAll();return this},disable:function(index){this._radioButton.setMod(this._getRadio(index),"disabled","yes");return this},enable:function(index){this._radioButton.delMod(this._getRadio(index),"disabled");return this},isDisabled:function(index){return this._radioButton.isDisabled(this._getRadio(index))},getActive:function(){return this._indexOfButton(this._radioButton.getCurrent())},_getRadio:function(index){return this._radioButton.elem("radio").eq(index)},_indexOfButton:function(elem){return $.inArray(elem.get(0),this._radioButton.elem("radio"))},_onControlChange:function(e,data){data.current.attr("aria-selected",true);data.prev.attr("aria-selected",false);this.trigger("change",{currentIndex:this._indexOfButton(data.current),prevIndex:this._indexOfButton(data.prev)})}});window.BEM.DOM.decl({block:"textarea",baseBlock:"control"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments);this._control=this.elem("control");this._text=this._control.val()}}},val:function(text){var isVal=typeof text!=="undefined",control=this._control;if(isVal){text=text===null?"":text.toString()}else{text=control.val()}if(text!==this._text){control.val(text);this._textChange()}return isVal?this:text},getText:function(){console.error("Методы setText и getText блока textinput объявлены deprecated."+" Рекомендуется использовать метод val(value?: string)");return this._control.val()},setText:function(text){console.error("Методы setText и getText блока textinput объявлены deprecated."+" Рекомендуется использовать метод val(value?: string)");this._control.val(text||"");this._textChange();return this},_textChange:function(){var text=this._control.val(),oldText=this._text,wasChanged=text!==oldText;if(!wasChanged){return false}this._text=text;var eventData={text:text,oldText:oldText};this.trigger("change",eventData)}},{live:function(){this.liveBindTo("control","input",function(){this._textChange()});return this.__base()}});window.BEM.DOM.decl("textarea",{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments);if(this.params.autofocus){this.setMod("focused","yes");this._getControl().focus()}}}},_onPointerenter:function(){this.setMod("hovered","yes")},_onPointerleave:function(){this.delMod("hovered")}},{live:function(){this.liveBindTo("pointerover pointerout",function(e){if(this.hasMod("disabled")||this.domElem[0].contains(e.relatedTarget)){return}e.type==="pointerover"?this._onPointerenter(e):this._onPointerleave(e)});return this.__base()}});window.BEM.DOM.decl({block:"textarea",modName:"has-clear",modVal:"yes"},{onSetMod:{js:{inited:function(){this.__base();this._clear=this.elem("clear");this.on("change",this._updateClearOnInputChange)}}},_updateClearOnInputChange:function(){this.toggleMod(this._clear,"visible","yes","",Boolean(this.val()))},_onClearPointerclick:function(){this.trigger("clear").val("").setMod("focused","yes").elem("control").focus()},_onClearPointerover:function(){this.setMod(this._clear,"hovered","yes").bindTo(this._clear,"pointerout",this._onClearPointerout)},_onClearPointerout:function(){this.delMod(this._clear,"hovered").unbindFrom(this._clear,"pointerout")},_preventLosingFocus:function(e){if(this.hasMod("focused")){e.preventDefault();e.stopPropagation()}}},{live:function(){this.liveBindTo("clear","pointerclick",function(e){this._onClearPointerclick(e)}).liveBindTo("clear","pointerover",function(e){this._onClearPointerover(e)}).liveBindTo("clear","mousedown touchend",function(e){this._preventLosingFocus(e)});return this.__base()}});window.BEM.DOM.decl({block:"textinput",modName:"has-clear",modVal:"yes"},{onSetMod:{js:{inited:function(){this.__base();this._clear=this.elem("clear");this.on("change",this._updateClearOnInputChange)}}},_updateClearOnInputChange:function(){this.toggleMod(this._clear,"visible","yes","",Boolean(this.val()))},_onClearPointerclick:function(){this.trigger("clear").val("").setMod("focused","yes").elem("control").focus()},_onClearPointerover:function(){this.setMod(this._clear,"hovered","yes").bindTo(this._clear,"pointerout",this._onClearPointerout)},_onClearPointerout:function(){this.delMod(this._clear,"hovered").unbindFrom(this._clear,"pointerout")},_preventLosingFocus:function(e){if(this.hasMod("focused")){e.preventDefault();e.stopPropagation()}}},{live:function(){this.liveBindTo("clear","pointerclick",function(e){this._onClearPointerclick(e)}).liveBindTo("clear","pointerover",function(e){this._onClearPointerover(e)}).liveBindTo("clear","mousedown touchend",function(e){this._preventLosingFocus(e)});return this.__base()}});window.BEM.DOM.decl({block:"popup2",modName:"theme",modVal:"normal"},{getDefaultParams:function(){return $.extend(this.__base(),{mainOffset:5,viewportOffset:5})}});window.BEM.DOM.decl({block:"link",baseBlock:"control"},{onSetMod:{hovered:{yes:function(){return!this.hasMod("disabled")}},pressed:{yes:function(){return!this.hasMod("disabled")}},disabled:{"":function(){this.__base.apply(this,arguments);this.domElem.attr("tabindex",this.params._tabindex)},yes:function(){this.__base.apply(this,arguments);this.domElem.attr("tabindex",-1);this.delMod("pressed")}}},_onPointerpress:function(e){this.setMod("pressed","yes").bindToDoc("pointerrelease",this._onPointerrelease)},_onPointerrelease:function(e){this.delMod("pressed").unbindFromDoc("pointerrelease")}},{live:function(){this.liveBindTo("pointerpress",function(e){this.hasMod("disabled")||this._onPointerpress(e)});return this.__base()}});window.BEM.DOM.decl("link",{onSetMod:{hovered:{yes:function(){return!this.hasMod("disabled")}},disabled:{yes:function(){this.__base.apply(this,arguments);this.delMod("hovered")}}},_onPointerenter:function(e){this.setMod("hovered","yes")},_onPointerleave:function(e){this.delMod("hovered")}},{live:function(){this.liveBindTo("pointerover pointerout",function(e){if(this.hasMod("disabled")||this.domElem[0].contains(e.relatedTarget)){return}e.type==="pointerover"?this._onPointerenter(e):this._onPointerleave(e)});return this.__base.apply(this,arguments)}});window.BEM.DOM.decl({block:"button2",modName:"has-control",modVal:"yes"},{onSetMod:{checked:{yes:function(){this.__base.apply(this,arguments);this.elem("control").prop("checked",true).attr("aria-checked","true")},"":function(){this.__base.apply(this,arguments);this.elem("control").prop("checked",false).removeAttr("aria-checked").removeAttr("checked")}}},getVal:function(){return this.elem("control").val()},setVal:function(value){this.elem("control").val(value);return this},_processClick:function(e){this.__base.apply(this,arguments);this.hasMod("type","radio")&&this.setMod("checked","yes");this.hasMod("type","check")&&this.toggleMod("checked","yes")},getDefaultParams:function(){return $.extend(this.__base(),{prvntKeys:["SPACE"],clickKeys:["SPACE"]})}});window.BEM.DOM.decl({block:"button2",modName:"type",modVal:"check"},{_onClick:function(){this.__base.apply(this,arguments);this.toggleMod("checked","yes")}});window.BEM.DOM.decl({block:"button2",modName:"type",modVal:"radio"},{_onClick:function(){this.__base.apply(this,arguments);this.setMod("checked","yes")}});window.BEM.DOM.decl({block:"radio-button",baseBlock:"radiobox"},{onSetMod:{disabled:{yes:function(){this.delMod("focused");this.__base.apply(this,arguments)}}},onElemSetMod:{radio:{pressed:{yes:function(){this.delMod(this.elem("radio","pressed","yes"),"pressed")}}}},_onPointerPress:function(e){this._pressedRadio=e.data.domElem;if(this.isDisabled(this._pressedRadio)){return}this.setMod(this._pressedRadio,"pressed","yes");this.bindToDoc("pointerrelease",this._onPointerRelease)},_onPointerRelease:function(e){var radio=this._pressedRadio;delete this._pressedRadio;this.delMod(radio,"pressed");this.afterCurrentEvent(function(){if(!this.domElem){return}var control=this.findElem(radio,"control");if(!control.prop("checked")&&(radio.is(e.target)||radio.find(e.target).length)){control.trigger("change").focus()}});this.unbindFromDoc("pointerrelease")}},{live:function(){this.liveBindTo("radio","pointerpress",function(e){this._onPointerPress(e)}).liveBindTo("control","focusin focusout",function(e){!this.hasMod("disabled")&&this.toggleMod("focused","yes",e.type==="focusin")});return this.__base()}});window.BEM.DOM.decl({block:"radio-button"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments);this._boundResizeHandler=this._resizeHandler.bind(this);this.__self._bindToWinResize(this._boundResizeHandler);this._setPlate(this.elem("radio","checked","yes"));this.afterCurrentEvent(function(){this.setMod("animated","yes")})}}},destruct:function(){this.__self._unbindFromWinResize(this._boundResizeHandler);this._boundResizeHandler=null;this.__base.apply(this,arguments)},onElemSetMod:{radio:{checked:{yes:function(elem){this.__base.apply(this,arguments);this._setPlate(elem)}}}},_resizeHandler:function(){this.delMod("animated");this._setPlate(this.findElem("radio","checked","yes"));this.afterCurrentEvent(function(){this.setMod("animated","yes")})},_setPlate:function(elem){var plate=this.elem("plate"),offsetLeft=elem.length?elem[0].offsetLeft:0,plateMargin=parseInt(plate.css("top")||"0",10);plate.css({left:offsetLeft+plateMargin+"px",width:elem.outerWidth()-plateMargin*2+"px"})}},{resizeCallbacks_:[],_bindToWinResize:function(callback){this.resizeCallbacks_.push(callback);return this},_unbindFromWinResize:function(callback){for(var i=0;i<this.resizeCallbacks_.length;i++){if(this.resizeCallbacks_[i]===callback){this.resizeCallbacks_.splice(i,1);return this}}return this},_getResizeCallback:function(){return $.throttle(function(){var args=arguments;this.resizeCallbacks_.forEach(function(callback){callback.apply(this,args)},this)},300,this)},live:function(){this._resizeCallback=this._getResizeCallback();BEM.DOM.win.on("resize",this._resizeCallback);return this.__base()}});window.BEM.DOM.decl({block:"popup2",modName:"hiding",modVal:"yes"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments);this._anchorParents=null;this._isAnchorVisible=undefined;this._updateIsAnchorVisible=$.throttle(this._updateIsAnchorVisible,this.__self.UPDATE_TARGET_VISIBILITY_THROTTLING_INTERVAL,this)}},visible:{yes:function(){console.assert(this._anchor,"popup2: Нужно установить anchor перед отображением попапа.");this._anchorParents=this._getAnchorParents();this._bindToAnchorParents();this.__base.apply(this,arguments)},"":function(){this.__base.apply(this,arguments);this._updateIsAnchorVisible.stop();this._unbindFromAnchorParents();this._anchorParents=null;this._isAnchorVisible=undefined}}},_getAnchorParents:function(){var next=this,popup;while(next&&next._anchor){popup=next;next=next._getParentPopup()}return $(popup._anchor).parents()},setAnchor:function(anchor){this.__base.apply(this,arguments);this._unbindFromAnchorParents();this._isAnchorVisible=undefined;if(this.hasMod("visible")){this._anchorParents=this._getAnchorParents();this._bindToAnchorParents()}else{this._anchorParents=null}return this},_unbindFromDestructor:function(){this._updateIsAnchorVisible.stop&&this._updateIsAnchorVisible.stop();return this.__base.apply(this,arguments)},_calcDrawingCss:function(drawingParams){var base=this.__base.apply(this,arguments);if(typeof this._isAnchorVisible==="undefined"){this._isAnchorVisible=this._calcIsAnchorVisible()}return $.extend(base,{display:this._isAnchorVisible?"":"none"})},_calcIsAnchorVisible:function(){var anchor=this._anchor,anchorOffset=this._getOffsetOf(anchor),anchorLeft=anchorOffset.left,anchorTop=anchorOffset.top,anchorRight=anchorLeft+anchor.outerWidth(),anchorBottom=anchorTop+anchor.outerHeight(),direction=this.getMod("direction"),vertBorder=Math.floor(this._checkDirection(direction,"top")?anchorTop:anchorBottom),horizBorder=Math.floor(this._checkDirection(direction,"left")?anchorLeft:anchorRight),res=true;this._anchorParents.each(function(idx,parent){if(parent.tagName==="BODY"){return false}parent=$(parent);var re=/scroll|hidden|auto/,hasOverflowY=re.test(parent.css("overflow-y")),hasOverflowX=re.test(parent.css("overflow-x"));if(hasOverflowY||hasOverflowX){var parentOffset=this._getOffsetOf(parent),parentTopOffset=Math.floor(parentOffset.top);if(vertBorder<parentTopOffset||parentTopOffset+parent.outerHeight()<vertBorder){res=false;return res}var parentLeftOffset=Math.floor(parentOffset.left);res=horizBorder>=parentLeftOffset&&parentLeftOffset+parent.outerWidth()>=horizBorder;return res}}.bind(this));return res},_bindToAnchorParents:function(){return this.bindTo(this._anchorParents,"scroll",this._onAnchorParentsScroll)},_unbindFromAnchorParents:function(){this._updateIsAnchorVisible.stop();this._anchorParents&&this.unbindFrom(this._anchorParents,"scroll");return this},_onAnchorParentsScroll:function(){this.redraw()._updateIsAnchorVisible()},_onWinScrollAndResize:function(){if(!this.hasMod("visible")){return}this.__base.apply(this,arguments);this._updateIsAnchorVisible()},_updateIsAnchorVisible:function(){if(!this.domElem){return}var isAnchorVisible=this._calcIsAnchorVisible();if(isAnchorVisible!==this._isAnchorVisible){this._isAnchorVisible=isAnchorVisible;this.redraw()}}},{UPDATE_TARGET_VISIBILITY_THROTTLING_INTERVAL:100});(function($,BEM,undefined){var RENDER_THROTTLING=.25,percentsCache=[],valsCache=[];function dropCache(idx,val,percent,vals){if(Math.abs(percent-percentsCache[idx])<RENDER_THROTTLING){return}var inc=percent>percentsCache[idx]?1:0,i=0,n=percentsCache.length,next;percentsCache[idx]=percent;if(n===1){return}do{if(i===idx){continue}next=percentsCache[i];if(inc){if(i>idx){next<percent&&(percentsCache[i]=percent);val>=vals[i]&&(valsCache[i]=vals[i])}else{percentsCache[i]=val<valsCache[i]?percent:this._calcPercentByValue(valsCache[i])}}else if(i<idx){next>percent&&(percentsCache[i]=percent);val<=vals[i]&&(valsCache[i]=vals[i])}else{percentsCache[i]=val>valsCache[i]?percent:this._calcPercentByValue(valsCache[i])}}while(++i<n)}window.BEM.DOM.decl("slider",{onSetMod:{js:{inited:function(){this._IS_REALSLIDER=true;this._setScale();this._setVals();this.on("change",this._onChange,this)}},disabled:function(modName,disabled){this.setMod(this.elem("runner"),modName,disabled)}},onElemSetMod:{runner:{disabled:function(elem,modName,disabled){disabled&&this.delMod(elem,"focused");this._getInputs()[this._getRunnerIdx(elem)].toggleMod(modName,"yes",Boolean(disabled));this.findBlockOn(elem,"button2").setMod(modName,disabled)},focused:{yes:function(elem,modName,modVal){if(this.isRunnerDisabled(elem)||this.isDisabled()){return false}this._interval=this._getIntervalByValue(this._vals[this._getRunnerIdx(elem)])},"":function(elem,modName,modVal){elem.eq(this._activeRunner)&&(this._activeRunner=null)},"*":function(elem,modName,modVal){this.findBlockOn(elem,"button2").setMod(modName,modVal)}}}},_setScale:function(){var scale=this._scale=this.params.scale;scale[0].percent=0;scale.length>1&&(scale[scale.length-1].percent=100)},_setVals:function(){var self=this;this._vals=this._getInputs().map(function(block){var v=self.fromDisplay(block.val());return isNaN(v)?self.min():v})},_getInputs:function(){return this._inputs||(this._inputs=this.findBlocksInside("textinput"))},_getInputIdx:function(input){return $.inArray(input,this._getInputs())},_getRunnerIdx:function(runner){return this.hasMod(runner,"pos")?this.getMod(runner,"pos")-1:0},_getActiveRunner:function(){return this._activeRunner||(this._activeRunner=this.elem("runner","focused","yes"))},_val:function(idx,val){val=parseFloat(val);if(isNaN(val)){return true}this._interval=this._getIntervalByValue(val);var step=this._scale[this._interval].step,start=this._scale[this._interval].value,i=0,vals=this._vals,n=vals.length,prev=vals[idx],inc,next;val=this.toAllowedRange(idx,start+Math.round((val-start)/step)*step);val=this._toRoundValue(val);if(vals[idx]===val?false:(vals[idx]=val,true)){if(n===1){return true}inc=prev>val?0:1;do{if(i===idx){continue}next=vals[i];if(inc){i>idx?next<val&&(vals[i]=val):val<=valsCache[i]&&(vals[i]=val)}else{i<idx?next>val&&(vals[i]=val):val>=valsCache[i]&&(vals[i]=val)}}while(++i<n);return true}return false},_toRoundValue:function(value){var step=this._scale[this._interval].step;if(step!==undefined){var fixedValue=0;var chunks=step.toString().split(".");if(chunks[1]!==undefined){fixedValue=chunks[1].length}return parseFloat(value.toFixed(fixedValue))}return value},toAllowedRange:function(idx,val){var scale=this._scale,min=scale[0].value,max=scale[scale.length-1].value;val>max&&(val=max);val<min&&(val=min);return val},val:function(val,data){return this.vals(0,val,data)},vals:function(idx,val,data){var idxType=typeof idx;if(typeof val==="undefined"){if(idxType!=="object"){return idxType==="number"?this._vals[idx]:this._vals}val=idx}if(this.isDisabled()){return this}var isChanged=false;if($.isArray(val)){if(val.length<this._vals.length){return this}this._vals.forEach(function(v,i){this._val(i,val[i])&&!isChanged&&(isChanged=true)},this)}else{isChanged=this._val(idx,val)}if(isChanged){this._render();this.trigger("change",data)}return this},min:function(min){var params=this.params;if(typeof min==="undefined"){return params.min?params.min:this._scale[0].value}return this.range(min,this.max())},max:function(max){var params=this.params;if(typeof max==="undefined"){return params.hasOwnProperty("max")?params.max:this._scale[this._scale.length-1].value}return this.range(this.min(),max)},range:function(min,max){if(!arguments.length){return[this.min(),this.max()]}var minLimit=this._scale[0].value,maxLimit=this._scale[this._scale.length-1].value;min=Math.max(Math.min(min,maxLimit),minLimit);max=Math.max(Math.min(max,maxLimit),minLimit);if(min>max){max=maxLimit}this.params.min=min;this.params.max=max;this._updateRange();this._render();return this},prev:function(){var idx=this._getRunnerIdx(this._getActiveRunner());if(typeof idx==="undefined"||!this._vals[idx]){return}var val=this._vals[idx]-this._scale[this._interval].step,interval=this._getIntervalByValue(val);interval<this._interval&&(val=this._vals[idx]-this._scale[interval].step);return this.vals(idx,val,{source:"keyboard"})},next:function(){var idx=this._getRunnerIdx(this._getActiveRunner());if(typeof idx==="undefined"||this._vals[idx]>=this._scale[this._scale.length-1].value){return}var val=this._vals[idx]+this._scale[this._interval].step,interval=this._getIntervalByValue(val);interval>this._interval&&(val=this._scale[interval].value);return this.vals(idx,val,{source:"keyboard"})},isRunnerDisabled:function(runner){if(typeof runner==="number"){runner=this.elem("runner").eq(runner)}return this.hasMod(runner,"disabled","yes")},isDisabled:function(){return this.hasMod("disabled")},getInterval:function(){return this._interval},_onRunnerPress:function(elem,e){e.preventDefault();this._getOffsetPointerCoord(e);valsCache=this._vals.slice(0);percentsCache=this._calcPercentsByValue(valsCache);this.delMod("animation").bindToDoc("pointermove",this._onRunnerMove).bindToDoc("pointerrelease",this._onRunnerRelease).setMod(e.data.domElem,"focused","yes")},_onRunnerMove:function(e){var idx=this._getRunnerIdx(this._getActiveRunner()),val=this._calcValueByEvent(e);dropCache.call(this,idx,val,this._calcPercentByValue(this.toAllowedRange(idx,val)),this._vals);this._render(percentsCache);this._val(idx,val)&&this.trigger("change",{source:"drag"})},_onRunnerRelease:function(e){this.unbindFromDoc("pointermove pointerrelease");valsCache=[];percentsCache=[];this.setMod("animation","yes")._render();this.trigger("dragend")},_onRunnerKeydown:function(e){var keycode=e.keyCode,isArrow=BEM.blocks.keycodes.is(keycode,"LEFT","UP","RIGHT","DOWN");if(isArrow){e.preventDefault();BEM.blocks.keycodes.is(keycode,"UP","RIGHT")?this.next():this.prev()}},_onTrackClick:function(e){var val=this._calcValueByEvent(e),runner=this._getClosestRunnerByValue(val);if(runner){this.vals(this._getRunnerIdx(runner),val,{source:"click"})}},_onChange:function(e,data){this._getInputs().forEach(function(input,i){input.domElem&&input.val(this.toDisplay(this._vals[i]))},this);return this},_onInputChange:function(e){var idx=this.elem("input").index(e.data.domElem),input=this._getInputs()[idx],prev=this._vals[idx];this.vals(idx,this.fromDisplay(input.val()),{source:"input"});if(prev===this._vals[idx]){input.val(this._vals[idx])}},toDisplay:function(num){return String(num)},fromDisplay:function(str){return parseFloat(str)},getDefaultParams:function(){return{scale:[{percent:0,value:0,step:1,label:""},{percent:100,value:100,step:1,label:""}]}}},{live:function(){this.liveBindTo("click","pointerclick",function(e){this.isDisabled()||this._onTrackClick(e)}).liveBindTo("focusout",function(e){this.delMod(this.elem("runner"),"focused")}).liveBindTo("input","focusout",function(e){this._IS_REALSLIDER&&this._onInputChange(e)}).liveBindTo("input","keypress",function(e){e.which===BEM.blocks.keycodes.ENTER&&this._onInputChange(e)}).liveBindTo("runner","focusin",function(e){this.setMod($(e.target),"focused","yes")}).liveBindTo("runner","pointerpress",function(e){this.isDisabled()||this.isRunnerDisabled(e.data.domElem)||this._onRunnerPress(e.data.domElem,e)}).liveBindTo("runner","keydown",function(e){this._onRunnerKeydown(e)});return false}})})(jQuery,BEM);window.BEM.DOM.decl("slider",{onSetMod:{js:{inited:function(){this.__base();this._build();this.hasMod("disabled")&&this.setMod(this.elem("runner"),"disabled","yes");if(typeof this.elem("body")[0].onselectstart!=="undefined"){this.elem("body")[0].onselectstart=function(){return false}}this.setMod("animation","yes")}}},_getRunnerText:function(idx){console.assert(typeof idx==="number","slider: _getRunnerText() принимает одно числовое значение");return this.toDisplay(this._vals[idx])},_updateOne:function(idx,percent){var st=this._scale,runner=this.elem("runner").eq(idx);st=this._vals[idx]===st[0].value?-1:this._vals[idx]===st[st.length-1].value?1:0;runner.css(this.__POS_UNIT,percent+"%");this.toggleMod(runner,"state","start",st<0).toggleMod(runner,"state","end",st>0);this.findBlockOn(runner,"button2").setText(this._getRunnerText(idx));runner.attr("aria-valuenow",this._vals[idx])},_updateRanges:function(percents){var posUnit=this.__POS_UNIT,dimUnit=this.__DIM_UNIT,idx=percents.length,pos,UI_DEVIATION=this.__self.UI_DEVIATION,dim=(100-percents[idx-1]-UI_DEVIATION).toFixed(1),ranges=this.elem("range");function render(range,pos,dim){var css={};css[posUnit]=typeof pos==="undefined"?"auto":pos+"%";css[dimUnit]=(dim>0?dim:0)+"%";range.css(css)}do{render(ranges.eq(idx--),pos,dim);pos=parseFloat((percents[idx-1]||0).toFixed(1));dim=parseFloat((percents[idx]-pos+UI_DEVIATION).toFixed(1))}while(idx);render(ranges.eq(0),0,percents[0])},_updateRange:function(){var min=this._calcPercentByValue(this.min()),max=this.max(),css={},allowedRangeElem=this.elem("allowed-range");css[this.__POS_UNIT]=min+"%";css[this.__DIM_UNIT]=(max?this._calcPercentByValue(max):100)-min+"%";allowedRangeElem.css(css);this.toggleMod(allowedRangeElem,"visibility","visible","",this._isAllowedRangeVisible())},_render:function(percents){var self=this;percents||(percents=this._calcPercentsByValue(this._vals));percents.forEach(function(percent,idx){self._updateOne(idx,percent)});this._updateRanges(percents);return percents},_buildScale:function(block){var posUnit=this.__POS_UNIT,marksLength=this._scale.length,hasScale=false,marks=this._scale.map(function(mark,i){var mods={},needPosStyle=true;if(mark.label&&mark.label.length){hasScale=true}if(i===0){mods.position="first";needPosStyle=false}else if(i===marksLength-1){mods.position="last";needPosStyle=false}return{block:block,elem:"mark",elemMods:mods,attrs:needPosStyle&&{style:posUnit+":"+mark.percent+"%"},content:mark.label||""}});return hasScale&&{block:block,elem:"scale",content:marks}},_buildRunner:function(block,pos,percent){var runnerMods={pos:pos},idx=pos-1;if(this._vals[idx]===this._scale[0].value){runnerMods.state="start"}else if(this._vals[idx]===this._scale[this._scale.length-1].value){runnerMods.state="end"}return{block:block,mods:this.getMods(),elem:"runner",elemMods:runnerMods,attrs:{style:this.__POS_UNIT+":"+percent+"%;"},idx:idx,value:this._getRunnerText(idx),button:{mods:{size:this.getMod("size"),theme:this.getMod("theme")}}}},_buildAllowedRange:function(block){var min=this._calcPercentByValue(this.min()),max=this.max();return{block:block,elem:"allowed-range",elemMods:{visibility:this._isAllowedRangeVisible()?"visible":""},attrs:{style:this.__POS_UNIT+":"+min+"%;"+this.__DIM_UNIT+":"+((max?this._calcPercentByValue(max):100)-min)+"%;"}}},_build:function(){var self=this,blockName=this.__self.getName(),posUnit=this.__POS_UNIT,dimUnit=this.__DIM_UNIT,scale=this._buildScale(blockName),percents=this._vals.map(function(val){return self._calcPercentByValue(val)}),n=percents.length-1,range=[{block:blockName,elem:"range",elemMods:{pos:1,position:"first"},attrs:{style:posUnit+":0%;"+dimUnit+":"+percents[0]+"%"}}],runners=[],isCollapsed=false,inputs=this._getInputs(),titleId=this.elem("title").attr("id")||"",min=this.min(),max=this.max(),inputId,runnerId;percents.forEach(function(percent,i){runners.push(self._buildRunner(blockName,i+1,percent));inputId=$.identify();runnerId=$.identify();inputs[i].elem("control").attr({id:inputId,"aria-labelledby":titleId,"aria-controls":runnerId});$.extend(runners[i],{id:runnerId,inputId:inputId,labelledby:titleId,min:min,max:max});range.push({block:blockName,elem:"range",elemMods:{pos:i+2},attrs:{style:posUnit+":"+(i<n?percent+"%;":"auto;")+dimUnit+":"+((i<n?percents[i+1]+self.__self.UI_DEVIATION:100)-percent).toFixed(1)+"%"}});isCollapsed||i&&percent===percents[i-1]&&(isCollapsed=true)});range[range.length-1].mods=range[range.length-1].elemMods;range[range.length-1].elemMods.position="last";if(runners.length>1){runners[0].elemMods.position="first";runners[runners.length-1].elemMods.position="last"}else{runners[0].elemMods.pos=null;delete runners[0].elemMods.pos}range.push(this._buildAllowedRange(blockName));isCollapsed&&this.setMod("collapsed","yes");this.domElem.append(BEMHTML.apply(scale));BEM.DOM.append(this.elem("body"),BEMHTML.apply(range.concat(runners)));this._updateDimmensions(this._calcDimmensions())},_calcDimmensions:function(){var runner,d=this.params.runnerWidth,scale=this._scale;if(!d){scale=scale[scale.length-1];runner=this._buildRunner(this.__self.getName(),0,100);runner.value=this.toDisplay(scale.value);runner=$(BEMHTML.apply(runner)).appendTo(this.elem("body")).css("width","auto");d=runner.outerWidth();runner.remove()}return{width:d,"margin-left":0-d/2}},_updateDimmensions:function(dim){this.elem("runner").css(dim)},_isAllowedRangeVisible:function(){return this.min()>this._scale[0].value||this.max()<this._scale[this._scale.length-1].value}},{UI_DEVIATION:.2});window.BEM.DOM.decl("slider",{getOrientation:function(){return this.__ORIGIN==="Y"?"vert":"hor"},_getDirrectionFromCoord:function(coord){this._dirrection=coord>(this._dirrectionCoord||0)?1:-1;this._dirrectionCoord=coord;return this._dirrection},_calcPercentByValue:function(val){var scale=this._scale,it=scale.length>2?this._getIntervalByValue(val):0;return parseFloat(this.__self.calcPercentForInterval(scale[it],scale[it+1],val).toFixed(1))},_calcPercentsByValue:function(vals){var t=this;return vals.map(function(val){return t._calcPercentByValue(val)})},_calcPercentByCoord:function(coord){return parseFloat((coord*100/this.elem("body")[this.__DIM_UNIT]()).toFixed(1))},_calcValueByPercent:function(percent){var scale=this._scale,it=scale.length>2?this._getIntervalByPercent(percent):0;return this.__self.calcValueForInterval(scale[it],scale[it+1],percent)},_calcValueByEvent:function(e){return this._calcValueByPercent(this._calcPercentByEvent(e))},_getIntervalByValue:function(val){var scale=this._scale,n=scale.length,i=1;if(val<=scale[0].value){return 0}if(val>=scale[n-1].value){return n-2}for(i=1;i<n;i++){if(val<scale[i].value){return i-1}}return n-2},_getIntervalByPercent:function(percent){if(percent<=0){return 0}if(percent>=100){return this._scale.length-2}var scale=this._scale,n=scale.length,i;for(i=0;i<n;i++){if(percent>=scale[i].percent&&percent<(scale[i+1]?scale[i+1].percent:100)){return i}}return n-2},_getClosestRunnerByValue:function(val){var sc=this._scale,distance=sc[sc.length-1].value-sc[0].value,runner;this._vals.forEach(function(value,i){var valDistance=value-val,absDistance=Math.abs(valDistance),cRunner;if(absDistance<=distance){if(runner&&absDistance===distance&&valDistance>0){return}distance=absDistance;cRunner=this.elem("runner").eq(i);this.isRunnerDisabled(cRunner)||(runner=cRunner)}},this);return runner}},{calcPercentForInterval:function(a,b,val){return(b.percent-a.percent)*(val-a.value)/(b.value-a.value)+a.percent},calcValueForInterval:function(a,b,percent){return(b.value-a.value)*(percent-a.percent)/(b.percent-a.percent)+a.value}});window.BEM.DOM.decl({block:"slider",modName:"type",modVal:"range"},{onSetMod:{collapsed:function(modName,collapsed){this.trigger(collapsed?"collapse":"separate")}},_render:function(persents){this.__base(persents);var vals=this._vals,isSeparated=vals.slice(0,-1).some(function(val,i){return val!==vals[i+1]});this.toggleMod("collapsed","","yes",isSeparated)},_updateDimmensions:function(dim){this.__base.apply(this,arguments);this.elem("runner","position","first").css("margin-left",1-dim.width);this.elem("runner","position","last").css("margin-left",0)}});window.BEM.DOM.decl("attach",{onSetMod:{js:{inited:function(){this._noFileText=this.elem("text").text();this._filePath="";this._setFilePath("");this.bindTo("reset","pointerclick",this.resetFile)}},disabled:function(modName,disabled){this.elem("control").prop("disabled",disabled);this.getButton().setMod("disabled",disabled)}},val:function(){return this._filePath},getButton:function(){return this._button||(this._button=this.findBlockOn("button","button2"))},resetFile:function(){var buttonControl=this.elem("control");buttonControl.val("");buttonControl.replaceWith(buttonControl.clone());this.dropElemCache("control");this.getButton().dropElemCache("control");this._setFilePath("");return this.trigger("reset")},_setFilePath:function(filePath,force){var prevFilePath=this._filePath;this._filePath=filePath;var fileName=filePath.split("\\").pop(),fileExtension=fileName.split(".").pop().toLowerCase();this.setMod(this.elem("holder"),"file",this._extensionsToMods[fileExtension]||this.params.unknownType);this.toggleMod(this.elem("holder"),"state","hidden",!fileName);var textWidth=this.params.textWidth;var elemText=this.elem("text");if(textWidth){elemText.css("width",fileName?textWidth+"px":"auto")}elemText.text(fileName||this._noFileText);if(force||filePath!==prevFilePath){this.trigger("change")}},_update:function(){this._setFilePath(this.elem("control").val(),true)},_extensionsToMods:{zip:"archive",rar:"archive",tar:"archive",gz:"archive","7z":"archive",gif:"gif",jpg:"jpg",jpeg:"jpg",png:"png",eml:"eml",exe:"exe",m4a:"audio",ogg:"audio",mp3:"mp3",wav:"wav",wma:"wma",flv:"video",mov:"mov",wmv:"wmv",mp4:"mp4",avi:"avi",xls:"xls",doc:"doc",docx:"doc",txt:"txt",pdf:"pdf",ppt:"ppt"},getDefaultParams:function(){return{unknownType:"unknown"}}},{live:function(){this.liveBindTo("change",function(){this._update()})}});window.BEM.DOM.decl({block:"slider",modName:"orientation",modVal:"horiz"},{onSetMod:{js:{inited:function(){this.__POS_UNIT="left";this.__DIM_UNIT="width";this.__ORIGIN="X";this.__base.apply(this,arguments)}}},_getCoordFromEvent:function(e){return e.clientX},_getOffsetPointerCoord:function(e){var runner=e.data.domElem;this._offsetPointer=this._dirrectionCoord=(this._getCoordFromEvent(e)-runner.offset().left+parseInt(runner.css("margin-left"),10)).toFixed(2);return this._offsetPointer},_calcPercentByEvent:function(e){var coord=this._getCoordFromEvent(e);this._getDirrectionFromCoord(coord);return this._calcPercentByCoord(coord-this.elem("body").offset().left-(this._offsetPointer||0))}});(function(global){var __i18n__=function(){var __bem__={};(function(BEM){(function(bem){if(typeof bem.I18N==="function"&&bem.I18N._proto){return bem.I18N}if(typeof i18n==="undefined"){i18n={}}var BEM=bem;var MOD_DELIM="_",ELEM_DELIM="__",DEFAULT_LANG="ru",cache={},stack=[],debug=false,hasConsole=typeof console!=="undefined"&&typeof console.log==="function";function logWarning(message,i18n){if(debug&&hasConsole){var debugString="keyset: "+i18n._keyset+" key: "+i18n._key+" (lang: "+i18n._lang+")";console.log(message,debugString)}}function bemName(decl){if(typeof decl==="string")return decl;return decl.block+(decl.elem?ELEM_DELIM+decl.elem:"")+(decl.modName?MOD_DELIM+decl.modName+MOD_DELIM+decl.modVal:"")}function bemParse(name){var bemitem={};name.split(ELEM_DELIM).forEach(function(item,i){var keys=[i?"elem":"block","mod","val"];item.split(MOD_DELIM).forEach(function(part,j){bemitem[keys[j]]=part})});return bemitem}function _pushStack(name){if(name)stack.push(name)}function _popStack(){return stack.length&&stack.pop()}function _i18n(){this._lang="";this._prj="lego";this._keyset="";this._key=""}_i18n.prototype={lang:function(name){this._lang=name;return this},project:function(name){this._prj=name;return this},keyset:function(name,saveCtx){saveCtx&&_pushStack(this._keyset);this._keyset=bemName(name);return this},key:function(name){this._key=name;return this},decl:function(v){var bemitem=bemParse(this._keyset),prj=bemitem.block==="i-tanker"?"tanker":this._prj,keyset=bemitem.elem||this._keyset,key=this._key;prj=i18n[prj]||(i18n[prj]={});keyset=prj[keyset]||(prj[keyset]={});keyset[key]=typeof v==="function"?v:function(){return v};var l=cache[this._lang]||(cache[this._lang]={}),k=l[this._keyset]||(l[this._keyset]={});k[key]=v},val:function(params,ctx){var value=cache[this._lang]&&cache[this._lang][this._keyset];if(!value){logWarning("[I18N_NO_KEYSET] %s",this);return""}value=value[this._key];var valtype=typeof value;if(valtype==="undefined"){logWarning("[I18N_NO_VALUE] %s",this);return""}if(valtype==="string"){return value}return value.call(ctx||this,params)},_cache:function(){return cache}};var bemi18n=function(keyset,key,params){return bemi18n.keyset(keyset).key(key,params)};bemi18n._proto=new _i18n;bemi18n.project=function(name){this._proto.project(name);return this};bemi18n.keyset=function(name){this._proto.keyset(name,true);return this};bemi18n.key=function(name,params){var proto=this._proto,result,ksetRestored;proto.lang(this._lang).key(name);result=proto.val(params,bemi18n);ksetRestored=_popStack();ksetRestored&&proto.keyset(ksetRestored,false);return result};bemi18n.decl=function(bemitem,keysets,params){var proto=this._proto,k;if(params&&params.lang)proto.lang(params.lang);proto.keyset(bemitem);for(k in keysets){if(keysets.hasOwnProperty(k)){proto.key(k).decl(keysets[k])}}return this};bemi18n.lang=function(lang){typeof lang!=="undefined"&&(this._lang=lang);return this._lang};bemi18n.debug=function(flag){debug=!!flag};bemi18n.lang(DEFAULT_LANG);bem.I18N=bemi18n})(typeof BEM==="undefined"?{}:BEM)})(__bem__);var i18n=__bem__.I18N;i18n.lang("ru");return i18n}(),defineAsGlobal=true;if(defineAsGlobal){(BEM||(BEM={})).I18N=__i18n__;(global.BEM||(global.BEM={})).I18N=__i18n__}})(typeof window!=="undefined"?window:global);var BEMHTML;(function(global){function buildBemXjst(__bem_xjst_libs__){var exports={};var BEMHTML=function(module,exports){(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.bemhtml=f()}})(function(){var define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){var inherits=require("inherits");var Match=require("../bemxjst/match").Match;var BemxjstEntity=require("../bemxjst/entity").Entity;function Entity(bemxjst){this.bemxjst=bemxjst;this.jsClass=null;this.tag=new Match(this,"tag");this.attrs=new Match(this,"attrs");this.mod=new Match(this);this.js=new Match(this,"js");this.mix=new Match(this,"mix");this.bem=new Match(this,"bem");this.cls=new Match(this,"cls");BemxjstEntity.apply(this,arguments)}inherits(Entity,BemxjstEntity);exports.Entity=Entity;Entity.prototype.init=function init(block,elem){this.block=block;this.elem=elem;this.jsClass=this.bemxjst.classBuilder.build(this.block,this.elem)};Entity.prototype._initRest=function _initRest(key){if(key==="default"){this.rest[key]=this.def}else if(key==="tag"||key==="attrs"||key==="js"||key==="mix"||key==="bem"||key==="cls"||key==="content"){this.rest[key]=this[key]}else{if(!this.rest.hasOwnProperty(key))this.rest[key]=new Match(this,key)}};Entity.prototype.defaultBody=function defaultBody(context){var tag=this.tag.exec(context);var js;if(context.ctx.js!==false)js=this.js.exec(context);var bem=this.bem.exec(context);var cls=this.cls.exec(context);var mix=this.mix.exec(context);var attrs=this.attrs.exec(context);var content=this.content.exec(context);return this.bemxjst.render(context,this,tag,js,bem,cls,mix,attrs,content)}},{"../bemxjst/entity":5,"../bemxjst/match":8,inherits:11}],2:[function(require,module,exports){var inherits=require("inherits");var utils=require("../bemxjst/utils");var Entity=require("./entity").Entity;var BEMXJST=require("../bemxjst");function BEMHTML(options){BEMXJST.apply(this,arguments);var xhtml=typeof options.xhtml==="undefined"?true:options.xhtml;this._shortTagCloser=xhtml?"/>":">";this._elemJsInstances=options.elemJsInstances}inherits(BEMHTML,BEMXJST);module.exports=BEMHTML;BEMHTML.prototype.Entity=Entity;BEMHTML.prototype.runMany=function runMany(arr){var out="";var context=this.context;var prevPos=context.position;var prevNotNewList=context._notNewList;if(prevNotNewList){context._listLength+=arr.length-1}else{context.position=0;context._listLength=arr.length}context._notNewList=true;if(this.canFlush){for(var i=0;i<arr.length;i++)out+=context._flush(this._run(arr[i]))}else{for(var i=0;i<arr.length;i++)out+=this._run(arr[i])}if(!prevNotNewList)context.position=prevPos;return out};BEMHTML.prototype.render=function render(context,entity,tag,js,bem,cls,mix,attrs,content){var ctx=context.ctx;if(tag===undefined)tag="div";if(!tag)return this.renderNoTag(context,js,bem,cls,mix,attrs,content);var out="<"+tag;var ctxJS=ctx.js;if(ctxJS!==false){if(js===true)js={};if(js&&js!==ctx.js){if(ctxJS!==true)js=utils.extend(ctxJS,js)}else if(ctxJS===true){js={}}}var jsParams;if(js){jsParams={};jsParams[entity.jsClass]=js}var isBEM=bem;if(isBEM===undefined){if(ctx.bem===undefined)isBEM=entity.block||entity.elem;else isBEM=ctx.bem}isBEM=!!isBEM;if(cls===undefined)cls=ctx.cls;var addJSInitClass=jsParams&&(this._elemJsInstances?entity.block||entity.elem:entity.block&&!entity.elem);if(!isBEM&&!cls){return this.renderClose(out,context,tag,attrs,isBEM,ctx,content)}out+=' class="';if(isBEM){var mods=entity.elem?context.elemMods:context.mods;out+=entity.jsClass;out+=this.buildModsClasses(entity.block,entity.elem,mods);if(ctx.mix&&mix&&mix!==ctx.mix)mix=[].concat(mix,ctx.mix);if(mix){var m=this.renderMix(entity,mix,jsParams,addJSInitClass);out+=m.out;jsParams=m.jsParams;addJSInitClass=m.addJSInitClass}if(cls)out+=" "+(typeof cls==="string"?utils.attrEscape(cls).trim():cls)}else{if(cls)out+=cls.trim?utils.attrEscape(cls).trim():cls}if(addJSInitClass)out+=' i-bem"';else out+='"';if(isBEM&&jsParams)out+=" data-bem='"+utils.jsAttrEscape(JSON.stringify(jsParams))+"'";return this.renderClose(out,context,tag,attrs,isBEM,ctx,content)};BEMHTML.prototype.renderClose=function renderClose(prefix,context,tag,attrs,isBEM,ctx,content){var out=prefix;var isObj=function isObj(val){return val&&typeof val==="object"&&!Array.isArray(val)&&val!==null};if(isObj(attrs)||isObj(ctx.attrs)){attrs=utils.extend(attrs,ctx.attrs);for(var name in attrs){var attr=attrs[name];if(attr===undefined||attr===false||attr===null)continue;if(attr===true)out+=" "+name;else out+=" "+name+'="'+utils.attrEscape(utils.isSimple(attr)?attr:this.context.reapply(attr))+'"'}}if(utils.isShortTag(tag)){out+=this._shortTagCloser;if(this.canFlush)out=context._flush(out)}else{out+=">";if(this.canFlush)out=context._flush(out);if(content||content===0)out+=this.renderContent(content,isBEM);out+="</"+tag+">"}if(this.canFlush)out=context._flush(out);return out};BEMHTML.prototype.renderMix=function renderMix(entity,mix,jsParams,addJSInitClass){var visited={};var context=this.context;var js=jsParams;var addInit=addJSInitClass;visited[entity.jsClass]=true;if(!utils.isArray(mix))mix=[mix];var classBuilder=this.classBuilder;var out="";for(var i=0;i<mix.length;i++){var item=mix[i];if(!item)continue;if(typeof item==="string")item={block:item,elem:undefined};var hasItem=false;if(item.elem){hasItem=item.elem!==entity.elem&&item.elem!==context.elem||item.block&&item.block!==entity.block}else if(item.block){hasItem=!(item.block===entity.block&&item.mods)||item.mods&&entity.elem}var block=item.block||item._block||context.block;var elem=item.elem||item._elem||context.elem;var key=classBuilder.build(block,elem);var classElem=item.elem||item._elem||(item.block?undefined:context.elem);if(hasItem)out+=" "+classBuilder.build(block,classElem);out+=this.buildModsClasses(block,classElem,item.elem||!item.block&&(item._elem||context.elem)?item.elemMods:item.mods);if(item.js){if(!js)js={};js[classBuilder.build(block,item.elem)]=item.js===true?{}:item.js;if(!addInit)addInit=block&&!item.elem}if(!hasItem||visited[key])continue;visited[key]=true;var nestedEntity=this.entities[key];if(!nestedEntity)continue;var oldBlock=context.block;var oldElem=context.elem;var nestedMix=nestedEntity.mix.exec(context);context.elem=oldElem;context.block=oldBlock;if(!nestedMix)continue;for(var j=0;j<nestedMix.length;j++){var nestedItem=nestedMix[j];if(!nestedItem)continue;if(!nestedItem.block&&!nestedItem.elem||!visited[classBuilder.build(nestedItem.block,nestedItem.elem)]){if(nestedItem.block)continue;nestedItem._block=block;nestedItem._elem=elem;mix=mix.slice(0,i+1).concat(nestedItem,mix.slice(i+1))}}}return{out:out,jsParams:js,addJSInitClass:addInit}};BEMHTML.prototype.buildModsClasses=function buildModsClasses(block,elem,mods){if(!mods)return"";var res="";var modName;for(modName in mods){if(!mods.hasOwnProperty(modName)||modName==="")continue;var modVal=mods[modName];if(!modVal&&modVal!==0)continue;if(typeof modVal!=="boolean")modVal+="";var builder=this.classBuilder;res+=" "+(elem?builder.buildElemClass(block,elem,modName,modVal):builder.buildBlockClass(block,modName,modVal))}return res};BEMHTML.prototype.renderNoTag=function renderNoTag(context,js,bem,cls,mix,attrs,content){if(content||content===0)return this._run(content);return""}},{"../bemxjst":7,"../bemxjst/utils":10,"./entity":1,inherits:11}],3:[function(require,module,exports){function ClassBuilder(options){this.modDelim=options.mod||"_";this.elemDelim=options.elem||"__"}exports.ClassBuilder=ClassBuilder;ClassBuilder.prototype.build=function build(block,elem){if(!elem)return block;else return block+this.elemDelim+elem};ClassBuilder.prototype.buildModPostfix=function buildModPostfix(modName,modVal){var res=this.modDelim+modName;if(modVal!==true)res+=this.modDelim+modVal;return res};ClassBuilder.prototype.buildBlockClass=function buildBlockClass(name,modName,modVal){var res=name;if(modVal)res+=this.buildModPostfix(modName,modVal);return res};ClassBuilder.prototype.buildElemClass=function buildElemClass(block,name,modName,modVal){var res=this.buildBlockClass(block)+this.elemDelim+name;if(modVal)res+=this.buildModPostfix(modName,modVal);return res};ClassBuilder.prototype.split=function split(key){return key.split(this.elemDelim,2)}},{}],4:[function(require,module,exports){var utils=require("./utils");function Context(bemxjst){this._bemxjst=bemxjst;this.ctx=null;this.block="";this._currBlock="";this.elem=null;this.mods={};this.elemMods={};this.position=0;this._listLength=0;this._notNewList=false;this.escapeContent=bemxjst.options.escapeContent===true;this._onceRef={}}exports.Context=Context;Context.prototype._flush=null;Context.prototype.isArray=utils.isArray;Context.prototype.isSimple=utils.isSimple;Context.prototype.isShortTag=utils.isShortTag;Context.prototype.extend=utils.extend;Context.prototype.identify=utils.identify;Context.prototype.xmlEscape=utils.xmlEscape;Context.prototype.attrEscape=utils.attrEscape;Context.prototype.jsAttrEscape=utils.jsAttrEscape;Context.prototype.isFirst=function isFirst(){return this.position===1};Context.prototype.isLast=function isLast(){return this.position===this._listLength};Context.prototype.generateId=function generateId(){return utils.identify(this.ctx)};Context.prototype.reapply=function reapply(ctx){return this._bemxjst.run(ctx)}},{"./utils":10}],5:[function(require,module,exports){var utils=require("./utils");var Match=require("./match").Match;var tree=require("./tree");var Template=tree.Template;var PropertyMatch=tree.PropertyMatch;var CompilerOptions=tree.CompilerOptions;function Entity(bemxjst,block,elem,templates){this.bemxjst=bemxjst;this.block=null;this.elem=null;this.options={};this.canFlush=true;this.def=new Match(this);this.content=new Match(this,"content");this.rest={};this.init(block,elem);this.initModes(templates)}exports.Entity=Entity;Entity.prototype.init=function init(block,elem){this.block=block;this.elem=elem};function contentMode(){return this.ctx.content}Entity.prototype.initModes=function initModes(templates){for(var i=0;i<templates.length;i++){var template=templates[i];for(var j=template.predicates.length-1;j>=0;j--){var pred=template.predicates[j];if(!(pred instanceof PropertyMatch))continue;if(pred.key!=="_mode")continue;template.predicates.splice(j,1);this._initRest(pred.value);this.rest[pred.value].push(template);break}if(j===-1)this.def.push(template);for(var j=template.predicates.length-1;j>=0;j--){var pred=template.predicates[j];if(!(pred instanceof CompilerOptions))continue;this.options=utils.extend(this.options,pred.options)}}};Entity.prototype.prepend=function prepend(other){var keys=Object.keys(this.rest);for(var i=0;i<keys.length;i++){var key=keys[i];if(!other.rest[key])continue;this.rest[key].prepend(other.rest[key])}keys=Object.keys(other.rest);for(var i=0;i<keys.length;i++){var key=keys[i];if(this.rest[key])continue;this._initRest(key);this.rest[key].prepend(other.rest[key])}};Entity.prototype.run=function run(context){if(this.def.count!==0)return this.def.exec(context);return this.defaultBody(context)};Entity.prototype.setDefaults=function setDefaults(){if(this.content.count!==0)this.content.push(new Template([],contentMode));if(this.def.count!==0){this.canFlush=this.options.flush||false;var self=this;this.def.push(new Template([],function defaultBodyProxy(){return self.defaultBody(this)}))}}},{"./match":8,"./tree":9,"./utils":10}],6:[function(require,module,exports){function BEMXJSTError(msg,func){this.name="BEMXJSTError";this.message=msg;if(Error.captureStackTrace)Error.captureStackTrace(this,func||this.constructor);else this.stack=(new Error).stack}BEMXJSTError.prototype=Object.create(Error.prototype);BEMXJSTError.prototype.constructor=BEMXJSTError;exports.BEMXJSTError=BEMXJSTError},{}],7:[function(require,module,exports){var inherits=require("inherits");var Tree=require("./tree").Tree;var PropertyMatch=require("./tree").PropertyMatch;var Context=require("./context").Context;var ClassBuilder=require("./class-builder").ClassBuilder;var utils=require("./utils");function BEMXJST(options){this.options=options||{};this.entities=null;this.defaultEnt=null;this.tree=null;this.match=null;this.contextConstructor=function ContextChild(bemxjst){Context.call(this,bemxjst)};inherits(this.contextConstructor,Context);this.context=null;this.classBuilder=new ClassBuilder(this.options.naming||{});this.depth=0;this.canFlush=false;this.oninit=null;this.defaultEnt=new this.Entity(this,"","",[]);this.defaultElemEnt=new this.Entity(this,"","",[])}module.exports=BEMXJST;BEMXJST.prototype.locals=Tree.methods.concat("local","applyCtx","applyNext","apply");BEMXJST.prototype.compile=function compile(code){var self=this;function applyCtx(){return self._run(self.context.ctx)}function applyCtxWrap(ctx,changes){if(!changes)return self.local({ctx:ctx},applyCtx);return self.local(changes,function(){return self.local({ctx:ctx},applyCtx)})}function apply(mode,changes){return self.applyMode(mode,changes)}function localWrap(changes){return function localBody(body){return self.local(changes,body)}}var tree=new Tree({refs:{applyCtx:applyCtxWrap,local:localWrap}});var templates=this.recompileInput(code);var out=tree.build(templates,[localWrap,applyCtxWrap,function applyNextWrap(changes){if(changes)return self.local(changes,applyNextWrap);return self.applyNext()},apply]);if(this.tree){out={templates:out.templates.concat(this.tree.templates),oninit:this.tree.oninit.concat(out.oninit)}}this.tree=out;var ent=this.groupEntities(out.templates);ent=this.transformEntities(ent);this.entities=ent;this.oninit=out.oninit};BEMXJST.prototype.recompileInput=function recompileInput(code){var args=BEMXJST.prototype.locals;if(typeof code==="function"&&code.length===args.length)return code;var out=code.toString();out=out.replace(/^function[^{]+{|}$/g,"");out=new Function(args.join(", "),out);return out};BEMXJST.prototype.groupEntities=function groupEntities(tree){var res={};for(var i=0;i<tree.length;i++){var template=tree[i].clone();var block=null;var elem;elem=undefined;for(var j=0;j<template.predicates.length;j++){var pred=template.predicates[j];if(!(pred instanceof PropertyMatch))continue;if(pred.key==="block")block=pred.value;else if(pred.key==="elem")elem=pred.value;else continue;template.predicates.splice(j,1);j--}if(block===null){var msg="block(…) subpredicate is not found.\n"+"    See template with subpredicates:\n     * ";for(var j=0;j<template.predicates.length;j++){var pred=template.predicates[j];if(j!==0)msg+="\n     * ";if(pred.key==="_mode"){msg+=pred.value+"()"}else{if(Array.isArray(pred.key)){msg+=pred.key[0].replace("mods","mod").replace("elemMods","elemMod")+"('"+pred.key[1]+"', '"+pred.value+"')"}else if(!pred.value||!pred.key){msg+="match(…)"}else{msg+=pred.key+"('"+pred.value+"')"}}}msg+="\n    And template body: \n    ("+(typeof template.body==="function"?template.body:JSON.stringify(template.body))+")";if(typeof BEMXJSTError==="undefined"){BEMXJSTError=require("./error").BEMXJSTError}throw new BEMXJSTError(msg)}var key=this.classBuilder.build(block,elem);if(!res[key])res[key]=[];res[key].push(template)}return res};BEMXJST.prototype.transformEntities=function transformEntities(entities){var wildcardElems=[];var keys=Object.keys(entities);for(var i=0;i<keys.length;i++){var key=keys[i];var parts=this.classBuilder.split(key);var block=parts[0];var elem=parts[1];if(elem==="*")wildcardElems.push(block);entities[key]=new this.Entity(this,block,elem,entities[key])}if(entities.hasOwnProperty("*")){var wildcard=entities["*"];for(var i=0;i<keys.length;i++){var key=keys[i];if(key==="*")continue;entities[key].prepend(wildcard)}this.defaultEnt.prepend(wildcard);this.defaultElemEnt.prepend(wildcard)}for(var i=0;i<wildcardElems.length;i++){var block=wildcardElems[i];var wildcardKey=this.classBuilder.build(block,"*");var wildcard=entities[wildcardKey];for(var i=0;i<keys.length;i++){var key=keys[i];if(key===wildcardKey)continue;var entity=entities[key];if(entity.block!==block)continue;if(entity.elem===undefined)continue;entities[key].prepend(wildcard)}this.defaultElemEnt.prepend(wildcard)}for(var i=0;i<keys.length;i++){var key=keys[i];entities[key].setDefaults();this.defaultEnt.setDefaults();this.defaultElemEnt.setDefaults()}return entities};BEMXJST.prototype._run=function _run(context){var res;if(context===undefined||context===""||context===null)res=this.runEmpty();else if(utils.isArray(context))res=this.runMany(context);else if(typeof context.html==="string"&&!context.tag&&typeof context.block==="undefined"&&typeof context.elem==="undefined"&&typeof context.cls==="undefined"&&typeof context.attrs==="undefined")res=this.runUnescaped(context.html);else if(utils.isSimple(context))res=this.runSimple(context);else res=this.runOne(context);return res};BEMXJST.prototype.run=function run(json){var match=this.match;var context=this.context;this.match=null;this.context=new this.contextConstructor(this);this.canFlush=this.context._flush!==null;this.depth=0;var res=this._run(json);if(this.canFlush)res=this.context._flush(res);this.match=match;this.context=context;return res};BEMXJST.prototype.runEmpty=function runEmpty(){this.context._listLength--;return""};BEMXJST.prototype.runUnescaped=function runUnescaped(context){this.context._listLength--;return""+context};BEMXJST.prototype.runSimple=function runSimple(simple){this.context._listLength--;var res="";if(simple&&simple!==true||simple===0){res+=typeof simple==="string"&&this.context.escapeContent?utils.xmlEscape(simple):simple}return res};BEMXJST.prototype.runOne=function runOne(json){var context=this.context;var oldCtx=context.ctx;var oldBlock=context.block;var oldCurrBlock=context._currBlock;var oldElem=context.elem;var oldMods=context.mods;var oldElemMods=context.elemMods;if(json.block||json.elem)context._currBlock="";else context._currBlock=context.block;context.ctx=json;if(json.block){context.block=json.block;if(json.mods)context.mods=json.mods;else if(json.block!==oldBlock||!json.elem)context.mods={}}else{if(!json.elem)context.block="";else if(oldCurrBlock)context.block=oldCurrBlock}context.elem=json.elem;if(json.elemMods)context.elemMods=json.elemMods;else context.elemMods={};var block=context.block||"";var elem=context.elem;if(block||elem)context.position++;else context._listLength--;this.depth++;var key=this.classBuilder.build(block,elem);var restoreFlush=false;var ent=this.entities[key];if(ent){if(this.canFlush&&!ent.canFlush){restoreFlush=true;this.canFlush=false}}else{ent=this.defaultEnt;if(elem!==undefined)ent=this.defaultElemEnt;ent.init(block,elem)}var res=this.options.production===true?this.tryRun(context,ent):ent.run(context);context.ctx=oldCtx;context.block=oldBlock;context.elem=oldElem;context.mods=oldMods;context.elemMods=oldElemMods;context._currBlock=oldCurrBlock;this.depth--;if(restoreFlush)this.canFlush=true;return res};BEMXJST.prototype.tryRun=function tryRun(context,ent){try{return ent.run(context)}catch(e){console.error("BEMXJST ERROR: cannot render "+["block "+context.block,"elem "+context.elem,"mods "+JSON.stringify(context.mods),"elemMods "+JSON.stringify(context.elemMods)].join(", "),e);return""}};BEMXJST.prototype.renderContent=function renderContent(content,isBEM){var context=this.context;var oldPos=context.position;var oldListLength=context._listLength;var oldNotNewList=context._notNewList;context._notNewList=false;if(isBEM){context.position=0;context._listLength=1}var res=this._run(content);context.position=oldPos;context._listLength=oldListLength;context._notNewList=oldNotNewList;return res};BEMXJST.prototype.local=function local(changes,body){var keys=Object.keys(changes);var restore=[];for(var i=0;i<keys.length;i++){var key=keys[i];var parts=key.split(".");var value=this.context;for(var j=0;j<parts.length-1;j++)value=value[parts[j]];restore.push({parts:parts,value:value[parts[j]]});value[parts[j]]=changes[key]}var res=body.call(this.context);for(var i=0;i<restore.length;i++){var parts=restore[i].parts;var value=this.context;for(var j=0;j<parts.length-1;j++)value=value[parts[j]];value[parts[j]]=restore[i].value}return res};BEMXJST.prototype.applyNext=function applyNext(){return this.match.exec(this.context)};BEMXJST.prototype.applyMode=function applyMode(mode,changes){var match=this.match.entity.rest[mode];if(!match)return this.context.ctx[mode];if(!changes)return match.exec(this.context);var self=this;var fn=function localBody(){return match.exec(self.context)};return this.local(changes,fn)};BEMXJST.prototype.exportApply=function exportApply(exports){var self=this;exports.apply=function apply(context){return self.run(context)};exports.compile=function compile(templates){return self.compile(templates)};var sharedContext={};exports.BEMContext=this.contextConstructor;sharedContext.BEMContext=exports.BEMContext;for(var i=0;i<this.oninit.length;i++){var oninit=this.oninit[i];oninit(exports,sharedContext)}}},{"./class-builder":3,"./context":4,"./error":6,"./tree":9,"./utils":10,inherits:11}],8:[function(require,module,exports){var utils=require("./utils");var tree=require("./tree");var PropertyMatch=tree.PropertyMatch;var OnceMatch=tree.OnceMatch;var WrapMatch=tree.WrapMatch;var PropertyAbsent=tree.PropertyAbsent;var CustomMatch=tree.CustomMatch;function MatchProperty(template,pred){this.template=template;this.key=pred.key;this.value=pred.value}MatchProperty.prototype.exec=function exec(context){return context[this.key]===this.value};function MatchNested(template,pred){this.template=template;this.keys=pred.key;this.value=pred.value}MatchNested.prototype.exec=function exec(context){var val=context;for(var i=0;i<this.keys.length-1;i++){val=val[this.keys[i]];if(!val)return false}return val[this.keys[i]]===this.value};function MatchAbsent(template,pred){this.template=template;this.key=pred.key}MatchAbsent.prototype.exec=function exec(context){return!context[this.key]};function MatchCustom(template,pred){this.template=template;this.body=pred.body}MatchCustom.prototype.exec=function exec(context){return this.body.call(context,context,context.ctx)};function MatchOnce(template){this.template=template;this.once=null}MatchOnce.prototype.exec=function exec(context){var res=this.once!==context._onceRef;this.once=context._onceRef;return res};function MatchWrap(template){this.template=template;this.wrap=null}MatchWrap.prototype.exec=function exec(context){var res=this.wrap!==context.ctx;this.wrap=context.ctx;return res};function MatchTemplate(mode,template){this.mode=mode;this.predicates=new Array(template.predicates.length);this.body=template.body;var postpone=[];for(var i=0,j=0;i<this.predicates.length;i++,j++){var pred=template.predicates[i];if(pred instanceof PropertyMatch){if(utils.isArray(pred.key))this.predicates[j]=new MatchNested(this,pred);else this.predicates[j]=new MatchProperty(this,pred)}else if(pred instanceof PropertyAbsent){this.predicates[j]=new MatchAbsent(this,pred)}else if(pred instanceof CustomMatch){this.predicates[j]=new MatchCustom(this,pred)}else if(pred instanceof OnceMatch){j--;postpone.push(new MatchOnce(this))}else if(pred instanceof WrapMatch){j--;postpone.push(new MatchWrap(this))}else{j--}}for(var i=0;i<postpone.length;i++,j++)this.predicates[j]=postpone[i];if(this.predicates.length!==j)this.predicates.length=j}exports.MatchTemplate=MatchTemplate;function Match(entity,modeName){this.entity=entity;this.modeName=modeName;this.bemxjst=this.entity.bemxjst;this.templates=[];this.mask=[0];this.maskSize=0;this.maskOffset=0;this.count=0;this.depth=-1;this.thrownError=null}exports.Match=Match;Match.prototype.clone=function clone(entity){var res=new Match(entity,this.modeName);res.templates=this.templates.slice();res.mask=this.mask.slice();res.maskSize=this.maskSize;res.count=this.count;return res};Match.prototype.prepend=function prepend(other){this.templates=other.templates.concat(this.templates);this.count+=other.count;while(Math.ceil(this.count/31)>this.mask.length)this.mask.push(0);this.maskSize=this.mask.length};Match.prototype.push=function push(template){this.templates.push(new MatchTemplate(this,template));this.count++;if(Math.ceil(this.count/31)>this.mask.length)this.mask.push(0);this.maskSize=this.mask.length};Match.prototype.tryCatch=function tryCatch(fn,ctx){try{return fn.call(ctx,ctx,ctx.ctx)}catch(e){this.thrownError=e}};Match.prototype.exec=function exec(context){var save=this.checkDepth();var template;var bitIndex=this.maskOffset;var mask=this.mask[bitIndex];var bit=1;for(var i=0;i<this.count;i++){if((mask&bit)===0){template=this.templates[i];for(var j=0;j<template.predicates.length;j++){var pred=template.predicates[j];if(!pred.exec(context))break}if(j===template.predicates.length)break}if(bit===1073741824){bitIndex++;mask=this.mask[bitIndex];bit=1}else{bit<<=1}}if(i===this.count){this.restoreDepth(save);return context.ctx[this.modeName]}var oldMask=mask;var oldMatch=this.bemxjst.match;this.mask[bitIndex]|=bit;this.bemxjst.match=this;this.thrownError=null;var out;if(typeof template.body==="function")out=this.tryCatch(template.body,context);else out=template.body;this.mask[bitIndex]=oldMask;this.bemxjst.match=oldMatch;this.restoreDepth(save);var e=this.thrownError;if(e!==null){this.thrownError=null;throw e}return out};Match.prototype.checkDepth=function checkDepth(){if(this.depth===-1){this.depth=this.bemxjst.depth;return-1}if(this.bemxjst.depth===this.depth)return this.depth;var depth=this.depth;this.depth=this.bemxjst.depth;this.maskOffset+=this.maskSize;while(this.mask.length<this.maskOffset+this.maskSize)this.mask.push(0);return depth};Match.prototype.restoreDepth=function restoreDepth(depth){if(depth!==-1&&depth!==this.depth)this.maskOffset-=this.maskSize;this.depth=depth}},{"./tree":9,"./utils":10}],9:[function(require,module,exports){var assert=require("minimalistic-assert");var inherits=require("inherits");function Template(predicates,body){this.predicates=predicates;this.body=body}exports.Template=Template;Template.prototype.wrap=function wrap(){var body=this.body;for(var i=0;i<this.predicates.length;i++){var pred=this.predicates[i];body=pred.wrapBody(body)}this.body=body};Template.prototype.clone=function clone(){return new Template(this.predicates.slice(),this.body)};function MatchBase(){}exports.MatchBase=MatchBase;MatchBase.prototype.wrapBody=function wrapBody(body){return body};function Item(tree,children){this.conditions=[];this.children=[];for(var i=children.length-1;i>=0;i--){var arg=children[i];if(arg instanceof MatchBase)this.conditions.push(arg);else if(arg===tree.boundBody)this.children[i]=tree.queue.pop();else this.children[i]=arg}}function OnceMatch(){MatchBase.call(this)}inherits(OnceMatch,MatchBase);exports.OnceMatch=OnceMatch;function WrapMatch(refs){MatchBase.call(this);this.refs=refs}inherits(WrapMatch,MatchBase);exports.WrapMatch=WrapMatch;WrapMatch.prototype.wrapBody=function wrapBody(body){var applyCtx=this.refs.applyCtx;if(typeof body!=="function"){return function inlineAdaptor(){return applyCtx(body)}}return function wrapAdaptor(){return applyCtx(body.call(this,this,this.ctx))}};function ReplaceMatch(refs){MatchBase.call(this);this.refs=refs}inherits(ReplaceMatch,MatchBase);exports.ReplaceMatch=ReplaceMatch;ReplaceMatch.prototype.wrapBody=function wrapBody(body){var applyCtx=this.refs.applyCtx;if(typeof body!=="function"){return function inlineAdaptor(){return applyCtx(body)}}return function replaceAdaptor(){return applyCtx(body.call(this,this,this.ctx))}};function ExtendMatch(refs){MatchBase.call(this);this.refs=refs}inherits(ExtendMatch,MatchBase);exports.ExtendMatch=ExtendMatch;ExtendMatch.prototype.wrapBody=function wrapBody(body){var applyCtx=this.refs.applyCtx;var local=this.refs.local;if(typeof body!=="function"){return function inlineAdaptor(){var changes={};var keys=Object.keys(body);for(var i=0;i<keys.length;i++)changes["ctx."+keys[i]]=body[keys[i]];return local(changes)(function preApplyCtx(){return applyCtx(this.ctx)})}}return function localAdaptor(){var changes={};var obj=body.call(this);var keys=Object.keys(obj);for(var i=0;i<keys.length;i++)changes["ctx."+keys[i]]=obj[keys[i]];return local(changes)(function preApplyCtx(){return applyCtx(this.ctx)})}};function CompilerOptions(options){MatchBase.call(this);this.options=options}inherits(CompilerOptions,MatchBase);exports.CompilerOptions=CompilerOptions;function PropertyMatch(key,value){MatchBase.call(this);this.key=key;this.value=value}inherits(PropertyMatch,MatchBase);exports.PropertyMatch=PropertyMatch;function PropertyAbsent(key){MatchBase.call(this);this.key=key}inherits(PropertyAbsent,MatchBase);exports.PropertyAbsent=PropertyAbsent;function CustomMatch(body){MatchBase.call(this);this.body=body}inherits(CustomMatch,MatchBase);exports.CustomMatch=CustomMatch;function Tree(options){this.options=options;this.refs=this.options.refs;this.boundBody=this.body.bind(this);var methods=this.methods("body");for(var i=0;i<methods.length;i++){var method=methods[i];this.boundBody[Tree.methods[i]]=method}this.queue=[];this.templates=[];this.initializers=[]}exports.Tree=Tree;Tree.methods=["match","once","wrap","block","elem","mode","mod","elemMod","def","tag","attrs","cls","js","bem","mix","content","replace","extend","oninit","xjstOptions"];Tree.prototype.build=function build(templates,apply){var methods=this.methods("global").concat(apply);methods[0]=this.match.bind(this);templates.apply({},methods);return{templates:this.templates.slice().reverse(),oninit:this.initializers}};function methodFactory(self,kind,name){var method=self[name];var boundBody=self.boundBody;if(kind!=="body"){if(name==="replace"||name==="extend"||name==="wrap"){return function wrapExtended(){return method.apply(self,arguments)}}return function wrapNotBody(){method.apply(self,arguments);return boundBody}}return function wrapBody(){var res=method.apply(self,arguments);var child=self.queue.pop();var last=self.queue[self.queue.length-1];last.conditions=last.conditions.concat(child.conditions);last.children=last.children.concat(child.children);if(name==="replace"||name==="extend"||name==="wrap")return res;return boundBody}}Tree.prototype.methods=function methods(kind){var out=new Array(Tree.methods.length);for(var i=0;i<out.length;i++){var name=Tree.methods[i];out[i]=methodFactory(this,kind,name)}return out};Tree.prototype.flush=function flush(conditions,item){var subcond;if(item.conditions)subcond=conditions.concat(item.conditions);else subcond=item.conditions;for(var i=0;i<item.children.length;i++){var arg=item.children[i];if(arg instanceof Item){this.flush(subcond,item.children[i])}else{var template=new Template(conditions,arg);template.wrap();this.templates.push(template)}}};Tree.prototype.body=function body(){var children=new Array(arguments.length);for(var i=0;i<arguments.length;i++)children[i]=arguments[i];var child=new Item(this,children);this.queue[this.queue.length-1].children.push(child);if(this.queue.length===1)this.flush([],this.queue.shift());return this.boundBody};Tree.prototype.match=function match(){var children=new Array(arguments.length);for(var i=0;i<arguments.length;i++){var arg=arguments[i];if(typeof arg==="function")arg=new CustomMatch(arg);assert(arg instanceof MatchBase,"Wrong .match() argument");children[i]=arg}this.queue.push(new Item(this,children));return this.boundBody};Tree.prototype.once=function once(){if(arguments.length)throw new Error("Predicate once() should not have arguments");return this.match(new OnceMatch)};Tree.prototype.applyMode=function applyMode(args,mode){if(args.length){throw new Error("Predicate should not have arguments but "+JSON.stringify(args)+" passed")}return this.mode(mode)};Tree.prototype.wrap=function wrap(){return this.def.apply(this,arguments).match(new WrapMatch(this.refs))};Tree.prototype.xjstOptions=function xjstOptions(options){this.queue.push(new Item(this,[new CompilerOptions(options)]));return this.boundBody};Tree.prototype.block=function block(name){return this.match(new PropertyMatch("block",name))};Tree.prototype.elem=function elem(name){return this.match(new PropertyMatch("elem",name))};Tree.prototype.mode=function mode(name){return this.match(new PropertyMatch("_mode",name))};Tree.prototype.mod=function mod(name,value){return this.match(new PropertyMatch(["mods",name],value))};Tree.prototype.elemMod=function elemMod(name,value){return this.match(new PropertyMatch(["elemMods",name],value))};Tree.prototype.def=function def(){return this.applyMode(arguments,"default")};Tree.prototype.tag=function tag(){return this.applyMode(arguments,"tag")};Tree.prototype.attrs=function attrs(){return this.applyMode(arguments,"attrs")};Tree.prototype.cls=function cls(){return this.applyMode(arguments,"cls")};Tree.prototype.js=function js(){return this.applyMode(arguments,"js")};Tree.prototype.bem=function bem(){return this.applyMode(arguments,"bem")};Tree.prototype.mix=function mix(){return this.applyMode(arguments,"mix")};Tree.prototype.content=function content(){return this.applyMode(arguments,"content")};Tree.prototype.replace=function replace(){return this.def.apply(this,arguments).match(new ReplaceMatch(this.refs))};Tree.prototype.extend=function extend(){return this.def.apply(this,arguments).match(new ExtendMatch(this.refs))};Tree.prototype.oninit=function oninit(fn){this.initializers.push(fn)}},{inherits:11,"minimalistic-assert":12}],10:[function(require,module,exports){var toString=Object.prototype.toString;exports.isArray=Array.isArray;if(!exports.isArray){exports.isArray=function isArrayPolyfill(obj){return toString.call(obj)==="[object Array]"}}exports.xmlEscape=function(str){return(str+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")};exports.attrEscape=function(str){return(str+"").replace(/&/g,"&amp;").replace(/"/g,"&quot;")};exports.jsAttrEscape=function(str){return(str+"").replace(/&/g,"&amp;").replace(/'/g,"&#39;")};exports.extend=function extend(o1,o2){if(!o1||!o2)return o1||o2;var res={};var n;for(n in o1)if(o1.hasOwnProperty(n))res[n]=o1[n];for(n in o2)if(o2.hasOwnProperty(n))res[n]=o2[n];return res};var SHORT_TAGS={area:1,base:1,br:1,col:1,command:1,embed:1,hr:1,img:1,input:1,keygen:1,link:1,meta:1,param:1,source:1,wbr:1};exports.isShortTag=function isShortTag(t){return SHORT_TAGS.hasOwnProperty(t)};exports.isSimple=function isSimple(obj){if(!obj||obj===true)return true;if(!obj.block&&!obj.elem&&!obj.tag&&!obj.cls&&!obj.attrs&&obj.hasOwnProperty("html")&&isSimple(obj.html))return true;return typeof obj==="string"||typeof obj==="number"};var uniqCount=0;var uniqId=+new Date;var uniqExpando="__"+uniqId;var uniqPrefix="uniq"+uniqId;function getUniq(){return uniqPrefix+ ++uniqCount}exports.getUniq=getUniq;exports.identify=function identify(obj,onlyGet){if(!obj)return getUniq();if(onlyGet||obj[uniqExpando])return obj[uniqExpando];var u=getUniq();obj[uniqExpando]=u;return u}},{}],11:[function(require,module,exports){if(typeof Object.create==="function"){module.exports=function inherits(ctor,superCtor){ctor.super_=superCtor;ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:false,writable:true,configurable:true}})}}else{module.exports=function inherits(ctor,superCtor){ctor.super_=superCtor;var TempCtor=function(){};TempCtor.prototype=superCtor.prototype;ctor.prototype=new TempCtor;ctor.prototype.constructor=ctor}}},{}],12:[function(require,module,exports){module.exports=assert;function assert(val,msg){if(!val)throw new Error(msg||"Assertion failed")}assert.equal=function assertEqual(l,r,msg){if(l!=r)throw new Error(msg||"Assertion failed: "+l+" != "+r)}},{}]},{},[2])(2)});return module.exports||exports.BEMHTML}({},{});var api=new BEMHTML({});api.compile(function(match,once,wrap,block,elem,mode,mod,elemMod,def,tag,attrs,cls,js,bem,mix,content,replace,extend,oninit,xjstOptions,local,applyCtx,applyNext,apply){block("slider").elem("mark")[typeof addAttrs!=="undefined"?"addAttrs":"attrs"]()(function(){return{"aria-hidden":"true"}});block("button2").elem("text").tag()("span");oninit(function(exports){exports.BEMContext.prototype.util||(exports.BEMContext.prototype.util={})});block("textinput").elem("box").tag()("span");block("textinput").elem("control").tag()("input");oninit(function(exports){var ctxProto=exports.BEMContext.prototype,glob=exports["i-global"]=ctxProto["i-global"]=ctxProto.extend({lang:"ru",tld:"ru","content-region":"ru","click-host":"//clck.yandex.ru","passport-host":"https://passport.yandex.ru","pass-host":"https://pass.yandex.ru","social-host":"https://social.yandex.ru","export-host":"https://export.yandex.ru",login:"","lego-static-host":"https://yastatic.net/lego/2.10-142"},ctxProto["i-global"]);glob._public={id:true,lang:true,tld:true,"content-region":true,"user-region":true,login:true,displayName:true,index:true,yandexuid:true,"passport-host":true,"pass-host":true,"passport-msg":true,"static-host":true,"lego-static-host":true,"social-host":true,clck:true,"click-host":true,"export-host":true,"i-host":true,"social-retpath":true,"lego-path":true,sid:true,retpath:true,uid:true};glob.makePublic=function(param,flag){if(typeof param==="object"){glob._public=ctxProto.extend(glob._public,param);return}if(typeof flag==="undefined"){flag=true}glob._public[param]=flag};glob.isPublic=function(param){return Boolean(glob._public[param])};glob.setTld=function(tld){var xYaDomain=tld==="tr"?"yandex.com.tr":"yandex."+tld,yaDomain=["ua","by","kz"].indexOf(tld)!==-1?"yandex.ru":xYaDomain;glob.tld=tld;glob["content-region"]=tld;glob["click-host"]="//clck."+yaDomain;glob["passport-host"]="https://passport."+yaDomain;glob["pass-host"]="https://pass."+xYaDomain;glob["social-host"]="https://social."+xYaDomain;glob["export-host"]="https://export."+xYaDomain};ctxProto._iGlobalBackup={_backup:null,exists:function(){return Boolean(this._backup)},save:function(){this._backup=ctxProto.extend({},glob)},restore:function(){var p;for(p in glob){delete glob[p]}for(p in this._backup){glob[p]=this._backup[p]}}}});block("i-global")(tag()(""),def()(function(){var params=this.ctx.params||{},iGlobal=this["i-global"];if(!this._iGlobalBackup.exists()){this._iGlobalBackup.save()}else if(this.ctx.reset!==false){this._iGlobalBackup.restore()}if(params.tld&&params.tld!==iGlobal.tld){iGlobal.setTld(params.tld)}for(var p in params){iGlobal[p]=params[p]}return""}));oninit(function(exports){var toString=Object.prototype.toString;function isObject(something){return typeof something==="object"&&toString.call(something)==="[object Object]"}function merge(object,source,customizer){var key,customized;object=Object(object);source=Object(source);for(key in source){customized=customizer&&customizer(object[key],source[key],key);if(customized!==undefined){object[key]=customized}else if(isObject(object[key])&&isObject(source[key])){object[key]=merge(object[key],source[key],customizer)}else{object[key]=source[key]}}return object}function mergeBemjson(object,source){return merge(object,source,function(left,right,key){if(key==="mix"){return[].concat(left,right)}})}exports.BEMContext.prototype.util.merge=merge;exports.BEMContext.prototype.util.mergeBemjson=mergeBemjson});block("i-ua")(bem()(false),tag()("script"),(typeof addAttrs!=="undefined"?addAttrs:attrs)()(function(){return{nonce:this.ctx.nonce||this["i-global"].nonce}}),content()(function(){var c=[";(function(d,e,c,r){","e=d.documentElement;",'c="className";','r="replace";','e[c]=e[c][r]("i-ua_js_no","i-ua_js_yes");','if(d.compatMode!="CSS1Compat")','e[c]=e[c][r]("i-ua_css_standart","i-ua_css_quirks")',"})(document);"].join("");return[{html:c}]}));block("textinput")(tag()("span"),(typeof addJs!=="undefined"?addJs:js)()(function(){return{_tabindex:this.mods.disabled?this.ctx.tabindex:undefined}}),content()(function(){var ctx=this.ctx,mods=this.mods;if(mods.view===undefined){mods.view="classic"}return[{elem:"control",attrs:this.extend({type:mods.type,id:ctx.id,name:ctx.name,value:ctx.text,tabindex:ctx.tabindex,placeholder:ctx.placeholder,autocomplete:ctx.autocomplete===false&&"off",disabled:Boolean(mods.disabled)},ctx.controlAttrs)},{elem:"box"}]}));block("textinput")(match(function(){return this.ctx.mods&&this.ctx.mods.focused||this.ctx.controlAttrs&&this.ctx.controlAttrs.autofocus}).js()(function(){var autofocus=Boolean(this.ctx.mods&&this.ctx.mods.focused||this.ctx.controlAttrs.autofocus);return this.extend(applyNext(),{autofocus:autofocus,live:!autofocus})}));block("button2")(def()(function(){console.assert(!this.ctx.icon||!this.ctx.text,"button2: Некорректно использовать поля icon и text совместно");if(this.mods.view===undefined){this.mods.view="classic"}if(this.mods.progress){this.mods.disabled="yes"}if(this.ctx.tabindex===undefined){this.ctx.tabindex="0"}return applyNext()}),match(function(){return this.ctx.tag===undefined}).tag()("button"),(typeof addJs!=="undefined"?addJs:js)()(function(){return{_tabindex:this.mods.disabled?this.ctx.tabindex:undefined}}),attrs()(function(){var ctx=this.ctx,isDisabled=Boolean(this.mods.disabled);return this.extend({type:"button",autocomplete:"off",id:ctx.id,title:ctx.title,name:ctx.name,value:ctx.val,tabindex:isDisabled?undefined:ctx.tabindex,disabled:isDisabled,"aria-disabled":isDisabled&&"true"},applyNext())}),match(function(){return!this.ctx.content}).content()(function(){var ctx=this.ctx;return[ctx.icon&&{elem:"icon",icon:ctx.icon},ctx.iconLeft&&{elem:"icon",elemMods:{side:"left"},icon:ctx.iconLeft},ctx.iconRight&&{elem:"icon",elemMods:{side:"right"},icon:ctx.iconRight},ctx.text!==undefined&&(this.isSimple(ctx.text)?{elem:"text",content:{html:this.xmlEscape(ctx.text)}}:this.extend(ctx.text,{elem:"text"}))].filter(Boolean)}));block("slider")(def()(function(){var id=this.generateId();if(this.mods.view===undefined){this.mods.view="classic"}return applyNext({_inSlider:true,_titleId:"title"+id})}),match(function(){return this.ctx.extendContent!==false}).content()(function(){return[this.ctx.content,{elem:"body",content:{elem:"click"}}]}));block("textinput").match(function(){return this._inSlider})[typeof addJs!=="undefined"?"addMix":"mix"]()(function(){return[{block:"slider",elem:"input"}]});block("slider").elem("body").match(function(){return this.mods.orientation}).match(function(){return!this.ctx._wOrigin}).mix()(function(){var m=applyNext({"ctx._wOrigin":true})||[];m.push({elemMods:{origin:this.mods.orientation==="vert"?"y":"x"}});return m});block("slider").elem("runner").replace()(function(){var ctx=this.ctx,mods=this.extend(this.elemMods,this.mods),value=ctx.value||"";return this.util.mergeBemjson({block:"button2",mix:ctx,mods:{disabled:mods.disabled,pin:{first:"round-brick",last:"brick-round"}[mods.position]},text:{mix:{block:"slider",elem:"text"},content:typeof value==="string"?{html:this.xmlEscape(value)}:value},attrs:this.extend({id:ctx.id,role:"slider","aria-valuenow":this.isSimple(value)?value:this.reapply(value),"aria-valuemin":ctx.min,"aria-valuemax":ctx.max,"aria-labelledby":ctx.labelledby,"aria-controls":ctx.inputId},ctx.attrs)},ctx.button)});block("slider").mod("view","default").elem("runner").def()(function(){var compact=this.mods.compact==="yes";return applyNext({button:this.util.mergeBemjson(this.ctx.button,{mods:{view:"default",tone:this.mods.tone,theme:compact?"pseudo":"normal",pin:!compact&&{first:"round-brick",last:"brick-round"}[this.elemMods.position]||"circle-circle"}})})});oninit(function(exports,context){var BEMContext=exports.BEMContext||context.BEMContext;BEMContext.prototype.require=function(lib){return __bem_xjst_libs__[lib]}})});api.exportApply(exports);return exports}var defineAsGlobal=true;if(typeof module==="object"&&typeof module.exports==="object"){exports["BEMHTML"]=buildBemXjst({});defineAsGlobal=false}if(typeof modules==="object"){modules.define("BEMHTML",[],function(provide){provide(buildBemXjst({}))});defineAsGlobal=false}if(defineAsGlobal){BEMHTML=buildBemXjst({});global["BEMHTML"]=BEMHTML}})(typeof window!=="undefined"?window:typeof global!=="undefined"?global:this);
